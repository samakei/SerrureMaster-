const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-iSINUHXR.js","assets/react-vendor-C11u62No.js","assets/icons-D4y1Z8Z8.js","assets/supabase-DzS9I7wL.js","assets/AdminDashboard-Dr2LDh0G.js","assets/CoursePlayer-DAV4gM3I.js","assets/CGV-De75CsUk.js","assets/PrivacyPolicy-BiaX0o0c.js","assets/CookiesPolicy-xwpSOWSh.js"])))=>i.map(i=>d[i]);
var e,t,n;import{r as s,a as o,R as i}from"./react-vendor-C11u62No.js";import{S as r,X as a,a as l,T as c,b as u,P as d,c as p,A as m,C as h,U as f,L as g,M as v,d as x,e as y,f as b,g as E,h as _,F as w,i as N,j as S,B as I,k as A,l as T,m as C,n as O,o as j,W as R,Z as P,p as D,q as M,r as U,s as k,Q as q,t as L,u as G,v as F,w as V,x as H,y as B,z as J,D as $}from"./icons-D4y1Z8Z8.js";import{c as Y}from"./supabase-DzS9I7wL.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var z={exports:{}},W={},K=s,X=Symbol.for("react.element"),Q=Symbol.for("react.fragment"),Z=Object.prototype.hasOwnProperty,ee=K.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,te={key:!0,ref:!0,__self:!0,__source:!0};function ne(e,t,n){var s,o={},i=null,r=null;for(s in void 0!==n&&(i=""+n),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(r=t.ref),t)Z.call(t,s)&&!te.hasOwnProperty(s)&&(o[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===o[s]&&(o[s]=t[s]);return{$$typeof:X,type:e,key:i,ref:r,props:o,_owner:ee.current}}W.Fragment=Q,W.jsx=ne,W.jsxs=ne,z.exports=W;var se=z.exports,oe={},ie=o;oe.createRoot=ie.createRoot,oe.hydrateRoot=ie.hydrateRoot;const re={},ae=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),n=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));s=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in re)return;re[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const o=document.createElement("link");return o.rel=t?"stylesheet":"modulepreload",t||(o.as="script"),o.crossOrigin="",o.href=e,n&&o.setAttribute("nonce",n),document.head.appendChild(o),t?new Promise((t,n)=>{o.addEventListener("load",t),o.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function o(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return s.then(t=>{for(const e of t||[])"rejected"===e.status&&o(e.reason);return e().catch(o)})},le=s.createContext(void 0),ce=({children:e})=>{const[t,n]=s.useState([]),[o,i]=s.useState(!1),[r,a]=s.useState(!1);s.useEffect(()=>{const e=localStorage.getItem("serrure_master_cart");if(e)try{n(JSON.parse(e))}catch(t){}a(!0)},[]),s.useEffect(()=>{r&&localStorage.setItem("serrure_master_cart",JSON.stringify(t))},[t,r]);const l=t.some(e=>"p1_door_slammed"===e.id),c=t.some(e=>"p4_security_pack"===e.id),u=t.reduce((e,t)=>e+t.price*t.quantity,0);let d=0;l&&c&&(d=50);const p=Math.max(0,u-d),m=t.reduce((e,t)=>e+t.quantity,0);return se.jsx(le.Provider,{value:{items:t,isOpen:o,addToCart:e=>{n(t=>t.find(t=>t.id===e.id)?"p6_survival_kit"===e.id?t.map(t=>t.id===e.id?{...t,quantity:t.quantity+1}:t):t:[...t,{...e,quantity:1,addedAt:Date.now()}]),i(!0)},removeFromCart:e=>{n(t=>t.filter(t=>t.id!==e))},toggleCart:()=>i(e=>!e),clearCart:()=>{n([]),i(!1)},total:p,subtotal:u,discount:d,count:m},children:e})},ue=()=>{const e=s.useContext(le);if(void 0===e)throw new Error("useCart must be used within a CartProvider");return e};var de=(e=>(e.PDF="PDF",e.VIDEO="VIDEO",e.BUNDLE="BUNDLE",e))(de||{});const pe="SerrureMaster",me="/logo.png",he=[{id:"p1_door_slammed",title:"Urgence : Porte Claquée",description:"Un plan structuré pour analyser une porte claquée, comprendre les techniques professionnelles d’ouverture fine et éviter les erreurs irréversibles. Économisez jusqu’à 400€ de dépannage en tentant l’intervention dans le cadre légal et technique approprié.",price:100,originalPrice:500,features:["Vidéo HD : technique professionnelle sans perçage","PDF Diagnostic : vérifier si la porte est réellement claquée","Guide pratique : gestes autorisés / gestes interdits","Assistance WhatsApp incluse (validation ou STOP immédiat)"],compatibility:{valid:["Porte claquée (non verrouillée)","Porte blindée claquée sans verrouillage"],invalid:["Porte fermée à clé (verrouillée)"]},type:de.BUNDLE,image:"/images/p1.jpg",stripePriceId:"price_1PqXyZA2eZvKYlo2kR9uWq5a",currentResource:{id:"res_p1_v1",productId:"p1_door_slammed",fileName:"Guide_Ouverture_Radio_Pro_v1.pdf",filePath:"secure-pdfs/p1/guide.pdf",fileSize:"2.4 MB",status:"published",version:1,lastUpdated:"2023-11-15T10:00:00Z"}},{id:"p2_key_broken",title:"Clé Cassée dans le Barillet",description:"Formation vidéo pour comprendre comment tenter une extraction sécurisée du fragment cassé, sans aggraver le blocage. Identifiez quand intervenir et quand arrêter pour préserver votre cylindre. Assistance WhatsApp pour validation visuelle.",price:100,originalPrice:500,features:["Vidéo HD : protocole d’extraction sécurisé","Guide PDF : cas autorisés / cas interdits","Section “STOP” : quand ne surtout pas insister","Assistance WhatsApp incluse (validation sur photo)"],compatibility:{valid:["Clé cassée visible ou accessible"],invalid:["Cylindre bloqué ou endommagé","Tentative déjà forcée"]},type:de.BUNDLE,image:"/images/p2.jpg",stripePriceId:"price_1PqXzQB2eZvKYlo2mL8vTq4b",currentResource:{id:"res_p2_v1_draft",productId:"p2_key_broken",fileName:"Guide_Extraction_Key_DRAFT.pdf",filePath:"secure-pdfs/p2/draft.pdf",fileSize:"1.8 MB",status:"draft",version:.9,lastUpdated:"2023-12-20T14:30:00Z"}},{id:"p3_cylinder_replace",title:"Remplacer son Cylindre",description:"Tutoriel technique pour changer un cylindre standard sans erreur de mesure ni main-d’œuvre excessive. Comprendre les dimensions critiques, les outils nécessaires et les pièges à éviter. Idéal après emménagement ou mise à niveau de sécurité.",price:100,originalPrice:500,features:["Tutoriel vidéo : démontage sécurisé","PDF mesures exactes (intérieur / extérieur)","Checklist outils nécessaires (basiques)","Assistance WhatsApp en cas de doute"],compatibility:{valid:["Cylindre standard"],invalid:["Serrure spécifique ou système complexe"]},type:de.VIDEO,image:"/images/p3.jpg",stripePriceId:"price_1PqY1RC2eZvKYlo2nN7wUr3c",currentResource:null},{id:"p4_security_pack",title:"Changer sa Serrure Complète",description:"Formation complète pour remplacer une serrure entière sans main-d’œuvre professionnelle. Maîtrisez les mesures précises, le démontage sécurisé et les critères de sélection certifiés. Gain immédiat en autonomie et budget.",price:100,originalPrice:500,features:["Mesure précise avant achat","Démontage & remontage pas à pas (Vidéo)","Guide d’achat : critères A2P (sans marque imposée)","Assistance WhatsApp incluse"],compatibility:{valid:["Remplacement simple"],invalid:["Travaux lourds ou structurels"]},type:de.BUNDLE,image:"/images/p4.jpg",stripePriceId:"price_1PqY2SD2eZvKYlo2oP6xVs2d",currentResource:{id:"res_p4_v2",productId:"p4_security_pack",fileName:"Tuto_Remplacement_Serrure_v2.pdf",filePath:"secure-pdfs/p4/guide.pdf",fileSize:"3.1 MB",status:"published",version:2,lastUpdated:"2023-10-05T09:00:00Z"}},{id:"p5_audit_security",title:"Audit Sécurité & Renforcement",description:"Méthodologie professionnelle pour évaluer vos vulnérabilités et prioriser les renforcements efficaces sans travaux lourds. Obtenez un plan d’action personnalisé avec budget maîtrisé et assistance technique pour validation à distance.",price:100,originalPrice:500,features:["Audit guidé (photos + questionnaire)","Plan d’action priorisé (24h / 7j / 30j)","Budget maîtrisé & erreurs à éviter","Assistance WhatsApp de validation"],compatibility:{valid:["Logement ou local standard"],invalid:["Travaux de blindage structurel"]},type:de.BUNDLE,image:"/images/p5.jpg",stripePriceId:"price_1PqY3TE2eZvKYlo2qR5yWt1e",currentResource:null},{id:"p6_survival_kit",title:"Pack : Kit de Prévention",description:"Sélection professionnelle du matériel indispensable pour gérer les situations courantes sans stress. Liste vérifiée, liens d’achat directs, aucun gadget inutile. Économie immédiate garantie.",price:29,originalPrice:145,features:["Liens d’achat directs (qualité pro)","Matériel réellement utile (pas de gadgets)","Économie immédiate"],type:de.BUNDLE,image:"/images/p6.jpg",stripePriceId:"price_1PqY4UF2eZvKYlo2rS4zXu0f",currentResource:{id:"res_p6_kit",productId:"p6_survival_kit",fileName:"Liste_Materiel_Pro.pdf",filePath:"secure-pdfs/p6/list.pdf",fileSize:"0.5 MB",status:"published",version:1,lastUpdated:"2023-09-01T12:00:00Z"}}],fe="user_123_abc",ge={p1_door_slammed:{productId:"p1_door_slammed",modules:[{id:"m1_safety",title:"Module 1 : Analyse & Sécurité (OBLIGATOIRE)",status:"published",lessons:[{id:"l1_intro",title:"STOP - Diagnostic immédiat",duration:"02:15",videoUrl:"https://www.w3schools.com/html/mov_bbb.mp4",provider:"native",status:"published",description:"Ne touchez à rien avant d'avoir vérifié ces 3 points cruciaux pour ne pas aggraver la situation.",checklist:["Vérifier que la porte n'est pas verrouillée","Vérifier l'état de la poignée","S'assurer d'être le locataire/propriétaire"]},{id:"l2_legal",title:"Cadre légal & Responsabilité",duration:"01:45",videoUrl:"https://www.w3schools.com/html/mov_bbb.mp4",provider:"native",status:"published",description:"Rappel rapide de vos droits et devoirs avant d'intervenir."}]},{id:"m2_technique",title:"Module 2 : La Technique Radio",status:"published",lessons:[{id:"l3_tools",title:"Préparer votre outil (Radio ou Bouteille)",duration:"03:30",videoUrl:"https://www.w3schools.com/html/mov_bbb.mp4",provider:"native",status:"published",description:"Comment découper une bouteille en plastique si vous n'avez pas de radio médicale.",checklist:["Découpe propre sans bavure","Taille idéale : 15cm x 10cm","Lubrifiant (Savon/Huile)"]},{id:"l4_gesture",title:"Le Geste : Angle et Vibration",duration:"05:10",videoUrl:"https://www.w3schools.com/html/mov_bbb.mp4",provider:"native",status:"published",description:"Le mouvement exact pour faire glisser le pêne. Regardez bien la position des mains.",checklist:["Insérer par le bas ou le haut","Faire vibrer la porte","Pousser et tirer simultanément"]},{id:"l5_double",title:"Cas particulier : Double feuillure",duration:"04:00",videoUrl:"https://www.w3schools.com/html/mov_bbb.mp4",provider:"native",status:"draft",description:"La technique adaptée pour les portes blindées ou modernes avec décrochement."}]},{id:"m3_troubleshoot",title:"Module 3 : En cas d'échec",status:"published",lessons:[{id:"l6_errors",title:"Les 3 erreurs qui bloquent tout",duration:"02:50",videoUrl:"https://www.w3schools.com/html/mov_bbb.mp4",provider:"native",status:"published",description:"Si ça ne s'ouvre pas, c'est probablement à cause de l'un de ces détails."},{id:"l7_abandon",title:"Quand faut-il abandonner ?",duration:"01:30",videoUrl:"https://www.w3schools.com/html/mov_bbb.mp4",provider:"native",status:"published",description:"Savoir s'arrêter avant de casser la serrure et que ça coûte 1000€."}]}]}},ve=({onCheckout:e})=>{const{items:t,isOpen:n,toggleCart:s,removeFromCart:o,total:i,subtotal:f,discount:g,addToCart:v}=ue(),x=t.some(e=>"p1_door_slammed"===e.id),y=t.some(e=>"p4_security_pack"===e.id),b=x&&!y,E=he.find(e=>"p4_security_pack"===e.id);return n?se.jsxs(se.Fragment,{children:[se.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-[60] transition-opacity",onClick:s}),se.jsxs("div",{className:"fixed inset-y-0 right-0 z-[70] w-full sm:max-w-md bg-slate-900 border-l border-slate-700 shadow-2xl transform transition-transform duration-300 ease-in-out flex flex-col",children:[se.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-800 bg-slate-900",children:[se.jsxs("div",{className:"flex items-center space-x-3",children:[se.jsx(r,{className:"w-6 h-6 text-orange-500"}),se.jsx("h2",{className:"text-xl font-bold text-white",children:"Votre Panier"}),se.jsxs("span",{className:"bg-slate-800 text-slate-300 text-xs px-2 py-1 rounded-full border border-slate-700",children:[t.length," article",t.length>1?"s":""]})]}),se.jsx("button",{onClick:s,"aria-label":"Fermer le panier",className:"text-slate-400 hover:text-white transition p-2 hover:bg-slate-800 rounded-full",children:se.jsx(a,{className:"w-6 h-6"})})]}),se.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:0===t.length?se.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center space-y-4 opacity-60",children:[se.jsx("div",{className:"bg-slate-800 p-6 rounded-full",children:se.jsx(r,{className:"w-12 h-12 text-slate-400"})}),se.jsx("p",{className:"text-slate-200 font-medium",children:"Votre panier est vide."}),se.jsx("button",{onClick:s,className:"text-orange-500 hover:text-orange-400 underline",children:"Découvrir nos guides"})]}):se.jsxs(se.Fragment,{children:[t.map(e=>se.jsxs("div",{className:"group relative flex bg-slate-800/50 rounded-xl border border-slate-700 p-3 hover:border-orange-500/30 transition-all",children:[se.jsx("div",{className:"h-20 w-20 flex-shrink-0 overflow-hidden rounded-lg bg-slate-900 border border-slate-700",children:se.jsx("img",{src:e.image,alt:e.title,className:"h-full w-full object-cover opacity-80 group-hover:opacity-100 transition-opacity"})}),se.jsxs("div",{className:"ml-4 flex flex-1 flex-col justify-between",children:[se.jsxs("div",{children:[se.jsxs("div",{className:"flex justify-between",children:[se.jsx("h3",{className:"text-sm font-bold text-white line-clamp-2 pr-4",children:e.title}),se.jsxs("p",{className:"text-sm font-bold text-orange-400",children:[e.price,"€"]})]}),se.jsx("p",{className:"mt-1 text-xs text-slate-400 line-clamp-1",children:e.description})]}),se.jsxs("div",{className:"flex justify-between items-end mt-2",children:[se.jsxs("div",{className:"text-xs text-slate-400 font-mono flex items-center",children:["BUNDLE"===e.type&&se.jsx(l,{className:"w-3 h-3 mr-1 text-green-500"}),e.type]}),se.jsxs("button",{onClick:()=>o(e.id),"aria-label":`Retirer ${e.title} du panier`,className:"text-slate-400 hover:text-red-400 transition flex items-center text-xs group/btn",children:[se.jsx(c,{className:"w-4 h-4 mr-1"}),se.jsx("span",{className:"opacity-0 group-hover/btn:opacity-100 transition-opacity",children:"Retirer"})]})]})]})]},e.id)),b&&E&&se.jsx("div",{className:"mt-6 border-t border-slate-700 pt-6 animate-fade-in-up",children:se.jsxs("div",{className:"bg-gradient-to-r from-slate-800 to-slate-900 rounded-xl p-4 border border-orange-500/30 shadow-[0_0_15px_-3px_rgba(249,115,22,0.15)] relative overflow-hidden",children:[se.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-10",children:se.jsx(l,{className:"w-24 h-24 text-orange-500"})}),se.jsxs("div",{className:"relative z-10",children:[se.jsxs("div",{className:"flex items-center mb-2",children:[se.jsx(u,{className:"w-4 h-4 text-orange-400 mr-2 animate-pulse"}),se.jsx("span",{className:"text-xs font-bold text-orange-400 uppercase tracking-wider",children:"Offre Spéciale Sécurité"})]}),se.jsx("h4",{className:"text-white font-bold text-sm mb-1",children:"Sécurisez votre porte après ouverture"}),se.jsxs("p",{className:"text-slate-200 text-xs mb-3",children:['Ajoutez le pack "Changer sa serrure" pour seulement'," ",se.jsx("span",{className:"text-white font-bold underline",children:"50€"})," (au lieu de 100€)."]}),se.jsxs("button",{onClick:()=>v(E),className:"w-full py-2 bg-orange-600 hover:bg-orange-500 text-white text-xs font-bold rounded-lg transition-colors flex items-center justify-center",children:[se.jsx(d,{className:"w-3 h-3 mr-1"}),"Ajouter le pack (+50€ seulement)"]})]})]})})]})}),t.length>0&&se.jsxs("div",{className:"border-t border-slate-800 bg-slate-900 p-6 space-y-4",children:[se.jsxs("div",{className:"space-y-2",children:[se.jsxs("div",{className:"flex justify-between text-sm text-slate-400",children:[se.jsx("span",{children:"Sous-total"}),se.jsxs("span",{children:[f,"€"]})]}),g>0&&se.jsxs("div",{className:"flex justify-between text-sm text-green-400 font-medium",children:[se.jsxs("span",{className:"flex items-center",children:[se.jsx(p,{className:"w-3 h-3 mr-1"})," Remise Bundle"]}),se.jsxs("span",{children:["-",g,"€"]})]}),se.jsxs("div",{className:"flex justify-between text-sm text-slate-400",children:[se.jsx("span",{children:"Taxes (estimées)"}),se.jsx("span",{children:"Incluses"})]}),se.jsxs("div",{className:"flex justify-between text-xl font-bold text-white pt-2 border-t border-slate-800",children:[se.jsx("span",{children:"Total"}),se.jsxs("span",{className:"text-orange-500",children:[i,"€"]})]})]}),se.jsxs("button",{onClick:e,className:"w-full py-4 bg-gradient-to-r from-orange-600 to-orange-500 hover:from-orange-500 hover:to-orange-400 text-white font-bold rounded-xl shadow-lg shadow-orange-900/20 transition-all transform hover:-translate-y-1 flex items-center justify-center group",children:[se.jsx("span",{children:"Procéder au paiement"}),se.jsx(m,{className:"w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform"})]}),se.jsxs("div",{className:"flex justify-center items-center space-x-4 text-[10px] text-slate-300 mt-2",children:[se.jsxs("span",{className:"flex items-center",children:[se.jsx(l,{className:"w-3 h-3 mr-1"})," Paiement Sécurisé"]}),se.jsxs("span",{className:"flex items-center",children:[se.jsx(h,{className:"w-3 h-3 mr-1"})," Satisfait ou remboursé"]})]})]})]})]}):null},xe=({className:e})=>se.jsxs("svg",{viewBox:"0 0 420 75",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,"aria-label":"Logo SerrureMaster",style:{filter:"drop-shadow(0 4px 12px rgba(249, 115, 22, 0.2))"},children:[se.jsxs("defs",{children:[se.jsxs("linearGradient",{id:"shield_modern_grad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[se.jsx("stop",{offset:"0%",style:{stopColor:"#f97316",stopOpacity:1}}),se.jsx("stop",{offset:"50%",style:{stopColor:"#ec4899",stopOpacity:1}}),se.jsx("stop",{offset:"100%",style:{stopColor:"#a855f7",stopOpacity:1}})]}),se.jsxs("linearGradient",{id:"glow_cyan",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[se.jsx("stop",{offset:"0%",style:{stopColor:"#06b6d4",stopOpacity:1}}),se.jsx("stop",{offset:"100%",style:{stopColor:"#3b82f6",stopOpacity:1}})]}),se.jsxs("linearGradient",{id:"glass_effect",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[se.jsx("stop",{offset:"0%",style:{stopColor:"#ffffff",stopOpacity:.15}}),se.jsx("stop",{offset:"100%",style:{stopColor:"#ffffff",stopOpacity:.05}})]}),se.jsxs("filter",{id:"soft_glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[se.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),se.jsxs("feMerge",{children:[se.jsx("feMergeNode",{in:"coloredBlur"}),se.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),se.jsxs("filter",{id:"inner_shadow",children:[se.jsx("feGaussianBlur",{in:"SourceAlpha",stdDeviation:"2"}),se.jsx("feOffset",{dx:"0",dy:"2",result:"offsetblur"}),se.jsx("feComponentTransfer",{children:se.jsx("feFuncA",{type:"linear",slope:"0.4"})}),se.jsxs("feMerge",{children:[se.jsx("feMergeNode",{}),se.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),se.jsxs("g",{transform:"translate(10, 8)",children:[se.jsx("path",{d:"M28 0 L50 11 V28 C50 42 40 55 28 60 C16 55 6 42 6 28 V11 L28 0 Z",fill:"url(#shield_modern_grad)",filter:"url(#soft_glow)",children:se.jsx("animate",{attributeName:"opacity",values:"0.95;1;0.95",dur:"4s",repeatCount:"indefinite"})}),se.jsx("path",{d:"M28 3 L47 12 V28 C47 40 38 52 28 56 C18 52 9 40 9 28 V12 L28 3 Z",fill:"url(#glass_effect)",opacity:"0.6"}),se.jsx("path",{d:"M28 14 L38 22 V42 L28 50 L18 42 V22 L28 14 Z",fill:"#0a0f1e",opacity:"0.95",filter:"url(#inner_shadow)"}),se.jsxs("g",{transform:"translate(28, 30)",filter:"url(#soft_glow)",children:[se.jsx("rect",{x:"-5",y:"0",width:"10",height:"8",rx:"1.5",fill:"url(#glow_cyan)"}),se.jsx("path",{d:"M-3 0 V-4 C-3 -5.65 -1.65 -7 0 -7 C1.65 -7 3 -5.65 3 -4 V0",stroke:"url(#glow_cyan)",strokeWidth:"1.5",fill:"none",strokeLinecap:"round"}),se.jsx("circle",{cx:"0",cy:"4",r:"1.5",fill:"#0a0f1e",children:se.jsx("animate",{attributeName:"r",values:"1.5;2;1.5",dur:"2s",repeatCount:"indefinite"})}),se.jsx("circle",{cx:"0",cy:"4",r:"1.5",fill:"url(#glow_cyan)",opacity:"0.6",children:se.jsx("animate",{attributeName:"opacity",values:"0.3;0.8;0.3",dur:"2s",repeatCount:"indefinite"})})]}),se.jsxs("g",{opacity:"0.7",children:[se.jsx("circle",{cx:"55",cy:"15",r:"2.5",fill:"#06b6d4",children:se.jsx("animate",{attributeName:"cy",values:"15;12;15",dur:"3s",repeatCount:"indefinite"})}),se.jsx("circle",{cx:"58",cy:"25",r:"1.5",fill:"#ec4899",children:se.jsx("animate",{attributeName:"cy",values:"25;22;25",dur:"2.5s",repeatCount:"indefinite"})}),se.jsx("circle",{cx:"1",cy:"15",r:"2.5",fill:"#a855f7",children:se.jsx("animate",{attributeName:"cy",values:"15;18;15",dur:"3.5s",repeatCount:"indefinite"})}),se.jsx("circle",{cx:"-2",cy:"25",r:"1.5",fill:"#f97316",children:se.jsx("animate",{attributeName:"cy",values:"25;28;25",dur:"2.8s",repeatCount:"indefinite"})})]}),se.jsxs("g",{opacity:"0.5",strokeWidth:"1",strokeLinecap:"round",children:[se.jsx("line",{x1:"50",y1:"15",x2:"55",y2:"15",stroke:"#06b6d4",children:se.jsx("animate",{attributeName:"x2",values:"55;58;55",dur:"3s",repeatCount:"indefinite"})}),se.jsx("line",{x1:"6",y1:"15",x2:"1",y2:"15",stroke:"#a855f7",children:se.jsx("animate",{attributeName:"x2",values:"1;-2;1",dur:"3.5s",repeatCount:"indefinite"})})]})]}),se.jsxs("g",{transform:"translate(85, 0)",children:[se.jsxs("text",{x:"0",y:"36",fontFamily:"'Inter', sans-serif",fontWeight:"900",fontSize:"26",letterSpacing:"1.5",fill:"url(#shield_modern_grad)",style:{paintOrder:"stroke fill"},children:["SERRURE",se.jsx("tspan",{fill:"#06b6d4",dx:"4",children:"MASTER"})]}),se.jsxs("text",{x:"0",y:"35",fontFamily:"'Inter', sans-serif",fontWeight:"900",fontSize:"26",letterSpacing:"1.5",fill:"url(#glass_effect)",opacity:"0.8",children:["SERRURE",se.jsx("tspan",{dx:"4",children:"MASTER"})]}),se.jsxs("g",{transform:"translate(0, 45)",children:[se.jsx("rect",{x:"0",y:"0",width:"120",height:"16",rx:"8",fill:"url(#shield_modern_grad)",opacity:"0.15"}),se.jsx("text",{x:"60",y:"11",fontFamily:"'Inter', sans-serif",fontWeight:"700",fontSize:"9",fill:"#06b6d4",letterSpacing:"2",textAnchor:"middle",style:{textTransform:"uppercase"},children:"Votre Sécurité"}),se.jsx("circle",{cx:"8",cy:"8",r:"2",fill:"#10b981",children:se.jsx("animate",{attributeName:"opacity",values:"0.3;1;0.3",dur:"1.5s",repeatCount:"indefinite"})})]})]})]}),ye=({children:e,user:t,onNavigate:n,currentPage:o,onLogout:i,onLoginClick:l,onCheckout:c})=>{const{count:u,toggleCart:d}=ue(),[p,m]=s.useState(!1),h=()=>m(!1),x=e=>{n(e),h()};return se.jsxs("div",{className:"min-h-screen flex flex-col bg-slate-50",children:[se.jsxs("nav",{className:"sticky top-0 z-50 bg-slate-900 text-white shadow-lg border-b border-slate-800",children:[se.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:se.jsxs("div",{className:"flex justify-between h-16 sm:h-20 items-center",children:[se.jsx("div",{className:"flex items-center cursor-pointer hover:opacity-90 transition py-2 -ml-2",onClick:()=>n("home"),children:se.jsx(xe,{className:"h-10 sm:h-14 w-auto"})}),se.jsxs("div",{className:"hidden md:flex items-center space-x-8",children:[se.jsx("button",{onClick:()=>n("home"),className:"text-sm font-medium hover:text-orange-400 transition "+("home"===o?"text-orange-500":"text-slate-300"),children:"Nos Plans d'Action"}),se.jsx("button",{onClick:()=>n("about"),className:"text-sm font-medium text-slate-300 hover:text-orange-400 transition",children:"L'Expert"}),se.jsxs("button",{onClick:d,className:"relative p-2 text-slate-300 hover:text-white transition group","aria-label":"Ouvrir le panier",children:[se.jsx(r,{className:"h-6 w-6"}),u>0&&se.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full border-2 border-slate-900 animate-bounce-subtle",children:u})]}),t?se.jsxs("div",{className:"flex items-center space-x-4",children:[se.jsxs("button",{onClick:()=>n("dashboard"),className:"flex items-center px-4 py-2 rounded-md text-sm font-medium transition "+("dashboard"===o?"bg-orange-600 text-white":"bg-slate-800 text-slate-200 hover:bg-slate-700"),children:[se.jsx(f,{className:"h-4 w-4 mr-2"}),"Espace Membre"]}),se.jsx("button",{onClick:i,className:"text-slate-400 hover:text-red-400",title:"Se déconnecter","aria-label":"Se déconnecter",children:se.jsx(g,{className:"h-5 w-5"})})]}):se.jsxs("button",{onClick:l,className:"flex items-center text-sm font-medium text-slate-300 hover:text-white transition border border-slate-600 px-4 py-2 rounded-md hover:border-orange-500",children:[se.jsx(f,{className:"h-4 w-4 mr-2"}),"Connexion Client"]})]}),se.jsxs("div",{className:"flex md:hidden items-center space-x-2",children:[se.jsxs("button",{onClick:d,className:"relative p-2 text-slate-300 hover:text-white transition","aria-label":"Ouvrir le panier",children:[se.jsx(r,{className:"h-6 w-6"}),u>0&&se.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full border-2 border-slate-900",children:u})]}),se.jsx("button",{onClick:()=>m(!p),className:"p-2 text-slate-300 hover:text-white transition","aria-label":"Menu",children:p?se.jsx(a,{className:"h-6 w-6"}):se.jsx(v,{className:"h-6 w-6"})})]})]})}),p&&se.jsxs(se.Fragment,{children:[se.jsx("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-40 md:hidden",onClick:h}),se.jsx("div",{className:"fixed inset-x-0 top-16 sm:top-20 bg-slate-900 border-t border-slate-800 z-50 md:hidden shadow-2xl animate-slideUp",children:se.jsxs("div",{className:"px-4 py-6 space-y-4 max-h-[calc(100vh-5rem)] overflow-y-auto",children:[se.jsx("button",{onClick:()=>x("home"),className:"block w-full text-left px-4 py-3 rounded-lg text-base font-medium transition "+("home"===o?"bg-orange-600 text-white":"text-slate-300 hover:bg-slate-800"),children:"Nos Plans d'Action"}),se.jsx("button",{onClick:()=>x("about"),className:"block w-full text-left px-4 py-3 rounded-lg text-base font-medium text-slate-300 hover:bg-slate-800 transition",children:"L'Expert"}),se.jsx("div",{className:"border-t border-slate-800 pt-4 mt-4",children:t?se.jsxs(se.Fragment,{children:[se.jsxs("button",{onClick:()=>x("dashboard"),className:"flex items-center w-full px-4 py-3 rounded-lg text-base font-medium transition mb-2 "+("dashboard"===o?"bg-orange-600 text-white":"bg-slate-800 text-slate-200 hover:bg-slate-700"),children:[se.jsx(f,{className:"h-5 w-5 mr-3"}),"Espace Membre"]}),se.jsxs("button",{onClick:()=>{i(),h()},className:"flex items-center w-full px-4 py-3 rounded-lg text-base font-medium text-red-400 hover:bg-slate-800 transition",children:[se.jsx(g,{className:"h-5 w-5 mr-3"}),"Se déconnecter"]})]}):se.jsxs("button",{onClick:()=>{l(),h()},className:"flex items-center w-full px-4 py-3 rounded-lg text-base font-medium text-slate-300 hover:bg-slate-800 transition border border-slate-700",children:[se.jsx(f,{className:"h-5 w-5 mr-3"}),"Connexion Client"]})})]})})]})]}),se.jsx(ve,{onCheckout:c}),se.jsx("main",{className:"flex-grow",children:e}),se.jsxs("footer",{className:"bg-slate-900 text-slate-300 py-12 border-t border-slate-800",children:[se.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid md:grid-cols-3 gap-8",children:[se.jsxs("div",{children:[se.jsx("div",{className:"flex items-center mb-4 cursor-pointer -ml-2",onClick:()=>n("home"),children:se.jsx(xe,{className:"h-10 w-auto opacity-90 hover:opacity-100 transition"})}),se.jsx("p",{className:"text-sm leading-relaxed",children:"La référence pour maîtriser votre sécurité et économiser jusqu'à 400€ en dépannage. Apprenez à ouvrir votre porte vous-même avec nos guides professionnels."})]}),se.jsxs("div",{children:[se.jsx("h3",{className:"text-white font-semibold mb-4",children:"Légal"}),se.jsxs("ul",{className:"space-y-2 text-sm",children:[se.jsx("li",{children:se.jsx("button",{onClick:()=>n("cgv"),className:"hover:text-orange-500 transition text-left",children:"CGV & Mentions Légales"})}),se.jsx("li",{children:se.jsx("button",{onClick:()=>n("privacy"),className:"hover:text-orange-500 transition text-left",children:"Politique de Confidentialité"})}),se.jsx("li",{children:se.jsx("button",{onClick:()=>n("cookies"),className:"hover:text-orange-500 transition text-left",children:"Gestion des Cookies"})})]})]}),se.jsxs("div",{children:[se.jsx("h3",{className:"text-white font-semibold mb-4",children:"Paiement Sécurisé"}),se.jsxs("div",{className:"flex space-x-2",children:[se.jsx("div",{className:"bg-white px-2 py-1 rounded text-xs font-bold text-slate-900",children:"STRIPE"}),se.jsx("div",{className:"bg-white px-2 py-1 rounded text-xs font-bold text-slate-900",children:"VISA"}),se.jsx("div",{className:"bg-white px-2 py-1 rounded text-xs font-bold text-slate-900",children:"MASTERCARD"})]}),se.jsx("p",{className:"mt-4 text-xs text-slate-400",children:"Transactions chiffrées SSL 256-bit."})]})]}),se.jsxs("div",{className:"max-w-7xl mx-auto px-4 mt-8 pt-8 border-t border-slate-800 text-center text-xs",children:["© ",(new Date).getFullYear()," SerrureMaster. Tous droits réservés."]})]})]})},be=s.createContext(void 0),Ee=({children:e})=>{const[t,n]=s.useState(null),[o,i]=s.useState(null);s.useEffect(()=>{const e=localStorage.getItem("serrure_master_settings");if(e)try{const t=JSON.parse(e);t.logo&&n(t.logo),t.heroImage&&i(t.heroImage)}catch(t){}},[]);const r=e=>{localStorage.setItem("serrure_master_settings",JSON.stringify(e))};return se.jsx(be.Provider,{value:{logo:t,heroImage:o,updateLogo:e=>{n(e),r({logo:e,heroImage:o})},updateHeroImage:e=>{i(e),r({logo:t,heroImage:e})},resetSettings:()=>{n(null),i(null),localStorage.removeItem("serrure_master_settings")}},children:e})},_e=i.memo(({onCtaClick:e})=>{const{heroImage:t}=(()=>{const e=s.useContext(be);if(void 0===e)throw new Error("useSettings must be used within a SettingsProvider");return e})(),n=s.useMemo(()=>he[0].image,[]);return se.jsxs("div",{className:"relative bg-slate-950 overflow-hidden pt-10 pb-20 lg:pt-20 lg:pb-28",children:[se.jsxs("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-full h-full z-0 pointer-events-none",children:[se.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[500px] h-[500px] bg-orange-600/10 rounded-full blur-[120px] mix-blend-screen animate-pulse-slow"}),se.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[600px] h-[600px] bg-indigo-600/20 rounded-full blur-[120px] mix-blend-screen"}),t&&se.jsx("img",{src:t,className:"absolute inset-0 w-full h-full object-cover opacity-10 mix-blend-overlay",alt:"Background Texture"})]}),se.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:se.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 lg:gap-20 items-center",children:[se.jsxs("div",{className:"text-left space-y-8 animate-fade-in-up",children:[se.jsxs("div",{className:"inline-flex items-center space-x-2 bg-slate-900/80 border border-slate-700 rounded-full px-4 py-1.5 backdrop-blur-md",children:[se.jsx(l,{className:"w-4 h-4 text-orange-500"}),se.jsx("span",{className:"text-slate-300 text-xs font-bold tracking-wider uppercase",children:"Protocole Certifié • Non Destructif"})]}),se.jsxs("h1",{className:"text-3xl sm:text-4xl lg:text-6xl font-extrabold text-white leading-[1.1] tracking-tight",children:["Porte claquée ? ",se.jsx("br",{}),"La méthode officielle pour ",se.jsx("br",{className:"hidden sm:block"}),se.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-amber-200",children:"agir sans tout casser."})]}),se.jsxs("p",{className:"text-base sm:text-lg text-slate-400 max-w-xl leading-relaxed",children:["Avant d'appeler un dépanneur, accédez au ",se.jsx("strong",{children:"plan d'action vidéo"})," utilisé par les professionnels. Une solution légale et guidée pas à pas pour tenter l'ouverture vous-même."]}),se.jsxs("div",{className:"bg-slate-900/60 border border-slate-800 rounded-xl overflow-hidden grid sm:grid-cols-2 text-sm shadow-xl",children:[se.jsxs("div",{className:"p-5 border-b sm:border-b-0 sm:border-r border-slate-800 bg-green-900/20",children:[se.jsxs("p",{className:"text-green-400 font-bold text-xs uppercase mb-3 flex items-center",children:[se.jsx(x,{className:"w-4 h-4 mr-2"}),"Situation Compatible"]}),se.jsxs("ul",{className:"space-y-2 text-slate-300",children:[se.jsxs("li",{className:"flex items-start",children:[se.jsx("span",{className:"mr-2 text-green-500",children:"•"})," Porte claquée (Clé oubliée à l'intérieur)"]}),se.jsxs("li",{className:"flex items-start",children:[se.jsx("span",{className:"mr-2 text-green-500",children:"•"})," Porte blindée claquée (non verrouillée)"]}),se.jsxs("li",{className:"flex items-start",children:[se.jsx("span",{className:"mr-2 text-green-500",children:"•"})," Clé cassée (morceau visible)"]})]})]}),se.jsxs("div",{className:"p-5 bg-red-900/10",children:[se.jsxs("p",{className:"text-red-400 font-bold text-xs uppercase mb-3 flex items-center",children:[se.jsx(y,{className:"w-4 h-4 mr-2"}),"Strictement Impossible"]}),se.jsxs("ul",{className:"space-y-2 text-slate-400",children:[se.jsxs("li",{className:"flex items-start",children:[se.jsx("span",{className:"mr-2 text-red-500",children:"•"})," Porte fermée à clé (Verrouillée)"]}),se.jsxs("li",{className:"flex items-start",children:[se.jsx("span",{className:"mr-2 text-red-500",children:"•"})," Serrure bloquée / vandalisée"]}),se.jsxs("li",{className:"flex items-start",children:[se.jsx("span",{className:"mr-2 text-red-500",children:"•"})," Perte de clé totale (si fermé à clé)"]})]})]})]}),se.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-2",children:[se.jsxs("button",{onClick:e,className:"group relative px-8 py-4 bg-orange-600 hover:bg-orange-500 text-white font-bold rounded-xl shadow-lg shadow-orange-900/40 transition-all hover:scale-[1.02] flex items-center justify-center overflow-hidden",children:[se.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:animate-shimmer"}),se.jsxs("div",{className:"flex flex-col items-start text-left",children:[se.jsx("span",{className:"text-sm",children:"Obtenir le Protocole Vidéo"}),se.jsx("span",{className:"text-[10px] font-normal opacity-90",children:"Accès immédiat sécurisé"})]}),se.jsx(m,{className:"ml-4 w-5 h-5 group-hover:translate-x-1 transition-transform"})]}),se.jsxs("div",{className:"flex items-center justify-center gap-3 px-6 py-4 rounded-xl border border-slate-700 bg-slate-800/50 backdrop-blur-sm text-slate-300",children:[se.jsx(b,{className:"w-5 h-5 text-green-500"}),se.jsxs("div",{className:"flex flex-col",children:[se.jsx("span",{className:"text-sm font-bold text-white",children:"Un doute ?"}),se.jsx("span",{className:"text-[10px] text-slate-300",children:"Diagnostic IA Gratuit"})]})]})]}),se.jsxs("div",{className:"flex items-start gap-2 opacity-60 max-w-lg",children:[se.jsx(E,{className:"w-3 h-3 text-slate-400 mt-0.5 flex-shrink-0"}),se.jsxs("p",{className:"text-[10px] text-slate-400 leading-tight",children:[se.jsx("strong",{children:"Cadre légal :"})," Service pédagogique avec obligation de moyens. Ne constitue pas une garantie d'ouverture. L'utilisateur certifie être l'occupant légitime du logement."]})]})]}),se.jsxs("div",{className:"relative hidden lg:block perspective-1000 group",children:[se.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[350px] h-[650px] bg-gradient-to-tr from-orange-600/30 to-blue-600/30 rounded-full blur-[60px] animate-pulse-slow"}),se.jsx("div",{className:"relative w-[300px] mx-auto transform rotate-y-12 rotate-z-2 group-hover:rotate-y-0 group-hover:rotate-z-0 transition-all duration-700 ease-out z-10",children:se.jsxs("div",{className:"relative h-[620px] rounded-[3rem] bg-slate-900 border-[6px] border-slate-800 shadow-2xl overflow-hidden ring-1 ring-white/10",children:[se.jsxs("div",{className:"absolute inset-0 bg-slate-950 flex flex-col",children:[se.jsxs("div",{className:"h-14 w-full flex justify-between items-end px-6 pb-2 text-white/80 text-[10px] font-medium z-20",children:[se.jsx("span",{children:"09:41"}),se.jsxs("div",{className:"flex gap-1.5",children:[se.jsx("div",{className:"h-2.5 w-2.5 bg-white/20 rounded-full"}),se.jsx("div",{className:"h-2.5 w-2.5 bg-white/20 rounded-full"}),se.jsx("div",{className:"h-2.5 w-4 bg-white/80 rounded-sm"})]})]}),se.jsxs("div",{className:"px-6 py-4 border-b border-slate-800/50 flex justify-between items-center z-20 bg-slate-950/80 backdrop-blur",children:[se.jsxs("div",{className:"flex items-center gap-2",children:[se.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-orange-500 to-pink-600 flex items-center justify-center shadow-lg shadow-orange-500/20",children:se.jsx(_,{className:"w-4 h-4 text-white"})}),se.jsx("span",{className:"font-bold text-white text-sm tracking-tight",children:"SerrureMaster"})]}),se.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-800 border border-slate-700"})]}),se.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[se.jsxs("div",{className:"relative h-64 bg-slate-900 m-4 rounded-2xl overflow-hidden border border-slate-800 group-hover:border-orange-500/30 transition-colors",children:[se.jsx("img",{src:n,className:"absolute inset-0 w-full h-full object-cover opacity-40 mix-blend-overlay",alt:"Secure Content",fetchPriority:"high",loading:"eager"}),se.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900 via-slate-900/50 to-transparent"}),se.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-center p-4",children:[se.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-900/80 backdrop-blur border border-orange-500/50 flex items-center justify-center mb-3 shadow-[0_0_15px_rgba(249,115,22,0.3)] animate-pulse",children:se.jsx(_,{className:"w-5 h-5 text-orange-500"})}),se.jsx("h3",{className:"text-white font-bold text-lg mb-1",children:"Guide : Porte Claquée"}),se.jsx("p",{className:"text-orange-400 text-xs font-mono tracking-wider uppercase",children:"Contenu Sécurisé"})]}),se.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-slate-800",children:se.jsx("div",{className:"h-full w-1/3 bg-orange-500"})})]}),se.jsxs("div",{className:"px-4 space-y-3",children:[se.jsxs("div",{className:"h-16 rounded-xl bg-slate-900 border border-slate-800 flex items-center px-4 gap-3 opacity-60",children:[se.jsx("div",{className:"w-8 h-8 rounded bg-slate-800 flex items-center justify-center",children:se.jsx(w,{className:"w-4 h-4 text-slate-500"})}),se.jsxs("div",{className:"flex-1",children:[se.jsx("div",{className:"h-2 w-24 bg-slate-700 rounded mb-1.5"}),se.jsx("div",{className:"h-1.5 w-16 bg-slate-800 rounded"})]}),se.jsx(_,{className:"w-3 h-3 text-slate-600"})]}),se.jsxs("div",{className:"h-16 rounded-xl bg-slate-900 border border-slate-800 flex items-center px-4 gap-3 opacity-40",children:[se.jsx("div",{className:"w-8 h-8 rounded bg-slate-800 flex items-center justify-center",children:se.jsx(N,{className:"w-4 h-4 text-slate-500"})}),se.jsxs("div",{className:"flex-1",children:[se.jsx("div",{className:"h-2 w-20 bg-slate-700 rounded mb-1.5"}),se.jsx("div",{className:"h-1.5 w-12 bg-slate-800 rounded"})]}),se.jsx(_,{className:"w-3 h-3 text-slate-600"})]})]}),se.jsx("div",{className:"absolute bottom-8 left-4 right-4",children:se.jsx("div",{className:"w-full py-3 bg-gradient-to-r from-orange-600 to-orange-500 rounded-xl text-center text-white text-xs font-bold shadow-lg shadow-orange-900/40 opacity-90",children:"Débloquer le Plan d'Action"})})]})]}),se.jsx("div",{className:"absolute inset-0 pointer-events-none bg-gradient-to-tr from-transparent via-white/5 to-transparent rounded-[2.5rem] z-30"})]})}),se.jsx("div",{className:"absolute top-[20%] -right-6 z-40 bg-slate-800/90 backdrop-blur border border-slate-700 p-3 rounded-xl shadow-xl animate-float delay-0",children:se.jsxs("div",{className:"flex items-center gap-3",children:[se.jsx("div",{className:"bg-green-500/20 p-2 rounded-full text-green-500 border border-green-500/30",children:se.jsx(l,{className:"w-5 h-5"})}),se.jsxs("div",{children:[se.jsx("p",{className:"text-white text-xs font-bold",children:"Légal & Éthique"}),se.jsx("p",{className:"text-[10px] text-slate-400",children:"Sans effraction"})]})]})}),se.jsx("div",{className:"absolute bottom-[25%] -left-8 z-40 bg-slate-800/90 backdrop-blur border border-slate-700 p-3 rounded-xl shadow-xl animate-float delay-2000",children:se.jsxs("div",{className:"flex items-center gap-3",children:[se.jsx("div",{className:"bg-blue-500/20 p-2 rounded-full text-blue-400 border border-blue-500/30",children:se.jsx(_,{className:"w-5 h-5"})}),se.jsxs("div",{children:[se.jsx("p",{className:"text-white text-xs font-bold",children:"Méthode Pro"}),se.jsx("p",{className:"text-[10px] text-slate-400",children:"Accès immédiat"})]})]})})]})]})}),se.jsx("style",{children:"\n        .perspective-1000 { perspective: 1000px; }\n        @keyframes blob {\n          0% { transform: translate(0px, 0px) scale(1); }\n          33% { transform: translate(30px, -50px) scale(1.1); }\n          66% { transform: translate(-20px, 20px) scale(0.9); }\n          100% { transform: translate(0px, 0px) scale(1); }\n        }\n        .animate-blob { animation: blob 7s infinite; }\n        .animate-shimmer { animation: shimmer 2s infinite; }\n        @keyframes shimmer { 100% { transform: translateX(100%); } }\n        @keyframes float { \n          0%, 100% { transform: translateY(0); } \n          50% { transform: translateY(-10px); } \n        }\n        .animate-float { animation: float 5s ease-in-out infinite; }\n        .rotate-y-12 { transform: rotateY(-12deg); }\n        .rotate-z-2 { transform: rotateZ(2deg); }\n      "})]})});_e.displayName="Hero";const we=i.memo(({product:e,isOwned:t})=>{const{addToCart:n,items:o}=ue(),i=s.useMemo(()=>o.some(t=>t.id===e.id),[o,e.id]);if(!e)return null;const r=s.useMemo(()=>e.image||"/images/p1.jpg",[e.image]),a=s.useMemo(()=>e.description||"Description non disponible",[e.description]),l=s.useCallback(()=>{n(e)},[n,e]);return se.jsxs("div",{className:"bg-white border-2 border-slate-200 rounded-2xl p-4 shadow-lg hover:shadow-2xl hover:shadow-orange-500/30 hover:border-orange-500 hover:-translate-y-3 hover:rotate-1 transition-all duration-300 flex flex-col h-full relative overflow-hidden group cursor-pointer",children:[se.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-400/0 to-purple-400/0 group-hover:from-orange-400/20 group-hover:to-purple-400/10 transition-all duration-300 pointer-events-none rounded-2xl"}),se.jsxs("div",{className:"h-32 sm:h-40 -mx-4 -mt-4 mb-4 overflow-hidden relative bg-gradient-to-br from-orange-50 to-purple-50 rounded-t-2xl group-hover:shadow-lg transition-all duration-300",children:[se.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-white/80 via-transparent to-transparent z-10"}),se.jsx("img",{src:r,alt:e.title||"Produit",decoding:"async",onError:e=>{e.target.src="/images/p1.jpg"},className:"w-full h-full object-cover grayscale-0 group-hover:grayscale-0 brightness-100 group-hover:brightness-110 saturate-100 group-hover:saturate-125 group-hover:scale-110 group-hover:rotate-2 transition-all duration-500 ease-out"})]}),se.jsxs("div",{className:"flex-1 flex flex-col z-10",children:[se.jsx("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-2 group-hover:text-orange-600 group-hover:translate-x-1 transition-all duration-200 line-clamp-2 min-h-[3rem] flex items-center leading-tight",children:e.title}),se.jsx("p",{className:"text-slate-600 mb-3 text-xs sm:text-sm leading-relaxed line-clamp-3 min-h-[3.5rem]",children:a}),e.compatibility?se.jsx("div",{className:"mb-3 bg-gradient-to-br from-slate-50 to-slate-100/50 p-3 rounded-xl border border-slate-200 flex-1 shadow-sm group-hover:border-orange-200 transition-colors duration-300",children:se.jsxs("ul",{className:"text-xs sm:text-sm text-slate-700 space-y-1.5",children:[e.compatibility.valid.slice(0,2).map((e,t)=>se.jsxs("li",{className:"flex gap-2 items-start",children:[se.jsx(x,{className:"text-green-500 w-4 h-4 mt-0.5 flex-shrink-0"}),se.jsx("span",{className:"text-slate-800 line-clamp-1",children:e})]},`v-${t}`)),e.compatibility.invalid.slice(0,1).map((e,t)=>se.jsxs("li",{className:"flex gap-2 items-start opacity-60",children:[se.jsx(y,{className:"text-red-400 w-4 h-4 mt-0.5 flex-shrink-0"}),se.jsx("span",{className:"text-slate-400 line-clamp-1",children:e})]},`i-${t}`))]})}):se.jsx("div",{className:"mb-3 flex-1 bg-slate-50 rounded-xl border border-slate-200 opacity-0"}),se.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-2.5 text-[11px] font-semibold text-slate-700 mb-3 border border-green-200 flex items-center justify-between shadow-sm group-hover:scale-105 group-hover:shadow-md transition-all duration-200",children:se.jsxs("span",{className:"flex items-center gap-2",children:[se.jsx(b,{className:"text-green-600 w-4 h-4 group-hover:animate-pulse"}),"Assistance Pro incluse"]})}),se.jsxs("div",{className:"flex items-center justify-between mt-auto pt-3 border-t-2 border-slate-100 group-hover:border-orange-200 transition-colors duration-300",children:[se.jsxs("div",{className:"flex flex-col group-hover:scale-105 transition-transform duration-200",children:[se.jsxs("span",{className:"text-slate-900 text-2xl sm:text-3xl font-black tracking-tight",children:[e.price," €"]}),e.originalPrice&&se.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[se.jsxs("span",{className:"text-slate-400 line-through text-xs font-medium",children:[e.originalPrice," €"]}),se.jsxs("span",{className:"bg-green-100 text-green-700 text-[10px] font-bold px-1.5 py-0.5 rounded-full animate-pulse",children:["-",Math.round((e.originalPrice-e.price)/e.originalPrice*100),"%"]})]})]}),se.jsx("button",{onClick:l,disabled:t||i,className:"px-3 sm:px-4 py-2 sm:py-2.5 rounded-lg font-bold text-xs sm:text-sm transition-all shadow-lg transform active:scale-90 flex items-center group-hover:scale-110 "+(t?"bg-gradient-to-r from-green-50 to-emerald-50 text-green-700 border-2 border-green-300 cursor-default shadow-green-200":i?"bg-gradient-to-r from-slate-100 to-slate-200 text-slate-700 border-2 border-slate-300 cursor-default shadow-slate-300":"bg-gradient-to-r from-orange-500 to-orange-600 text-white hover:from-orange-600 hover:to-orange-700 shadow-orange-500/50 hover:shadow-orange-500/80 border-2 border-orange-400 hover:rotate-3"),children:t?se.jsxs(se.Fragment,{children:[se.jsx(S,{className:"w-4 h-4 mr-2"})," Acquis"]}):i?se.jsxs(se.Fragment,{children:[se.jsx(x,{className:"w-4 h-4 mr-2"})," Au panier"]}):"Ajouter au panier"})]})]})]})});we.displayName="ProductCard";var Ne={};class Se{}function Ie(e,t){return e.replace(/\{([^}]+)\}/g,(e,n)=>{if(Object.prototype.hasOwnProperty.call(t,n)){const e=t[n];return null!=e?String(e):""}throw new Error(`Key '${n}' not found in valueMap.`)})}function Ae(e,t,n){for(let i=0;i<t.length-1;i++){const s=t[i];if(s.endsWith("[]")){const o=s.slice(0,-2);if(!(o in e)){if(!Array.isArray(n))throw new Error(`Value must be a list given an array path ${s}`);e[o]=Array.from({length:n.length},()=>({}))}if(Array.isArray(e[o])){const s=e[o];if(Array.isArray(n))for(let e=0;e<s.length;e++)Ae(s[e],t.slice(i+1),n[e]);else for(const e of s)Ae(e,t.slice(i+1),n)}return}if(s.endsWith("[0]")){const o=s.slice(0,-3);return o in e||(e[o]=[{}]),void Ae(e[o][0],t.slice(i+1),n)}e[s]&&"object"==typeof e[s]||(e[s]={}),e=e[s]}const s=t[t.length-1],o=e[s];if(void 0!==o){if(!n||"object"==typeof n&&0===Object.keys(n).length)return;if(n===o)return;if("object"!=typeof o||"object"!=typeof n||null===o||null===n)throw new Error(`Cannot set value for an existing key. Key: ${s}`);Object.assign(o,n)}else if("_self"!==s||"object"!=typeof n||null===n||Array.isArray(n))e[s]=n;else{const t=n;Object.assign(e,t)}}function Te(e,t,n=void 0){try{if(1===t.length&&"_self"===t[0])return e;for(let s=0;s<t.length;s++){if("object"!=typeof e||null===e)return n;const o=t[s];if(o.endsWith("[]")){const i=o.slice(0,-2);if(i in e){const o=e[i];return Array.isArray(o)?o.map(e=>Te(e,t.slice(s+1),n)):n}return n}e=e[o]}return e}catch(s){if(s instanceof TypeError)return n;throw s}}function Ce(e,t,n,s,o){if(s>=t.length)return;if("object"!=typeof e||null===e)return;const i=t[s];if(i.endsWith("[]")){const r=i.slice(0,-2),a=e;if(r in a&&Array.isArray(a[r]))for(const e of a[r])Ce(e,t,n,s+1,o)}else if("*"===i){if("object"==typeof e&&null!==e&&!Array.isArray(e)){const t=e,i=Object.keys(t).filter(e=>!e.startsWith("_")&&!o.has(e)),r={};for(const e of i)r[e]=t[e];for(const[e,o]of Object.entries(r)){const i=[];for(const t of n.slice(s))"*"===t?i.push(e):i.push(t);Ae(t,i,o)}for(const e of i)delete t[e]}}else i in e&&Ce(e[i],t,n,s+1,o)}function Oe(e){if("string"!=typeof e)throw new Error("fromImageBytes must be a string");return e}function je(e){const t={},n=Te(e,["name"]);null!=n&&Ae(t,["name"],n);const s=Te(e,["metadata"]);null!=s&&Ae(t,["metadata"],s);const o=Te(e,["done"]);null!=o&&Ae(t,["done"],o);const i=Te(e,["error"]);null!=i&&Ae(t,["error"],i);const r=Te(e,["response"]);return null!=r&&Ae(t,["response"],function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["parent"]);null!=s&&Ae(t,["parent"],s);const o=Te(e,["documentName"]);return null!=o&&Ae(t,["documentName"],o),t}(r)),t}var Re,Pe,De,Me,Ue,ke,qe,Le,Ge,Fe,Ve,He,Be,Je,$e,Ye,ze,We,Ke,Xe,Qe,Ze,et,tt,nt,st,ot,it,rt,at,lt,ct,ut,dt,pt,mt,ht,ft,gt,vt,xt,yt,bt,Et,_t,wt,Nt,St,It,At,Tt,Ct,Ot,jt,Rt,Pt,Dt,Mt,Ut,kt,qt,Lt,Gt,Ft,Vt,Ht,Bt,Jt,$t,Yt,zt,Wt,Kt,Xt,Qt,Zt,en,tn,nn,sn,on,rn,an,ln,cn,un,dn,pn,mn,hn,fn,gn,vn,xn,yn,bn,En,_n,wn,Nn,Sn,In,An,Tn,Cn,On,jn,Rn,Pn,Dn,Mn,Un,kn,qn;(Pe=Re||(Re={})).OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",Pe.OUTCOME_OK="OUTCOME_OK",Pe.OUTCOME_FAILED="OUTCOME_FAILED",Pe.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED",(Me=De||(De={})).LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",Me.PYTHON="PYTHON",(ke=Ue||(Ue={})).SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",ke.SILENT="SILENT",ke.WHEN_IDLE="WHEN_IDLE",ke.INTERRUPT="INTERRUPT",(Le=qe||(qe={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",Le.STRING="STRING",Le.NUMBER="NUMBER",Le.INTEGER="INTEGER",Le.BOOLEAN="BOOLEAN",Le.ARRAY="ARRAY",Le.OBJECT="OBJECT",Le.NULL="NULL",(Fe=Ge||(Ge={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",Fe.MODE_DYNAMIC="MODE_DYNAMIC",(He=Ve||(Ve={})).API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",He.SIMPLE_SEARCH="SIMPLE_SEARCH",He.ELASTIC_SEARCH="ELASTIC_SEARCH",(Je=Be||(Be={})).AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",Je.NO_AUTH="NO_AUTH",Je.API_KEY_AUTH="API_KEY_AUTH",Je.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",Je.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",Je.OAUTH="OAUTH",Je.OIDC_AUTH="OIDC_AUTH",(Ye=$e||($e={})).HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",Ye.HTTP_IN_QUERY="HTTP_IN_QUERY",Ye.HTTP_IN_HEADER="HTTP_IN_HEADER",Ye.HTTP_IN_PATH="HTTP_IN_PATH",Ye.HTTP_IN_BODY="HTTP_IN_BODY",Ye.HTTP_IN_COOKIE="HTTP_IN_COOKIE",(We=ze||(ze={})).PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",We.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",We.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",We.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",We.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",We.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",We.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH",(Xe=Ke||(Ke={})).THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",Xe.LOW="LOW",Xe.MEDIUM="MEDIUM",Xe.HIGH="HIGH",Xe.MINIMAL="MINIMAL",(Ze=Qe||(Qe={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",Ze.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",Ze.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",Ze.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",Ze.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",Ze.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",Ze.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",Ze.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",Ze.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",Ze.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",Ze.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK",(tt=et||(et={})).HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",tt.SEVERITY="SEVERITY",tt.PROBABILITY="PROBABILITY",(st=nt||(nt={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",st.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",st.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",st.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",st.BLOCK_NONE="BLOCK_NONE",st.OFF="OFF",(it=ot||(ot={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",it.STOP="STOP",it.MAX_TOKENS="MAX_TOKENS",it.SAFETY="SAFETY",it.RECITATION="RECITATION",it.LANGUAGE="LANGUAGE",it.OTHER="OTHER",it.BLOCKLIST="BLOCKLIST",it.PROHIBITED_CONTENT="PROHIBITED_CONTENT",it.SPII="SPII",it.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",it.IMAGE_SAFETY="IMAGE_SAFETY",it.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",it.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",it.NO_IMAGE="NO_IMAGE",it.IMAGE_RECITATION="IMAGE_RECITATION",it.IMAGE_OTHER="IMAGE_OTHER",(at=rt||(rt={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",at.NEGLIGIBLE="NEGLIGIBLE",at.LOW="LOW",at.MEDIUM="MEDIUM",at.HIGH="HIGH",(ct=lt||(lt={})).HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",ct.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",ct.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",ct.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",ct.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH",(dt=ut||(ut={})).URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",dt.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",dt.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",dt.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",dt.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE",(mt=pt||(pt={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",mt.SAFETY="SAFETY",mt.OTHER="OTHER",mt.BLOCKLIST="BLOCKLIST",mt.PROHIBITED_CONTENT="PROHIBITED_CONTENT",mt.IMAGE_SAFETY="IMAGE_SAFETY",mt.MODEL_ARMOR="MODEL_ARMOR",mt.JAILBREAK="JAILBREAK",(ft=ht||(ht={})).TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",ft.ON_DEMAND="ON_DEMAND",ft.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT",(vt=gt||(gt={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",vt.TEXT="TEXT",vt.IMAGE="IMAGE",vt.AUDIO="AUDIO",(yt=xt||(xt={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",yt.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",yt.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",yt.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(Et=bt||(bt={})).TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",Et.TUNING_MODE_FULL="TUNING_MODE_FULL",Et.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER",(wt=_t||(_t={})).ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",wt.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",wt.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",wt.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",wt.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",wt.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",wt.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO",(St=Nt||(Nt={})).JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",St.JOB_STATE_QUEUED="JOB_STATE_QUEUED",St.JOB_STATE_PENDING="JOB_STATE_PENDING",St.JOB_STATE_RUNNING="JOB_STATE_RUNNING",St.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",St.JOB_STATE_FAILED="JOB_STATE_FAILED",St.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",St.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",St.JOB_STATE_PAUSED="JOB_STATE_PAUSED",St.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",St.JOB_STATE_UPDATING="JOB_STATE_UPDATING",St.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",(At=It||(It={})).TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",At.TUNING_TASK_I2V="TUNING_TASK_I2V",At.TUNING_TASK_T2V="TUNING_TASK_T2V",At.TUNING_TASK_R2V="TUNING_TASK_R2V",(Ct=Tt||(Tt={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",Ct.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",Ct.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",Ct.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",Ct.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH",(jt=Ot||(Ot={})).FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",jt.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",jt.BALANCED="BALANCED",jt.PRIORITIZE_COST="PRIORITIZE_COST",(Pt=Rt||(Rt={})).UNSPECIFIED="UNSPECIFIED",Pt.BLOCKING="BLOCKING",Pt.NON_BLOCKING="NON_BLOCKING",(Mt=Dt||(Dt={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",Mt.MODE_DYNAMIC="MODE_DYNAMIC",(kt=Ut||(Ut={})).ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",kt.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER",(Lt=qt||(qt={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",Lt.AUTO="AUTO",Lt.ANY="ANY",Lt.NONE="NONE",Lt.VALIDATED="VALIDATED",(Ft=Gt||(Gt={})).BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",Ft.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",Ft.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",Ft.BLOCK_NONE="BLOCK_NONE",(Ht=Vt||(Vt={})).DONT_ALLOW="DONT_ALLOW",Ht.ALLOW_ADULT="ALLOW_ADULT",Ht.ALLOW_ALL="ALLOW_ALL",(Jt=Bt||(Bt={})).auto="auto",Jt.en="en",Jt.ja="ja",Jt.ko="ko",Jt.hi="hi",Jt.zh="zh",Jt.pt="pt",Jt.es="es",(Yt=$t||($t={})).MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",Yt.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",Yt.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",Yt.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",Yt.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC",(Wt=zt||(zt={})).CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",Wt.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",Wt.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",Wt.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH",(Xt=Kt||(Kt={})).SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",Xt.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",Xt.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",Xt.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT",(Zt=Qt||(Qt={})).EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",Zt.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",Zt.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",Zt.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",Zt.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",Zt.EDIT_MODE_STYLE="EDIT_MODE_STYLE",Zt.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",Zt.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE",(tn=en||(en={})).FOREGROUND="FOREGROUND",tn.BACKGROUND="BACKGROUND",tn.PROMPT="PROMPT",tn.SEMANTIC="SEMANTIC",tn.INTERACTIVE="INTERACTIVE",(sn=nn||(nn={})).ASSET="ASSET",sn.STYLE="STYLE",(rn=on||(on={})).INSERT="INSERT",rn.REMOVE="REMOVE",rn.REMOVE_STATIC="REMOVE_STATIC",rn.OUTPAINT="OUTPAINT",(ln=an||(an={})).OPTIMIZED="OPTIMIZED",ln.LOSSLESS="LOSSLESS",(un=cn||(cn={})).SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",un.PREFERENCE_TUNING="PREFERENCE_TUNING",(pn=dn||(dn={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",pn.STATE_PENDING="STATE_PENDING",pn.STATE_ACTIVE="STATE_ACTIVE",pn.STATE_FAILED="STATE_FAILED",(hn=mn||(mn={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",hn.PROCESSING="PROCESSING",hn.ACTIVE="ACTIVE",hn.FAILED="FAILED",(gn=fn||(fn={})).SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",gn.UPLOADED="UPLOADED",gn.GENERATED="GENERATED",(xn=vn||(vn={})).TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",xn.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",xn.RESPONSE_REJECTED="RESPONSE_REJECTED",xn.NEED_MORE_INPUT="NEED_MORE_INPUT",(bn=yn||(yn={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",bn.TEXT="TEXT",bn.IMAGE="IMAGE",bn.VIDEO="VIDEO",bn.AUDIO="AUDIO",bn.DOCUMENT="DOCUMENT",(_n=En||(En={})).VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",_n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",_n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS",(Nn=wn||(wn={})).START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",Nn.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",Nn.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW",(In=Sn||(Sn={})).END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",In.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",In.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW",(Tn=An||(An={})).ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",Tn.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",Tn.NO_INTERRUPTION="NO_INTERRUPTION",(On=Cn||(Cn={})).TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",On.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",On.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT",(Rn=jn||(jn={})).SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",Rn.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",Rn.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",Rn.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",Rn.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",Rn.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",Rn.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",Rn.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",Rn.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",Rn.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",Rn.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",Rn.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",Rn.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR",(Dn=Pn||(Pn={})).MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",Dn.QUALITY="QUALITY",Dn.DIVERSITY="DIVERSITY",Dn.VOCALIZATION="VOCALIZATION",(Un=Mn||(Mn={})).PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",Un.PLAY="PLAY",Un.PAUSE="PAUSE",Un.STOP="STOP",Un.RESET_CONTEXT="RESET_CONTEXT";class Ln{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Gn{get text(){var e,t,n,s,o,i,r,a;if(0===(null===(s=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===s?void 0:s.length))return;this.candidates&&this.candidates.length;let l="",c=!1;const u=[];for(const d of null!==(a=null===(r=null===(i=null===(o=this.candidates)||void 0===o?void 0:o[0])||void 0===i?void 0:i.content)||void 0===r?void 0:r.parts)&&void 0!==a?a:[]){for(const[e,t]of Object.entries(d))"text"===e||"thought"===e||"thoughtSignature"===e||null===t&&void 0===t||u.push(e);if("string"==typeof d.text){if("boolean"==typeof d.thought&&d.thought)continue;c=!0,l+=d.text}}return u.length,c?l:void 0}get data(){var e,t,n,s,o,i,r,a;if(0===(null===(s=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===s?void 0:s.length))return;this.candidates&&this.candidates.length;let l="";const c=[];for(const u of null!==(a=null===(r=null===(i=null===(o=this.candidates)||void 0===o?void 0:o[0])||void 0===i?void 0:i.content)||void 0===r?void 0:r.parts)&&void 0!==a?a:[]){for(const[e,t]of Object.entries(u))"inlineData"===e||null===t&&void 0===t||c.push(e);u.inlineData&&"string"==typeof u.inlineData.data&&(l+=atob(u.inlineData.data))}return c.length,l.length>0?btoa(l):void 0}get functionCalls(){var e,t,n,s,o,i,r,a;if(0===(null===(s=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===s?void 0:s.length))return;this.candidates&&this.candidates.length;const l=null===(a=null===(r=null===(i=null===(o=this.candidates)||void 0===o?void 0:o[0])||void 0===i?void 0:i.content)||void 0===r?void 0:r.parts)||void 0===a?void 0:a.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);return 0!==(null==l?void 0:l.length)?l:void 0}get executableCode(){var e,t,n,s,o,i,r,a,l;if(0===(null===(s=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===s?void 0:s.length))return;this.candidates&&this.candidates.length;const c=null===(a=null===(r=null===(i=null===(o=this.candidates)||void 0===o?void 0:o[0])||void 0===i?void 0:i.content)||void 0===r?void 0:r.parts)||void 0===a?void 0:a.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);return 0!==(null==c?void 0:c.length)?null===(l=null==c?void 0:c[0])||void 0===l?void 0:l.code:void 0}get codeExecutionResult(){var e,t,n,s,o,i,r,a,l;if(0===(null===(s=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===s?void 0:s.length))return;this.candidates&&this.candidates.length;const c=null===(a=null===(r=null===(i=null===(o=this.candidates)||void 0===o?void 0:o[0])||void 0===i?void 0:i.content)||void 0===r?void 0:r.parts)||void 0===a?void 0:a.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);return 0!==(null==c?void 0:c.length)?null===(l=null==c?void 0:c[0])||void 0===l?void 0:l.output:void 0}}class Fn{}class Vn{}class Hn{}class Bn{}class Jn{}class $n{}class Yn{}class zn{}class Wn{}class Kn{}class Xn{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new Xn;let s;const o=e;return s=t?function(e){const t={},n=Te(e,["name"]);null!=n&&Ae(t,["name"],n);const s=Te(e,["metadata"]);null!=s&&Ae(t,["metadata"],s);const o=Te(e,["done"]);null!=o&&Ae(t,["done"],o);const i=Te(e,["error"]);null!=i&&Ae(t,["error"],i);const r=Te(e,["response"]);return null!=r&&Ae(t,["response"],function(e){const t={},n=Te(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["_self"]);return null!=n&&Ae(t,["video"],function(e){const t={},n=Te(e,["gcsUri"]);null!=n&&Ae(t,["uri"],n);const s=Te(e,["bytesBase64Encoded"]);null!=s&&Ae(t,["videoBytes"],Oe(s));const o=Te(e,["mimeType"]);return null!=o&&Ae(t,["mimeType"],o),t}(n)),t}(e))),Ae(t,["generatedVideos"],e)}const s=Te(e,["raiMediaFilteredCount"]);null!=s&&Ae(t,["raiMediaFilteredCount"],s);const o=Te(e,["raiMediaFilteredReasons"]);return null!=o&&Ae(t,["raiMediaFilteredReasons"],o),t}(r)),t}(o):function(e){const t={},n=Te(e,["name"]);null!=n&&Ae(t,["name"],n);const s=Te(e,["metadata"]);null!=s&&Ae(t,["metadata"],s);const o=Te(e,["done"]);null!=o&&Ae(t,["done"],o);const i=Te(e,["error"]);null!=i&&Ae(t,["error"],i);const r=Te(e,["response","generateVideoResponse"]);return null!=r&&Ae(t,["response"],function(e){const t={},n=Te(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["video"]);return null!=n&&Ae(t,["video"],function(e){const t={},n=Te(e,["uri"]);null!=n&&Ae(t,["uri"],n);const s=Te(e,["encodedVideo"]);null!=s&&Ae(t,["videoBytes"],Oe(s));const o=Te(e,["encoding"]);return null!=o&&Ae(t,["mimeType"],o),t}(n)),t}(e))),Ae(t,["generatedVideos"],e)}const s=Te(e,["raiMediaFilteredCount"]);null!=s&&Ae(t,["raiMediaFilteredCount"],s);const o=Te(e,["raiMediaFilteredReasons"]);return null!=o&&Ae(t,["raiMediaFilteredReasons"],o),t}(r)),t}(o),Object.assign(n,s),n}}class Qn{}class Zn{}class es{}class ts{}class ns{}class ss{}class os{}class is{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new is,s=function(e){const t={},n=Te(e,["name"]);null!=n&&Ae(t,["name"],n);const s=Te(e,["metadata"]);null!=s&&Ae(t,["metadata"],s);const o=Te(e,["done"]);null!=o&&Ae(t,["done"],o);const i=Te(e,["error"]);null!=i&&Ae(t,["error"],i);const r=Te(e,["response"]);return null!=r&&Ae(t,["response"],function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["parent"]);null!=s&&Ae(t,["parent"],s);const o=Te(e,["documentName"]);return null!=o&&Ae(t,["documentName"],o),t}(r)),t}(e);return Object.assign(n,s),n}}class rs{}class as{}class ls{}class cs{}class us{get text(){var e,t,n;let s="",o=!1;const i=[];for(const r of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(const[e,t]of Object.entries(r))"text"!==e&&"thought"!==e&&null!==t&&i.push(e);if("string"==typeof r.text){if("boolean"==typeof r.thought&&r.thought)continue;o=!0,s+=r.text}}return i.length,o?s:void 0}get data(){var e,t,n;let s="";const o=[];for(const i of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(const[e,t]of Object.entries(i))"inlineData"!==e&&null!==t&&o.push(e);i.inlineData&&"string"==typeof i.inlineData.data&&(s+=atob(i.inlineData.data))}return o.length,s.length>0?btoa(s):void 0}}class ds{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class ps{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new ps,s=je(e);return Object.assign(n,s),n}}function ms(e,t){if(!t||"string"!=typeof t)throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}return`publishers/google/models/${t}`}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function hs(e,t){const n=ms(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function fs(e){return Array.isArray(e)?e.map(e=>gs(e)):[gs(e)]}function gs(e){if("object"==typeof e&&null!==e)return e;throw new Error("Could not parse input as Blob. Unsupported blob type: "+typeof e)}function vs(e){const t=gs(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function xs(e){const t=gs(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function ys(e){if(null==e)throw new Error("PartUnion is required");if("object"==typeof e)return e;if("string"==typeof e)return{text:e};throw new Error("Unsupported part type: "+typeof e)}function bs(e){if(null==e||Array.isArray(e)&&0===e.length)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(e=>ys(e)):[ys(e)]}function Es(e){return null!=e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts)}function _s(e){return null!=e&&"object"==typeof e&&"functionCall"in e}function ws(e){return null!=e&&"object"==typeof e&&"functionResponse"in e}function Ns(e){if(null==e)throw new Error("ContentUnion is required");return Es(e)?e:{role:"user",parts:bs(e)}}function Ss(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{const t=Ns(e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]});if(e.isVertexAI()){const e=Ns(t);return e.parts&&e.parts.length>0&&void 0!==e.parts[0].text?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>Ns(e)):[Ns(t)]}function Is(e){if(null==e||Array.isArray(e)&&0===e.length)throw new Error("contents are required");if(!Array.isArray(e)){if(_s(e)||ws(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ns(e)]}const t=[],n=[],s=Es(e[0]);for(const o of e){const e=Es(o);if(e!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(e)t.push(o);else{if(_s(o)||ws(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(o)}}return s||t.push({role:"user",parts:bs(n)}),t}function As(e){const t={},n=["items"],s=["anyOf"],o=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const i=e.anyOf;null!=i&&2==i.length&&("null"===i[0].type?(t.nullable=!0,e=i[1]):"null"===i[1].type&&(t.nullable=!0,e=i[0])),e.type instanceof Array&&function(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(e=>"null"!==e);if(1===n.length)t.type=Object.values(qe).includes(n[0].toUpperCase())?n[0].toUpperCase():qe.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const e of n)t.anyOf.push({type:Object.values(qe).includes(e.toUpperCase())?e.toUpperCase():qe.TYPE_UNSPECIFIED})}}(e.type,t);for(const[r,a]of Object.entries(e))if(null!=a)if("type"==r){if("null"===a)throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;t.type=Object.values(qe).includes(a.toUpperCase())?a.toUpperCase():qe.TYPE_UNSPECIFIED}else if(n.includes(r))t[r]=As(a);else if(s.includes(r)){const e=[];for(const n of a)"null"!=n.type?e.push(As(n)):t.nullable=!0;t[r]=e}else if(o.includes(r)){const e={};for(const[t,n]of Object.entries(a))e[t]=As(n);t[r]=e}else{if("additionalProperties"===r)continue;t[r]=a}return t}function Ts(e){return As(e)}function Cs(e){if("object"==typeof e)return e;if("string"==typeof e)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error("Unsupported speechConfig type: "+typeof e)}function Os(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function js(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=As(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=As(t.response));return e}function Rs(e){if(null==e)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function Ps(e,t){if("string"!=typeof t)throw new Error("name must be a string");return function(e,t,n,s=1){const o=!t.startsWith(`${n}/`)&&t.split("/").length===s;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:o?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:o?`${n}/${t}`:t}(e,t,"cachedContents")}function Ds(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Ms(e){return Oe(e)}function Us(e){var t;let n;var s;if(null!=(s=e)&&"object"==typeof s&&"name"in s&&(n=e.name),!(function(e){return null!=e&&"object"==typeof e&&"uri"in e}(e)&&(n=e.uri,void 0===n)||function(e){return null!=e&&"object"==typeof e&&"video"in e}(e)&&(n=null===(t=e.video)||void 0===t?void 0:t.uri,void 0===n))){if("string"==typeof e&&(n=e),void 0===n)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const e=n.split("files/")[1].match(/[a-z0-9]+/);if(null===e)throw new Error(`Could not extract file name from URI ${n}`);n=e[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function ks(e,t){let n;return n=e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels",n}function qs(e){for(const t of["models","tunedModels","publisherModels"])if(Ls(e,t))return e[t];return[]}function Ls(e,t){return null!==e&&"object"==typeof e&&t in e}function Gs(e,t={}){const n=e,s={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(s.responseJsonSchema=n.outputSchema),t.behavior&&(s.behavior=t.behavior),{functionDeclarations:[s]}}function Fs(e,t){let n;if("string"==typeof t)if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else{if(!t.startsWith("bq://"))throw new Error(`Unsupported string source for Vertex AI: ${t}`);n={format:"bigquery",bigqueryUri:t}}else{if(!t.startsWith("files/"))throw new Error(`Unsupported string source for Gemini API: ${t}`);n={fileName:t}}else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;const s=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,o=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(o>0||1!==s)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(s>0||1!==o)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function Vs(e){if("object"!=typeof e||null===e)return{};const t=e,n=t.inlinedResponses;if("object"!=typeof n||null===n)return e;const s=n.inlinedResponses;if(!Array.isArray(s)||0===s.length)return e;let o=!1;for(const i of s){if("object"!=typeof i||null===i)continue;const e=i.response;if("object"==typeof e&&null!==e&&void 0!==e.embedding){o=!0;break}}return o&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function Hs(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function Bs(e){return"BATCH_STATE_UNSPECIFIED"===e?"JOB_STATE_UNSPECIFIED":"BATCH_STATE_PENDING"===e?"JOB_STATE_PENDING":"BATCH_STATE_RUNNING"===e?"JOB_STATE_RUNNING":"BATCH_STATE_SUCCEEDED"===e?"JOB_STATE_SUCCEEDED":"BATCH_STATE_FAILED"===e?"JOB_STATE_FAILED":"BATCH_STATE_CANCELLED"===e?"JOB_STATE_CANCELLED":"BATCH_STATE_EXPIRED"===e?"JOB_STATE_EXPIRED":e}function Js(e){const t={},n=Te(e,["name"]);null!=n&&Ae(t,["name"],n);const s=Te(e,["metadata","displayName"]);null!=s&&Ae(t,["displayName"],s);const o=Te(e,["metadata","state"]);null!=o&&Ae(t,["state"],Bs(o));const i=Te(e,["metadata","createTime"]);null!=i&&Ae(t,["createTime"],i);const r=Te(e,["metadata","endTime"]);null!=r&&Ae(t,["endTime"],r);const a=Te(e,["metadata","updateTime"]);null!=a&&Ae(t,["updateTime"],a);const l=Te(e,["metadata","model"]);null!=l&&Ae(t,["model"],l);const c=Te(e,["metadata","output"]);return null!=c&&Ae(t,["dest"],function(e){const t={},n=Te(e,["responsesFile"]);null!=n&&Ae(t,["fileName"],n);const s=Te(e,["inlinedResponses","inlinedResponses"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["response"]);null!=n&&Ae(t,["response"],function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["candidates"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["content"]);null!=n&&Ae(t,["content"],n);const s=Te(e,["citationMetadata"]);null!=s&&Ae(t,["citationMetadata"],function(e){const t={},n=Te(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["citations"],e)}return t}(s));const o=Te(e,["tokenCount"]);null!=o&&Ae(t,["tokenCount"],o);const i=Te(e,["finishReason"]);null!=i&&Ae(t,["finishReason"],i);const r=Te(e,["avgLogprobs"]);null!=r&&Ae(t,["avgLogprobs"],r);const a=Te(e,["groundingMetadata"]);null!=a&&Ae(t,["groundingMetadata"],a);const l=Te(e,["index"]);null!=l&&Ae(t,["index"],l);const c=Te(e,["logprobsResult"]);null!=c&&Ae(t,["logprobsResult"],c);const u=Te(e,["safetyRatings"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["safetyRatings"],e)}const d=Te(e,["urlContextMetadata"]);return null!=d&&Ae(t,["urlContextMetadata"],d),t}(e))),Ae(t,["candidates"],e)}const o=Te(e,["modelVersion"]);null!=o&&Ae(t,["modelVersion"],o);const i=Te(e,["promptFeedback"]);null!=i&&Ae(t,["promptFeedback"],i);const r=Te(e,["responseId"]);null!=r&&Ae(t,["responseId"],r);const a=Te(e,["usageMetadata"]);return null!=a&&Ae(t,["usageMetadata"],a),t}(n));const s=Te(e,["error"]);return null!=s&&Ae(t,["error"],s),t}(e))),Ae(t,["inlinedResponses"],e)}const o=Te(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["inlinedEmbedContentResponses"],e)}return t}(Vs(c))),t}function $s(e){const t={},n=Te(e,["name"]);null!=n&&Ae(t,["name"],n);const s=Te(e,["displayName"]);null!=s&&Ae(t,["displayName"],s);const o=Te(e,["state"]);null!=o&&Ae(t,["state"],Bs(o));const i=Te(e,["error"]);null!=i&&Ae(t,["error"],i);const r=Te(e,["createTime"]);null!=r&&Ae(t,["createTime"],r);const a=Te(e,["startTime"]);null!=a&&Ae(t,["startTime"],a);const l=Te(e,["endTime"]);null!=l&&Ae(t,["endTime"],l);const c=Te(e,["updateTime"]);null!=c&&Ae(t,["updateTime"],c);const u=Te(e,["model"]);null!=u&&Ae(t,["model"],u);const d=Te(e,["inputConfig"]);null!=d&&Ae(t,["src"],function(e){const t={},n=Te(e,["instancesFormat"]);null!=n&&Ae(t,["format"],n);const s=Te(e,["gcsSource","uris"]);null!=s&&Ae(t,["gcsUri"],s);const o=Te(e,["bigquerySource","inputUri"]);return null!=o&&Ae(t,["bigqueryUri"],o),t}(d));const p=Te(e,["outputConfig"]);null!=p&&Ae(t,["dest"],function(e){const t={},n=Te(e,["predictionsFormat"]);null!=n&&Ae(t,["format"],n);const s=Te(e,["gcsDestination","outputUriPrefix"]);null!=s&&Ae(t,["gcsUri"],s);const o=Te(e,["bigqueryDestination","outputUri"]);return null!=o&&Ae(t,["bigqueryUri"],o),t}(Vs(p)));const m=Te(e,["completionStats"]);return null!=m&&Ae(t,["completionStats"],m),t}function Ys(e){const t={},n=Te(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["mediaResolution"]);null!=n&&Ae(t,["mediaResolution"],n);const s=Te(e,["codeExecutionResult"]);null!=s&&Ae(t,["codeExecutionResult"],s);const o=Te(e,["executableCode"]);null!=o&&Ae(t,["executableCode"],o);const i=Te(e,["fileData"]);null!=i&&Ae(t,["fileData"],function(e){const t={};if(void 0!==Te(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=Te(e,["fileUri"]);null!=n&&Ae(t,["fileUri"],n);const s=Te(e,["mimeType"]);return null!=s&&Ae(t,["mimeType"],s),t}(i));const r=Te(e,["functionCall"]);null!=r&&Ae(t,["functionCall"],function(e){const t={},n=Te(e,["id"]);null!=n&&Ae(t,["id"],n);const s=Te(e,["args"]);null!=s&&Ae(t,["args"],s);const o=Te(e,["name"]);if(null!=o&&Ae(t,["name"],o),void 0!==Te(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==Te(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(r));const a=Te(e,["functionResponse"]);null!=a&&Ae(t,["functionResponse"],a);const l=Te(e,["inlineData"]);null!=l&&Ae(t,["inlineData"],function(e){const t={},n=Te(e,["data"]);if(null!=n&&Ae(t,["data"],n),void 0!==Te(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const s=Te(e,["mimeType"]);return null!=s&&Ae(t,["mimeType"],s),t}(l));const c=Te(e,["text"]);null!=c&&Ae(t,["text"],c);const u=Te(e,["thought"]);null!=u&&Ae(t,["thought"],u);const d=Te(e,["thoughtSignature"]);null!=d&&Ae(t,["thoughtSignature"],d);const p=Te(e,["videoMetadata"]);return null!=p&&Ae(t,["videoMetadata"],p),t}(e))),Ae(t,["parts"],e)}const s=Te(e,["role"]);return null!=s&&Ae(t,["role"],s),t}function zs(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["src"]);null!=o&&Ae(n,["batch","inputConfig"],function(e,t){const n={};if(void 0!==Te(t,["format"]))throw new Error("format parameter is not supported in Gemini API.");if(void 0!==Te(t,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==Te(t,["bigqueryUri"]))throw new Error("bigqueryUri parameter is not supported in Gemini API.");const s=Te(t,["fileName"]);null!=s&&Ae(n,["fileName"],s);const o=Te(t,["inlinedRequests"]);if(null!=o){let t=o;Array.isArray(t)&&(t=t.map(t=>function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["request","model"],ms(e,s));const o=Te(t,["contents"]);if(null!=o){let e=Is(o);Array.isArray(e)&&(e=e.map(e=>Ys(e))),Ae(n,["request","contents"],e)}const i=Te(t,["metadata"]);null!=i&&Ae(n,["metadata"],i);const r=Te(t,["config"]);return null!=r&&Ae(n,["request","generationConfig"],function(e,t,n){const s={},o=Te(t,["systemInstruction"]);void 0!==n&&null!=o&&Ae(n,["systemInstruction"],Ys(Ns(o)));const i=Te(t,["temperature"]);null!=i&&Ae(s,["temperature"],i);const r=Te(t,["topP"]);null!=r&&Ae(s,["topP"],r);const a=Te(t,["topK"]);null!=a&&Ae(s,["topK"],a);const l=Te(t,["candidateCount"]);null!=l&&Ae(s,["candidateCount"],l);const c=Te(t,["maxOutputTokens"]);null!=c&&Ae(s,["maxOutputTokens"],c);const u=Te(t,["stopSequences"]);null!=u&&Ae(s,["stopSequences"],u);const d=Te(t,["responseLogprobs"]);null!=d&&Ae(s,["responseLogprobs"],d);const p=Te(t,["logprobs"]);null!=p&&Ae(s,["logprobs"],p);const m=Te(t,["presencePenalty"]);null!=m&&Ae(s,["presencePenalty"],m);const h=Te(t,["frequencyPenalty"]);null!=h&&Ae(s,["frequencyPenalty"],h);const f=Te(t,["seed"]);null!=f&&Ae(s,["seed"],f);const g=Te(t,["responseMimeType"]);null!=g&&Ae(s,["responseMimeType"],g);const v=Te(t,["responseSchema"]);null!=v&&Ae(s,["responseSchema"],Ts(v));const x=Te(t,["responseJsonSchema"]);if(null!=x&&Ae(s,["responseJsonSchema"],x),void 0!==Te(t,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==Te(t,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const y=Te(t,["safetySettings"]);if(void 0!==n&&null!=y){let e=y;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["category"]);if(null!=n&&Ae(t,["category"],n),void 0!==Te(e,["method"]))throw new Error("method parameter is not supported in Gemini API.");const s=Te(e,["threshold"]);return null!=s&&Ae(t,["threshold"],s),t}(e))),Ae(n,["safetySettings"],e)}const b=Te(t,["tools"]);if(void 0!==n&&null!=b){let e=Rs(b);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["functionDeclarations"],e)}if(void 0!==Te(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const s=Te(e,["googleSearchRetrieval"]);null!=s&&Ae(t,["googleSearchRetrieval"],s);const o=Te(e,["computerUse"]);null!=o&&Ae(t,["computerUse"],o);const i=Te(e,["fileSearch"]);null!=i&&Ae(t,["fileSearch"],i);const r=Te(e,["codeExecution"]);if(null!=r&&Ae(t,["codeExecution"],r),void 0!==Te(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=Te(e,["googleMaps"]);null!=a&&Ae(t,["googleMaps"],function(e){const t={};if(void 0!==Te(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=Te(e,["enableWidget"]);return null!=n&&Ae(t,["enableWidget"],n),t}(a));const l=Te(e,["googleSearch"]);null!=l&&Ae(t,["googleSearch"],function(e){const t={};if(void 0!==Te(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==Te(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=Te(e,["timeRangeFilter"]);return null!=n&&Ae(t,["timeRangeFilter"],n),t}(l));const c=Te(e,["urlContext"]);return null!=c&&Ae(t,["urlContext"],c),t}(js(e)))),Ae(n,["tools"],e)}const E=Te(t,["toolConfig"]);if(void 0!==n&&null!=E&&Ae(n,["toolConfig"],function(e){const t={},n=Te(e,["functionCallingConfig"]);null!=n&&Ae(t,["functionCallingConfig"],function(e){const t={},n=Te(e,["mode"]);null!=n&&Ae(t,["mode"],n);const s=Te(e,["allowedFunctionNames"]);if(null!=s&&Ae(t,["allowedFunctionNames"],s),void 0!==Te(e,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(n));const s=Te(e,["retrievalConfig"]);return null!=s&&Ae(t,["retrievalConfig"],s),t}(E)),void 0!==Te(t,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const _=Te(t,["cachedContent"]);void 0!==n&&null!=_&&Ae(n,["cachedContent"],Ps(e,_));const w=Te(t,["responseModalities"]);null!=w&&Ae(s,["responseModalities"],w);const N=Te(t,["mediaResolution"]);null!=N&&Ae(s,["mediaResolution"],N);const S=Te(t,["speechConfig"]);if(null!=S&&Ae(s,["speechConfig"],Cs(S)),void 0!==Te(t,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const I=Te(t,["thinkingConfig"]);null!=I&&Ae(s,["thinkingConfig"],I);const A=Te(t,["imageConfig"]);null!=A&&Ae(s,["imageConfig"],function(e){const t={},n=Te(e,["aspectRatio"]);null!=n&&Ae(t,["aspectRatio"],n);const s=Te(e,["imageSize"]);if(null!=s&&Ae(t,["imageSize"],s),void 0!==Te(e,["outputMimeType"]))throw new Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==Te(e,["outputCompressionQuality"]))throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(A));const T=Te(t,["enableEnhancedCivicAnswers"]);return null!=T&&Ae(s,["enableEnhancedCivicAnswers"],T),s}(e,r,Te(n,["request"],{}))),n}(e,t))),Ae(n,["requests","requests"],t)}return n}(e,Fs(e,o)));const i=Te(t,["config"]);return null!=i&&function(e,t){const n=Te(e,["displayName"]);if(void 0!==t&&null!=n&&Ae(t,["batch","displayName"],n),void 0!==Te(e,["dest"]))throw new Error("dest parameter is not supported in Gemini API.")}(i,n),n}function Ws(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["model"],ms(e,s));const o=Te(t,["src"]);null!=o&&Ae(n,["inputConfig"],function(e){const t={},n=Te(e,["format"]);null!=n&&Ae(t,["instancesFormat"],n);const s=Te(e,["gcsUri"]);null!=s&&Ae(t,["gcsSource","uris"],s);const o=Te(e,["bigqueryUri"]);if(null!=o&&Ae(t,["bigquerySource","inputUri"],o),void 0!==Te(e,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==Te(e,["inlinedRequests"]))throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}(Fs(e,o)));const i=Te(t,["config"]);return null!=i&&function(e,t){const n=Te(e,["displayName"]);void 0!==t&&null!=n&&Ae(t,["displayName"],n);const s=Te(e,["dest"]);void 0!==t&&null!=s&&Ae(t,["outputConfig"],function(e){const t={},n=Te(e,["format"]);null!=n&&Ae(t,["predictionsFormat"],n);const s=Te(e,["gcsUri"]);null!=s&&Ae(t,["gcsDestination","outputUriPrefix"],s);const o=Te(e,["bigqueryUri"]);if(null!=o&&Ae(t,["bigqueryDestination","outputUri"],o),void 0!==Te(e,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==Te(e,["inlinedResponses"]))throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==Te(e,["inlinedEmbedContentResponses"]))throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}(function(e){if("string"!=typeof e)return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}(s)))}(i,n),n}(qn=kn||(kn={})).PAGED_ITEM_BATCH_JOBS="batchJobs",qn.PAGED_ITEM_MODELS="models",qn.PAGED_ITEM_TUNING_JOBS="tuningJobs",qn.PAGED_ITEM_FILES="files",qn.PAGED_ITEM_CACHED_CONTENTS="cachedContents",qn.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",qn.PAGED_ITEM_DOCUMENTS="documents";class Ks{constructor(e,t,n,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,s)}init(e,t,n){var s,o;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=null==t?void 0:t.sdkHttpResponse,this.idxInternal=0;let i={config:{}};i=n&&0!==Object.keys(n).length?"object"==typeof n?Object.assign({},n):n:{config:{}},i.config&&(i.config.pageToken=t.nextPageToken),this.paramsInternal=i,this.pageInternalSize=null!==(o=null===(s=i.config)||void 0===s?void 0:s.pageSize)&&void 0!==o?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength){if(!this.hasNextPage())return{value:void 0,done:!0};await this.nextPage()}const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return void 0!==(null===(e=this.params.config)||void 0===e?void 0:e.pageToken)}}class Xs extends Se{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new Ks(kn.PAGED_ITEM_BATCH_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.create=async e=>(this.apiClient.isVertexAI()&&(e.config=this.formatDestination(e.src,e.config)),this.createInternal(e)),this.createEmbeddings=async e=>{if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(e)}}createInlinedGenerateContentRequest(e){const t=zs(this.apiClient,e),n=Ie("{model}:batchGenerateContent",t._url),s=t.batch.inputConfig.requests,o=s.requests,i=[];for(const r of o){const e=Object.assign({},r);if(e.systemInstruction){const t=e.systemInstruction;delete e.systemInstruction;const n=e.request;n.systemInstruction=t,e.request=n}i.push(e)}return s.requests=i,delete t.config,delete t._url,delete t._query,{path:n,body:t}}getGcsUri(e){return"string"==typeof e?e.startsWith("gs://")?e:void 0:!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0?e.gcsUri[0]:void 0}getBigqueryUri(e){return"string"==typeof e?e.startsWith("bq://")?e:void 0:Array.isArray(e)?void 0:e.bigqueryUri}formatDestination(e,t){const n=t?Object.assign({},t):{},s=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${s}`),void 0===n.dest){const t=this.getGcsUri(e),o=this.getBigqueryUri(e);if(t)t.endsWith(".jsonl")?n.dest=`${t.slice(0,-6)}/dest`:n.dest=`${t}_dest_${s}`;else{if(!o)throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.");n.dest=`${o}_dest_${s}`}}return n}async createInternal(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=Ws(this.apiClient,e);return r=Ie("batchPredictionJobs",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>$s(e))}{const t=zs(this.apiClient,e);return r=Ie("{model}:batchGenerateContent",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json()),i.then(e=>Js(e))}}async createEmbeddingsInternal(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["src"]);null!=o&&Ae(n,["batch","inputConfig"],function(e,t){const n={},s=Te(t,["fileName"]);null!=s&&Ae(n,["file_name"],s);const o=Te(t,["inlinedRequests"]);return null!=o&&Ae(n,["requests"],function(e,t){const n={},s=Te(t,["contents"]);if(null!=s){let t=Ss(e,s);Array.isArray(t)&&(t=t.map(e=>e)),Ae(n,["requests[]","request","content"],t)}const o=Te(t,["config"]);return null!=o&&(Ae(n,["_self"],function(e,t){const n=Te(e,["taskType"]);void 0!==t&&null!=n&&Ae(t,["requests[]","taskType"],n);const s=Te(e,["title"]);void 0!==t&&null!=s&&Ae(t,["requests[]","title"],s);const o=Te(e,["outputDimensionality"]);if(void 0!==t&&null!=o&&Ae(t,["requests[]","outputDimensionality"],o),void 0!==Te(e,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==Te(e,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.");return{}}(o,n)),function(e){for(const[t,n]of Object.entries({"requests[].*":"requests[].request.*"})){const s=t.split("."),o=n.split("."),i=new Set;let r=-1;for(let e=0;e<s.length;e++)if("*"===s[e]){r=e;break}if(-1!==r&&o.length>r)for(let e=r;e<o.length;e++){const t=o[e];"*"===t||t.endsWith("[]")||t.endsWith("[0]")||i.add(t)}Ce(e,s,o,0,i)}}(n)),n}(e,o)),n}(e,o));const i=Te(t,["config"]);return null!=i&&function(e,t){const n=Te(e,["displayName"]);void 0!==t&&null!=n&&Ae(t,["batch","displayName"],n)}(i,n),n}(this.apiClient,e);return o=Ie("{model}:asyncBatchEmbedContent",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>Js(e))}}async get(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=Te(t,["name"]);return null!=s&&Ae(n,["_url","name"],Hs(e,s)),n}(this.apiClient,e);return r=Ie("batchPredictionJobs/{name}",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>$s(e))}{const t=function(e,t){const n={},s=Te(t,["name"]);return null!=s&&Ae(n,["_url","name"],Hs(e,s)),n}(this.apiClient,e);return r=Ie("batches/{name}",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json()),i.then(e=>Js(e))}}async cancel(e){var t,n,s,o;let i="",r={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=Te(t,["name"]);return null!=s&&Ae(n,["_url","name"],Hs(e,s)),n}(this.apiClient,e);i=Ie("batchPredictionJobs/{name}:cancel",s._url),r=s._query,delete s._url,delete s._query,await this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}else{const t=function(e,t){const n={},s=Te(t,["name"]);return null!=s&&Ae(n,["_url","name"],Hs(e,s)),n}(this.apiClient,e);i=Ie("batches/{name}:cancel",t._url),r=t._query,delete t._url,delete t._query,await this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal})}}async listInternal(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e){const t={},n=Te(e,["config"]);return null!=n&&function(e,t){const n=Te(e,["pageSize"]);void 0!==t&&null!=n&&Ae(t,["_query","pageSize"],n);const s=Te(e,["pageToken"]);void 0!==t&&null!=s&&Ae(t,["_query","pageToken"],s);const o=Te(e,["filter"]);void 0!==t&&null!=o&&Ae(t,["_query","filter"],o)}(n,t),t}(e);return r=Ie("batchPredictionJobs",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["nextPageToken"]);null!=s&&Ae(t,["nextPageToken"],s);const o=Te(e,["batchPredictionJobs"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>$s(e))),Ae(t,["batchJobs"],e)}return t}(e),n=new cs;return Object.assign(n,t),n})}{const t=function(e){const t={},n=Te(e,["config"]);return null!=n&&function(e,t){const n=Te(e,["pageSize"]);void 0!==t&&null!=n&&Ae(t,["_query","pageSize"],n);const s=Te(e,["pageToken"]);if(void 0!==t&&null!=s&&Ae(t,["_query","pageToken"],s),void 0!==Te(e,["filter"]))throw new Error("filter parameter is not supported in Gemini API.")}(n,t),t}(e);return r=Ie("batches",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["nextPageToken"]);null!=s&&Ae(t,["nextPageToken"],s);const o=Te(e,["operations"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>Js(e))),Ae(t,["batchJobs"],e)}return t}(e),n=new cs;return Object.assign(n,t),n})}}async delete(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=Te(t,["name"]);return null!=s&&Ae(n,["_url","name"],Hs(e,s)),n}(this.apiClient,e);return r=Ie("batchPredictionJobs/{name}",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["name"]);null!=s&&Ae(t,["name"],s);const o=Te(e,["done"]);null!=o&&Ae(t,["done"],o);const i=Te(e,["error"]);return null!=i&&Ae(t,["error"],i),t}(e))}{const t=function(e,t){const n={},s=Te(t,["name"]);return null!=s&&Ae(n,["_url","name"],Hs(e,s)),n}(this.apiClient,e);return r=Ie("batches/{name}",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["name"]);null!=s&&Ae(t,["name"],s);const o=Te(e,["done"]);null!=o&&Ae(t,["done"],o);const i=Te(e,["error"]);return null!=i&&Ae(t,["error"],i),t}(e))}}}function Qs(e){const t={},n=Te(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["mediaResolution"]);null!=n&&Ae(t,["mediaResolution"],n);const s=Te(e,["codeExecutionResult"]);null!=s&&Ae(t,["codeExecutionResult"],s);const o=Te(e,["executableCode"]);null!=o&&Ae(t,["executableCode"],o);const i=Te(e,["fileData"]);null!=i&&Ae(t,["fileData"],function(e){const t={};if(void 0!==Te(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=Te(e,["fileUri"]);null!=n&&Ae(t,["fileUri"],n);const s=Te(e,["mimeType"]);return null!=s&&Ae(t,["mimeType"],s),t}(i));const r=Te(e,["functionCall"]);null!=r&&Ae(t,["functionCall"],function(e){const t={},n=Te(e,["id"]);null!=n&&Ae(t,["id"],n);const s=Te(e,["args"]);null!=s&&Ae(t,["args"],s);const o=Te(e,["name"]);if(null!=o&&Ae(t,["name"],o),void 0!==Te(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==Te(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(r));const a=Te(e,["functionResponse"]);null!=a&&Ae(t,["functionResponse"],a);const l=Te(e,["inlineData"]);null!=l&&Ae(t,["inlineData"],function(e){const t={},n=Te(e,["data"]);if(null!=n&&Ae(t,["data"],n),void 0!==Te(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const s=Te(e,["mimeType"]);return null!=s&&Ae(t,["mimeType"],s),t}(l));const c=Te(e,["text"]);null!=c&&Ae(t,["text"],c);const u=Te(e,["thought"]);null!=u&&Ae(t,["thought"],u);const d=Te(e,["thoughtSignature"]);null!=d&&Ae(t,["thoughtSignature"],d);const p=Te(e,["videoMetadata"]);return null!=p&&Ae(t,["videoMetadata"],p),t}(e))),Ae(t,["parts"],e)}const s=Te(e,["role"]);return null!=s&&Ae(t,["role"],s),t}class Zs extends Se{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new Ks(kn.PAGED_ITEM_CACHED_CONTENTS,e=>this.listInternal(e),await this.listInternal(e),e)}async create(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["model"],hs(e,s));const o=Te(t,["config"]);return null!=o&&function(e,t){const n=Te(e,["ttl"]);void 0!==t&&null!=n&&Ae(t,["ttl"],n);const s=Te(e,["expireTime"]);void 0!==t&&null!=s&&Ae(t,["expireTime"],s);const o=Te(e,["displayName"]);void 0!==t&&null!=o&&Ae(t,["displayName"],o);const i=Te(e,["contents"]);if(void 0!==t&&null!=i){let e=Is(i);Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["contents"],e)}const r=Te(e,["systemInstruction"]);void 0!==t&&null!=r&&Ae(t,["systemInstruction"],Ns(r));const a=Te(e,["tools"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==Te(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const n=Te(e,["description"]);null!=n&&Ae(t,["description"],n);const s=Te(e,["name"]);null!=s&&Ae(t,["name"],s);const o=Te(e,["parameters"]);null!=o&&Ae(t,["parameters"],o);const i=Te(e,["parametersJsonSchema"]);null!=i&&Ae(t,["parametersJsonSchema"],i);const r=Te(e,["response"]);null!=r&&Ae(t,["response"],r);const a=Te(e,["responseJsonSchema"]);return null!=a&&Ae(t,["responseJsonSchema"],a),t}(e))),Ae(t,["functionDeclarations"],e)}const s=Te(e,["retrieval"]);null!=s&&Ae(t,["retrieval"],s);const o=Te(e,["googleSearchRetrieval"]);null!=o&&Ae(t,["googleSearchRetrieval"],o);const i=Te(e,["computerUse"]);if(null!=i&&Ae(t,["computerUse"],i),void 0!==Te(e,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=Te(e,["codeExecution"]);null!=r&&Ae(t,["codeExecution"],r);const a=Te(e,["enterpriseWebSearch"]);null!=a&&Ae(t,["enterpriseWebSearch"],a);const l=Te(e,["googleMaps"]);null!=l&&Ae(t,["googleMaps"],l);const c=Te(e,["googleSearch"]);null!=c&&Ae(t,["googleSearch"],c);const u=Te(e,["urlContext"]);return null!=u&&Ae(t,["urlContext"],u),t}(e))),Ae(t,["tools"],e)}const l=Te(e,["toolConfig"]);void 0!==t&&null!=l&&Ae(t,["toolConfig"],l);const c=Te(e,["kmsKeyName"]);void 0!==t&&null!=c&&Ae(t,["encryption_spec","kmsKeyName"],c)}(o,n),n}(this.apiClient,e);return r=Ie("cachedContents",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>e)}{const t=function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["model"],hs(e,s));const o=Te(t,["config"]);return null!=o&&function(e,t){const n=Te(e,["ttl"]);void 0!==t&&null!=n&&Ae(t,["ttl"],n);const s=Te(e,["expireTime"]);void 0!==t&&null!=s&&Ae(t,["expireTime"],s);const o=Te(e,["displayName"]);void 0!==t&&null!=o&&Ae(t,["displayName"],o);const i=Te(e,["contents"]);if(void 0!==t&&null!=i){let e=Is(i);Array.isArray(e)&&(e=e.map(e=>Qs(e))),Ae(t,["contents"],e)}const r=Te(e,["systemInstruction"]);void 0!==t&&null!=r&&Ae(t,["systemInstruction"],Qs(Ns(r)));const a=Te(e,["tools"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["functionDeclarations"],e)}if(void 0!==Te(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const s=Te(e,["googleSearchRetrieval"]);null!=s&&Ae(t,["googleSearchRetrieval"],s);const o=Te(e,["computerUse"]);null!=o&&Ae(t,["computerUse"],o);const i=Te(e,["fileSearch"]);null!=i&&Ae(t,["fileSearch"],i);const r=Te(e,["codeExecution"]);if(null!=r&&Ae(t,["codeExecution"],r),void 0!==Te(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=Te(e,["googleMaps"]);null!=a&&Ae(t,["googleMaps"],function(e){const t={};if(void 0!==Te(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=Te(e,["enableWidget"]);return null!=n&&Ae(t,["enableWidget"],n),t}(a));const l=Te(e,["googleSearch"]);null!=l&&Ae(t,["googleSearch"],function(e){const t={};if(void 0!==Te(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==Te(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=Te(e,["timeRangeFilter"]);return null!=n&&Ae(t,["timeRangeFilter"],n),t}(l));const c=Te(e,["urlContext"]);return null!=c&&Ae(t,["urlContext"],c),t}(e))),Ae(t,["tools"],e)}const l=Te(e,["toolConfig"]);if(void 0!==t&&null!=l&&Ae(t,["toolConfig"],function(e){const t={},n=Te(e,["functionCallingConfig"]);null!=n&&Ae(t,["functionCallingConfig"],function(e){const t={},n=Te(e,["mode"]);null!=n&&Ae(t,["mode"],n);const s=Te(e,["allowedFunctionNames"]);if(null!=s&&Ae(t,["allowedFunctionNames"],s),void 0!==Te(e,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(n));const s=Te(e,["retrievalConfig"]);return null!=s&&Ae(t,["retrievalConfig"],s),t}(l)),void 0!==Te(e,["kmsKeyName"]))throw new Error("kmsKeyName parameter is not supported in Gemini API.")}(o,n),n}(this.apiClient,e);return r=Ie("cachedContents",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json()),i.then(e=>e)}}async get(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=Te(t,["name"]);return null!=s&&Ae(n,["_url","name"],Ps(e,s)),n}(this.apiClient,e);return r=Ie("{name}",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>e)}{const t=function(e,t){const n={},s=Te(t,["name"]);return null!=s&&Ae(n,["_url","name"],Ps(e,s)),n}(this.apiClient,e);return r=Ie("{name}",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json()),i.then(e=>e)}}async delete(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=Te(t,["name"]);return null!=s&&Ae(n,["_url","name"],Ps(e,s)),n}(this.apiClient,e);return r=Ie("{name}",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);return null!=n&&Ae(t,["sdkHttpResponse"],n),t}(e),n=new es;return Object.assign(n,t),n})}{const t=function(e,t){const n={},s=Te(t,["name"]);return null!=s&&Ae(n,["_url","name"],Ps(e,s)),n}(this.apiClient,e);return r=Ie("{name}",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);return null!=n&&Ae(t,["sdkHttpResponse"],n),t}(e),n=new es;return Object.assign(n,t),n})}}async update(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=Te(t,["name"]);null!=s&&Ae(n,["_url","name"],Ps(e,s));const o=Te(t,["config"]);return null!=o&&function(e,t){const n=Te(e,["ttl"]);void 0!==t&&null!=n&&Ae(t,["ttl"],n);const s=Te(e,["expireTime"]);void 0!==t&&null!=s&&Ae(t,["expireTime"],s)}(o,n),n}(this.apiClient,e);return r=Ie("{name}",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>e)}{const t=function(e,t){const n={},s=Te(t,["name"]);null!=s&&Ae(n,["_url","name"],Ps(e,s));const o=Te(t,["config"]);return null!=o&&function(e,t){const n=Te(e,["ttl"]);void 0!==t&&null!=n&&Ae(t,["ttl"],n);const s=Te(e,["expireTime"]);void 0!==t&&null!=s&&Ae(t,["expireTime"],s)}(o,n),n}(this.apiClient,e);return r=Ie("{name}",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json()),i.then(e=>e)}}async listInternal(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e){const t={},n=Te(e,["config"]);return null!=n&&function(e,t){const n=Te(e,["pageSize"]);void 0!==t&&null!=n&&Ae(t,["_query","pageSize"],n);const s=Te(e,["pageToken"]);void 0!==t&&null!=s&&Ae(t,["_query","pageToken"],s)}(n,t),t}(e);return r=Ie("cachedContents",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["nextPageToken"]);null!=s&&Ae(t,["nextPageToken"],s);const o=Te(e,["cachedContents"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["cachedContents"],e)}return t}(e),n=new ts;return Object.assign(n,t),n})}{const t=function(e){const t={},n=Te(e,["config"]);return null!=n&&function(e,t){const n=Te(e,["pageSize"]);void 0!==t&&null!=n&&Ae(t,["_query","pageSize"],n);const s=Te(e,["pageToken"]);void 0!==t&&null!=s&&Ae(t,["_query","pageToken"],s)}(n,t),t}(e);return r=Ie("cachedContents",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["nextPageToken"]);null!=s&&Ae(t,["nextPageToken"],s);const o=Te(e,["cachedContents"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["cachedContents"],e)}return t}(e),n=new ts;return Object.assign(n,t),n})}}}function eo(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(n[s[o]]=e[s[o]])}return n}function to(e){return this instanceof to?(this.v=e,this):new to(e)}function no(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,o=n.apply(e,t||[]),i=[];return s=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),r("next"),r("throw"),r("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),s[Symbol.asyncIterator]=function(){return this},s;function r(e,t){o[e]&&(s[e]=function(t){return new Promise(function(n,s){i.push([e,t,n,s])>1||a(e,t)})},t&&(s[e]=t(s[e])))}function a(e,t){try{(n=o[e](t)).value instanceof to?Promise.resolve(n.value.v).then(l,c):u(i[0][2],n)}catch(s){u(i[0][3],s)}var n}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function so(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],s=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(n){t[n]=e[n]&&function(t){return new Promise(function(s,o){!function(e,t,n,s){Promise.resolve(s).then(function(t){e({value:t,done:n})},t)}(s,o,(t=e[n](t)).done,t.value)})}}}function oo(e){var t;if(null==e.candidates||0===e.candidates.length)return!1;const n=null===(t=e.candidates[0])||void 0===t?void 0:t.content;return void 0!==n&&io(n)}function io(e){if(void 0===e.parts||0===e.parts.length)return!1;for(const t of e.parts)if(void 0===t||0===Object.keys(t).length)return!1;return!0}function ro(e){if(void 0===e||0===e.length)return[];const t=[],n=e.length;let s=0;for(;s<n;)if("user"===e[s].role)t.push(e[s]),s++;else{const o=[];let i=!0;for(;s<n&&"model"===e[s].role;)o.push(e[s]),i&&!io(e[s])&&(i=!1),s++;i?t.push(...o):t.pop()}return t}"function"==typeof SuppressedError&&SuppressedError;class ao{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new lo(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class lo{constructor(e,t,n,s={},o=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=s,this.history=o,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length)for(const t of e)if("user"!==t.role&&"model"!==t.role)throw new Error(`Role must be user or model, but got ${t.role}.`)}(o)}async sendMessage(e){var t;await this.sendPromise;const n=Ns(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});return this.sendPromise=(async()=>{var e,t,o;const i=await s,r=null===(t=null===(e=i.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content,a=i.automaticFunctionCallingHistory,l=this.getHistory(!0).length;let c=[];null!=a&&(c=null!==(o=a.slice(l))&&void 0!==o?o:[]);const u=r?[r]:[];this.recordHistory(n,u,c)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const n=Ns(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const o=await s;return this.processStreamResponse(o,n)}getHistory(e=!1){const t=e?ro(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return no(this,arguments,function*(){var n,s,o,i,r,a;const l=[];try{for(var c,u=!0,d=so(e);!(n=(c=yield to(d.next())).done);u=!0){i=c.value,u=!1;const e=i;if(oo(e)){const t=null===(a=null===(r=e.candidates)||void 0===r?void 0:r[0])||void 0===a?void 0:a.content;void 0!==t&&l.push(t)}yield yield to(e)}}catch(p){s={error:p}}finally{try{u||n||!(o=d.return)||(yield to(o.call(d)))}finally{if(s)throw s.error}}this.recordHistory(t,l)})}recordHistory(e,t,n){let s=[];t.length>0&&t.every(e=>void 0!==e.role)?s=t:s.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...ro(n)):this.history.push(e),this.history.push(...s)}}class co extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,co.prototype)}}class uo extends Se{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new Ks(kn.PAGED_ITEM_FILES,e=>this.listInternal(e),await this.listInternal(e),e)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(e=>e)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=Te(e,["config"]);return null!=n&&function(e,t){const n=Te(e,["pageSize"]);void 0!==t&&null!=n&&Ae(t,["_query","pageSize"],n);const s=Te(e,["pageToken"]);void 0!==t&&null!=s&&Ae(t,["_query","pageToken"],s)}(n,t),t}(e);return o=Ie("files",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["nextPageToken"]);null!=s&&Ae(t,["nextPageToken"],s);const o=Te(e,["files"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["files"],e)}return t}(e),n=new rs;return Object.assign(n,t),n})}}async createInternal(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=Te(e,["file"]);return null!=n&&Ae(t,["file"],n),t}(e);return o=Ie("upload/v1beta/files",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);return null!=n&&Ae(t,["sdkHttpResponse"],n),t}(e),n=new as;return Object.assign(n,t),n})}}async get(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=Te(e,["name"]);return null!=n&&Ae(t,["_url","file"],Us(n)),t}(e);return o=Ie("files/{file}",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>e)}}async delete(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=Te(e,["name"]);return null!=n&&Ae(t,["_url","file"],Us(n)),t}(e);return o=Ie("files/{file}",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);return null!=n&&Ae(t,["sdkHttpResponse"],n),t}(e),n=new ls;return Object.assign(n,t),n})}}}function po(e){const t={},n=Te(e,["data"]);if(null!=n&&Ae(t,["data"],n),void 0!==Te(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const s=Te(e,["mimeType"]);return null!=s&&Ae(t,["mimeType"],s),t}function mo(e,t){const n=Te(e,["generationConfig"]);void 0!==t&&null!=n&&Ae(t,["setup","generationConfig"],n);const s=Te(e,["responseModalities"]);void 0!==t&&null!=s&&Ae(t,["setup","generationConfig","responseModalities"],s);const o=Te(e,["temperature"]);void 0!==t&&null!=o&&Ae(t,["setup","generationConfig","temperature"],o);const i=Te(e,["topP"]);void 0!==t&&null!=i&&Ae(t,["setup","generationConfig","topP"],i);const r=Te(e,["topK"]);void 0!==t&&null!=r&&Ae(t,["setup","generationConfig","topK"],r);const a=Te(e,["maxOutputTokens"]);void 0!==t&&null!=a&&Ae(t,["setup","generationConfig","maxOutputTokens"],a);const l=Te(e,["mediaResolution"]);void 0!==t&&null!=l&&Ae(t,["setup","generationConfig","mediaResolution"],l);const c=Te(e,["seed"]);void 0!==t&&null!=c&&Ae(t,["setup","generationConfig","seed"],c);const u=Te(e,["speechConfig"]);void 0!==t&&null!=u&&Ae(t,["setup","generationConfig","speechConfig"],Os(u));const d=Te(e,["thinkingConfig"]);void 0!==t&&null!=d&&Ae(t,["setup","generationConfig","thinkingConfig"],d);const p=Te(e,["enableAffectiveDialog"]);void 0!==t&&null!=p&&Ae(t,["setup","generationConfig","enableAffectiveDialog"],p);const m=Te(e,["systemInstruction"]);void 0!==t&&null!=m&&Ae(t,["setup","systemInstruction"],function(e){const t={},n=Te(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["mediaResolution"]);null!=n&&Ae(t,["mediaResolution"],n);const s=Te(e,["codeExecutionResult"]);null!=s&&Ae(t,["codeExecutionResult"],s);const o=Te(e,["executableCode"]);null!=o&&Ae(t,["executableCode"],o);const i=Te(e,["fileData"]);null!=i&&Ae(t,["fileData"],function(e){const t={};if(void 0!==Te(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=Te(e,["fileUri"]);null!=n&&Ae(t,["fileUri"],n);const s=Te(e,["mimeType"]);return null!=s&&Ae(t,["mimeType"],s),t}(i));const r=Te(e,["functionCall"]);null!=r&&Ae(t,["functionCall"],function(e){const t={},n=Te(e,["id"]);null!=n&&Ae(t,["id"],n);const s=Te(e,["args"]);null!=s&&Ae(t,["args"],s);const o=Te(e,["name"]);if(null!=o&&Ae(t,["name"],o),void 0!==Te(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==Te(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(r));const a=Te(e,["functionResponse"]);null!=a&&Ae(t,["functionResponse"],a);const l=Te(e,["inlineData"]);null!=l&&Ae(t,["inlineData"],po(l));const c=Te(e,["text"]);null!=c&&Ae(t,["text"],c);const u=Te(e,["thought"]);null!=u&&Ae(t,["thought"],u);const d=Te(e,["thoughtSignature"]);null!=d&&Ae(t,["thoughtSignature"],d);const p=Te(e,["videoMetadata"]);return null!=p&&Ae(t,["videoMetadata"],p),t}(e))),Ae(t,["parts"],e)}const s=Te(e,["role"]);return null!=s&&Ae(t,["role"],s),t}(Ns(m)));const h=Te(e,["tools"]);if(void 0!==t&&null!=h){let e=Rs(h);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["functionDeclarations"],e)}if(void 0!==Te(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const s=Te(e,["googleSearchRetrieval"]);null!=s&&Ae(t,["googleSearchRetrieval"],s);const o=Te(e,["computerUse"]);null!=o&&Ae(t,["computerUse"],o);const i=Te(e,["fileSearch"]);null!=i&&Ae(t,["fileSearch"],i);const r=Te(e,["codeExecution"]);if(null!=r&&Ae(t,["codeExecution"],r),void 0!==Te(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=Te(e,["googleMaps"]);null!=a&&Ae(t,["googleMaps"],function(e){const t={};if(void 0!==Te(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=Te(e,["enableWidget"]);return null!=n&&Ae(t,["enableWidget"],n),t}(a));const l=Te(e,["googleSearch"]);null!=l&&Ae(t,["googleSearch"],function(e){const t={};if(void 0!==Te(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==Te(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=Te(e,["timeRangeFilter"]);return null!=n&&Ae(t,["timeRangeFilter"],n),t}(l));const c=Te(e,["urlContext"]);return null!=c&&Ae(t,["urlContext"],c),t}(js(e)))),Ae(t,["setup","tools"],e)}const f=Te(e,["sessionResumption"]);void 0!==t&&null!=f&&Ae(t,["setup","sessionResumption"],function(e){const t={},n=Te(e,["handle"]);if(null!=n&&Ae(t,["handle"],n),void 0!==Te(e,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return t}(f));const g=Te(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&Ae(t,["setup","inputAudioTranscription"],g);const v=Te(e,["outputAudioTranscription"]);void 0!==t&&null!=v&&Ae(t,["setup","outputAudioTranscription"],v);const x=Te(e,["realtimeInputConfig"]);void 0!==t&&null!=x&&Ae(t,["setup","realtimeInputConfig"],x);const y=Te(e,["contextWindowCompression"]);void 0!==t&&null!=y&&Ae(t,["setup","contextWindowCompression"],y);const b=Te(e,["proactivity"]);if(void 0!==t&&null!=b&&Ae(t,["setup","proactivity"],b),void 0!==Te(e,["explicitVadSignal"]))throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return{}}function ho(e){const t={},n=Te(e,["media"]);if(null!=n){let e=fs(n);Array.isArray(e)&&(e=e.map(e=>po(e))),Ae(t,["mediaChunks"],e)}const s=Te(e,["audio"]);null!=s&&Ae(t,["audio"],po(xs(s)));const o=Te(e,["audioStreamEnd"]);null!=o&&Ae(t,["audioStreamEnd"],o);const i=Te(e,["video"]);null!=i&&Ae(t,["video"],po(vs(i)));const r=Te(e,["text"]);null!=r&&Ae(t,["text"],r);const a=Te(e,["activityStart"]);null!=a&&Ae(t,["activityStart"],a);const l=Te(e,["activityEnd"]);return null!=l&&Ae(t,["activityEnd"],l),t}function fo(e){const t={},n=Te(e,["media"]);if(null!=n){let e=fs(n);Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["mediaChunks"],e)}const s=Te(e,["audio"]);null!=s&&Ae(t,["audio"],xs(s));const o=Te(e,["audioStreamEnd"]);null!=o&&Ae(t,["audioStreamEnd"],o);const i=Te(e,["video"]);null!=i&&Ae(t,["video"],vs(i));const r=Te(e,["text"]);null!=r&&Ae(t,["text"],r);const a=Te(e,["activityStart"]);null!=a&&Ae(t,["activityStart"],a);const l=Te(e,["activityEnd"]);return null!=l&&Ae(t,["activityEnd"],l),t}function go(e){const t={},n=Te(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["mediaResolution"]);null!=n&&Ae(t,["mediaResolution"],n);const s=Te(e,["codeExecutionResult"]);null!=s&&Ae(t,["codeExecutionResult"],s);const o=Te(e,["executableCode"]);null!=o&&Ae(t,["executableCode"],o);const i=Te(e,["fileData"]);null!=i&&Ae(t,["fileData"],function(e){const t={};if(void 0!==Te(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=Te(e,["fileUri"]);null!=n&&Ae(t,["fileUri"],n);const s=Te(e,["mimeType"]);return null!=s&&Ae(t,["mimeType"],s),t}(i));const r=Te(e,["functionCall"]);null!=r&&Ae(t,["functionCall"],function(e){const t={},n=Te(e,["id"]);null!=n&&Ae(t,["id"],n);const s=Te(e,["args"]);null!=s&&Ae(t,["args"],s);const o=Te(e,["name"]);if(null!=o&&Ae(t,["name"],o),void 0!==Te(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==Te(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(r));const a=Te(e,["functionResponse"]);null!=a&&Ae(t,["functionResponse"],a);const l=Te(e,["inlineData"]);null!=l&&Ae(t,["inlineData"],function(e){const t={},n=Te(e,["data"]);if(null!=n&&Ae(t,["data"],n),void 0!==Te(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const s=Te(e,["mimeType"]);return null!=s&&Ae(t,["mimeType"],s),t}(l));const c=Te(e,["text"]);null!=c&&Ae(t,["text"],c);const u=Te(e,["thought"]);null!=u&&Ae(t,["thought"],u);const d=Te(e,["thoughtSignature"]);null!=d&&Ae(t,["thoughtSignature"],d);const p=Te(e,["videoMetadata"]);return null!=p&&Ae(t,["videoMetadata"],p),t}(e))),Ae(t,["parts"],e)}const s=Te(e,["role"]);return null!=s&&Ae(t,["role"],s),t}function vo(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["contents"]);if(null!=o){let e=Is(o);Array.isArray(e)&&(e=e.map(e=>go(e))),Ae(n,["contents"],e)}const i=Te(t,["config"]);return null!=i&&Ae(n,["generationConfig"],function(e,t,n){const s={},o=Te(t,["systemInstruction"]);void 0!==n&&null!=o&&Ae(n,["systemInstruction"],go(Ns(o)));const i=Te(t,["temperature"]);null!=i&&Ae(s,["temperature"],i);const r=Te(t,["topP"]);null!=r&&Ae(s,["topP"],r);const a=Te(t,["topK"]);null!=a&&Ae(s,["topK"],a);const l=Te(t,["candidateCount"]);null!=l&&Ae(s,["candidateCount"],l);const c=Te(t,["maxOutputTokens"]);null!=c&&Ae(s,["maxOutputTokens"],c);const u=Te(t,["stopSequences"]);null!=u&&Ae(s,["stopSequences"],u);const d=Te(t,["responseLogprobs"]);null!=d&&Ae(s,["responseLogprobs"],d);const p=Te(t,["logprobs"]);null!=p&&Ae(s,["logprobs"],p);const m=Te(t,["presencePenalty"]);null!=m&&Ae(s,["presencePenalty"],m);const h=Te(t,["frequencyPenalty"]);null!=h&&Ae(s,["frequencyPenalty"],h);const f=Te(t,["seed"]);null!=f&&Ae(s,["seed"],f);const g=Te(t,["responseMimeType"]);null!=g&&Ae(s,["responseMimeType"],g);const v=Te(t,["responseSchema"]);null!=v&&Ae(s,["responseSchema"],Ts(v));const x=Te(t,["responseJsonSchema"]);if(null!=x&&Ae(s,["responseJsonSchema"],x),void 0!==Te(t,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==Te(t,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const y=Te(t,["safetySettings"]);if(void 0!==n&&null!=y){let e=y;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["category"]);if(null!=n&&Ae(t,["category"],n),void 0!==Te(e,["method"]))throw new Error("method parameter is not supported in Gemini API.");const s=Te(e,["threshold"]);return null!=s&&Ae(t,["threshold"],s),t}(e))),Ae(n,["safetySettings"],e)}const b=Te(t,["tools"]);if(void 0!==n&&null!=b){let e=Rs(b);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["functionDeclarations"],e)}if(void 0!==Te(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const s=Te(e,["googleSearchRetrieval"]);null!=s&&Ae(t,["googleSearchRetrieval"],s);const o=Te(e,["computerUse"]);null!=o&&Ae(t,["computerUse"],o);const i=Te(e,["fileSearch"]);null!=i&&Ae(t,["fileSearch"],i);const r=Te(e,["codeExecution"]);if(null!=r&&Ae(t,["codeExecution"],r),void 0!==Te(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=Te(e,["googleMaps"]);null!=a&&Ae(t,["googleMaps"],function(e){const t={};if(void 0!==Te(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=Te(e,["enableWidget"]);return null!=n&&Ae(t,["enableWidget"],n),t}(a));const l=Te(e,["googleSearch"]);null!=l&&Ae(t,["googleSearch"],function(e){const t={};if(void 0!==Te(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==Te(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=Te(e,["timeRangeFilter"]);return null!=n&&Ae(t,["timeRangeFilter"],n),t}(l));const c=Te(e,["urlContext"]);return null!=c&&Ae(t,["urlContext"],c),t}(js(e)))),Ae(n,["tools"],e)}const E=Te(t,["toolConfig"]);if(void 0!==n&&null!=E&&Ae(n,["toolConfig"],function(e){const t={},n=Te(e,["functionCallingConfig"]);null!=n&&Ae(t,["functionCallingConfig"],function(e){const t={},n=Te(e,["mode"]);null!=n&&Ae(t,["mode"],n);const s=Te(e,["allowedFunctionNames"]);if(null!=s&&Ae(t,["allowedFunctionNames"],s),void 0!==Te(e,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(n));const s=Te(e,["retrievalConfig"]);return null!=s&&Ae(t,["retrievalConfig"],s),t}(E)),void 0!==Te(t,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const _=Te(t,["cachedContent"]);void 0!==n&&null!=_&&Ae(n,["cachedContent"],Ps(e,_));const w=Te(t,["responseModalities"]);null!=w&&Ae(s,["responseModalities"],w);const N=Te(t,["mediaResolution"]);null!=N&&Ae(s,["mediaResolution"],N);const S=Te(t,["speechConfig"]);if(null!=S&&Ae(s,["speechConfig"],Cs(S)),void 0!==Te(t,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const I=Te(t,["thinkingConfig"]);null!=I&&Ae(s,["thinkingConfig"],I);const A=Te(t,["imageConfig"]);null!=A&&Ae(s,["imageConfig"],function(e){const t={},n=Te(e,["aspectRatio"]);null!=n&&Ae(t,["aspectRatio"],n);const s=Te(e,["imageSize"]);if(null!=s&&Ae(t,["imageSize"],s),void 0!==Te(e,["outputMimeType"]))throw new Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==Te(e,["outputCompressionQuality"]))throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(A));const T=Te(t,["enableEnhancedCivicAnswers"]);return null!=T&&Ae(s,["enableEnhancedCivicAnswers"],T),s}(e,i,n)),n}function xo(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["contents"]);if(null!=o){let e=Is(o);Array.isArray(e)&&(e=e.map(e=>e)),Ae(n,["contents"],e)}const i=Te(t,["config"]);return null!=i&&Ae(n,["generationConfig"],function(e,t,n){const s={},o=Te(t,["systemInstruction"]);void 0!==n&&null!=o&&Ae(n,["systemInstruction"],Ns(o));const i=Te(t,["temperature"]);null!=i&&Ae(s,["temperature"],i);const r=Te(t,["topP"]);null!=r&&Ae(s,["topP"],r);const a=Te(t,["topK"]);null!=a&&Ae(s,["topK"],a);const l=Te(t,["candidateCount"]);null!=l&&Ae(s,["candidateCount"],l);const c=Te(t,["maxOutputTokens"]);null!=c&&Ae(s,["maxOutputTokens"],c);const u=Te(t,["stopSequences"]);null!=u&&Ae(s,["stopSequences"],u);const d=Te(t,["responseLogprobs"]);null!=d&&Ae(s,["responseLogprobs"],d);const p=Te(t,["logprobs"]);null!=p&&Ae(s,["logprobs"],p);const m=Te(t,["presencePenalty"]);null!=m&&Ae(s,["presencePenalty"],m);const h=Te(t,["frequencyPenalty"]);null!=h&&Ae(s,["frequencyPenalty"],h);const f=Te(t,["seed"]);null!=f&&Ae(s,["seed"],f);const g=Te(t,["responseMimeType"]);null!=g&&Ae(s,["responseMimeType"],g);const v=Te(t,["responseSchema"]);null!=v&&Ae(s,["responseSchema"],Ts(v));const x=Te(t,["responseJsonSchema"]);null!=x&&Ae(s,["responseJsonSchema"],x);const y=Te(t,["routingConfig"]);null!=y&&Ae(s,["routingConfig"],y);const b=Te(t,["modelSelectionConfig"]);null!=b&&Ae(s,["modelConfig"],b);const E=Te(t,["safetySettings"]);if(void 0!==n&&null!=E){let e=E;Array.isArray(e)&&(e=e.map(e=>e)),Ae(n,["safetySettings"],e)}const _=Te(t,["tools"]);if(void 0!==n&&null!=_){let e=Rs(_);Array.isArray(e)&&(e=e.map(e=>jo(js(e)))),Ae(n,["tools"],e)}const w=Te(t,["toolConfig"]);void 0!==n&&null!=w&&Ae(n,["toolConfig"],w);const N=Te(t,["labels"]);void 0!==n&&null!=N&&Ae(n,["labels"],N);const S=Te(t,["cachedContent"]);void 0!==n&&null!=S&&Ae(n,["cachedContent"],Ps(e,S));const I=Te(t,["responseModalities"]);null!=I&&Ae(s,["responseModalities"],I);const A=Te(t,["mediaResolution"]);null!=A&&Ae(s,["mediaResolution"],A);const T=Te(t,["speechConfig"]);null!=T&&Ae(s,["speechConfig"],Cs(T));const C=Te(t,["audioTimestamp"]);null!=C&&Ae(s,["audioTimestamp"],C);const O=Te(t,["thinkingConfig"]);null!=O&&Ae(s,["thinkingConfig"],O);const j=Te(t,["imageConfig"]);if(null!=j&&Ae(s,["imageConfig"],function(e){const t={},n=Te(e,["aspectRatio"]);null!=n&&Ae(t,["aspectRatio"],n);const s=Te(e,["imageSize"]);null!=s&&Ae(t,["imageSize"],s);const o=Te(e,["outputMimeType"]);null!=o&&Ae(t,["imageOutputOptions","mimeType"],o);const i=Te(e,["outputCompressionQuality"]);return null!=i&&Ae(t,["imageOutputOptions","compressionQuality"],i),t}(j)),void 0!==Te(t,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return s}(e,i,n)),n}function yo(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["candidates"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["content"]);null!=n&&Ae(t,["content"],n);const s=Te(e,["citationMetadata"]);null!=s&&Ae(t,["citationMetadata"],function(e){const t={},n=Te(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["citations"],e)}return t}(s));const o=Te(e,["tokenCount"]);null!=o&&Ae(t,["tokenCount"],o);const i=Te(e,["finishReason"]);null!=i&&Ae(t,["finishReason"],i);const r=Te(e,["avgLogprobs"]);null!=r&&Ae(t,["avgLogprobs"],r);const a=Te(e,["groundingMetadata"]);null!=a&&Ae(t,["groundingMetadata"],a);const l=Te(e,["index"]);null!=l&&Ae(t,["index"],l);const c=Te(e,["logprobsResult"]);null!=c&&Ae(t,["logprobsResult"],c);const u=Te(e,["safetyRatings"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["safetyRatings"],e)}const d=Te(e,["urlContextMetadata"]);return null!=d&&Ae(t,["urlContextMetadata"],d),t}(e))),Ae(t,["candidates"],e)}const o=Te(e,["modelVersion"]);null!=o&&Ae(t,["modelVersion"],o);const i=Te(e,["promptFeedback"]);null!=i&&Ae(t,["promptFeedback"],i);const r=Te(e,["responseId"]);null!=r&&Ae(t,["responseId"],r);const a=Te(e,["usageMetadata"]);return null!=a&&Ae(t,["usageMetadata"],a),t}function bo(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["candidates"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["candidates"],e)}const o=Te(e,["createTime"]);null!=o&&Ae(t,["createTime"],o);const i=Te(e,["modelVersion"]);null!=i&&Ae(t,["modelVersion"],i);const r=Te(e,["promptFeedback"]);null!=r&&Ae(t,["promptFeedback"],r);const a=Te(e,["responseId"]);null!=a&&Ae(t,["responseId"],a);const l=Te(e,["usageMetadata"]);return null!=l&&Ae(t,["usageMetadata"],l),t}function Eo(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["prompt"]);null!=o&&Ae(n,["instances[0]","prompt"],o);const i=Te(t,["image"]);null!=i&&Ae(n,["instances[0]","image"],So(i));const r=Te(t,["video"]);null!=r&&Ae(n,["instances[0]","video"],Ro(r));const a=Te(t,["source"]);null!=a&&function(e,t){const n=Te(e,["prompt"]);void 0!==t&&null!=n&&Ae(t,["instances[0]","prompt"],n);const s=Te(e,["image"]);void 0!==t&&null!=s&&Ae(t,["instances[0]","image"],So(s));const o=Te(e,["video"]);void 0!==t&&null!=o&&Ae(t,["instances[0]","video"],Ro(o))}(a,n);const l=Te(t,["config"]);return null!=l&&function(e,t){const n=Te(e,["numberOfVideos"]);if(void 0!==t&&null!=n&&Ae(t,["parameters","sampleCount"],n),void 0!==Te(e,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==Te(e,["fps"]))throw new Error("fps parameter is not supported in Gemini API.");const s=Te(e,["durationSeconds"]);if(void 0!==t&&null!=s&&Ae(t,["parameters","durationSeconds"],s),void 0!==Te(e,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const o=Te(e,["aspectRatio"]);void 0!==t&&null!=o&&Ae(t,["parameters","aspectRatio"],o);const i=Te(e,["resolution"]);void 0!==t&&null!=i&&Ae(t,["parameters","resolution"],i);const r=Te(e,["personGeneration"]);if(void 0!==t&&null!=r&&Ae(t,["parameters","personGeneration"],r),void 0!==Te(e,["pubsubTopic"]))throw new Error("pubsubTopic parameter is not supported in Gemini API.");const a=Te(e,["negativePrompt"]);void 0!==t&&null!=a&&Ae(t,["parameters","negativePrompt"],a);const l=Te(e,["enhancePrompt"]);if(void 0!==t&&null!=l&&Ae(t,["parameters","enhancePrompt"],l),void 0!==Te(e,["generateAudio"]))throw new Error("generateAudio parameter is not supported in Gemini API.");const c=Te(e,["lastFrame"]);void 0!==t&&null!=c&&Ae(t,["instances[0]","lastFrame"],So(c));const u=Te(e,["referenceImages"]);if(void 0!==t&&null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["image"]);null!=n&&Ae(t,["image"],So(n));const s=Te(e,["referenceType"]);return null!=s&&Ae(t,["referenceType"],s),t}(e))),Ae(t,["instances[0]","referenceImages"],e)}if(void 0!==Te(e,["mask"]))throw new Error("mask parameter is not supported in Gemini API.");if(void 0!==Te(e,["compressionQuality"]))throw new Error("compressionQuality parameter is not supported in Gemini API.")}(l,n),n}function _o(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["prompt"]);null!=o&&Ae(n,["instances[0]","prompt"],o);const i=Te(t,["image"]);null!=i&&Ae(n,["instances[0]","image"],Io(i));const r=Te(t,["video"]);null!=r&&Ae(n,["instances[0]","video"],Po(r));const a=Te(t,["source"]);null!=a&&function(e,t){const n=Te(e,["prompt"]);void 0!==t&&null!=n&&Ae(t,["instances[0]","prompt"],n);const s=Te(e,["image"]);void 0!==t&&null!=s&&Ae(t,["instances[0]","image"],Io(s));const o=Te(e,["video"]);void 0!==t&&null!=o&&Ae(t,["instances[0]","video"],Po(o))}(a,n);const l=Te(t,["config"]);return null!=l&&function(e,t){const n=Te(e,["numberOfVideos"]);void 0!==t&&null!=n&&Ae(t,["parameters","sampleCount"],n);const s=Te(e,["outputGcsUri"]);void 0!==t&&null!=s&&Ae(t,["parameters","storageUri"],s);const o=Te(e,["fps"]);void 0!==t&&null!=o&&Ae(t,["parameters","fps"],o);const i=Te(e,["durationSeconds"]);void 0!==t&&null!=i&&Ae(t,["parameters","durationSeconds"],i);const r=Te(e,["seed"]);void 0!==t&&null!=r&&Ae(t,["parameters","seed"],r);const a=Te(e,["aspectRatio"]);void 0!==t&&null!=a&&Ae(t,["parameters","aspectRatio"],a);const l=Te(e,["resolution"]);void 0!==t&&null!=l&&Ae(t,["parameters","resolution"],l);const c=Te(e,["personGeneration"]);void 0!==t&&null!=c&&Ae(t,["parameters","personGeneration"],c);const u=Te(e,["pubsubTopic"]);void 0!==t&&null!=u&&Ae(t,["parameters","pubsubTopic"],u);const d=Te(e,["negativePrompt"]);void 0!==t&&null!=d&&Ae(t,["parameters","negativePrompt"],d);const p=Te(e,["enhancePrompt"]);void 0!==t&&null!=p&&Ae(t,["parameters","enhancePrompt"],p);const m=Te(e,["generateAudio"]);void 0!==t&&null!=m&&Ae(t,["parameters","generateAudio"],m);const h=Te(e,["lastFrame"]);void 0!==t&&null!=h&&Ae(t,["instances[0]","lastFrame"],Io(h));const f=Te(e,["referenceImages"]);if(void 0!==t&&null!=f){let e=f;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["image"]);null!=n&&Ae(t,["image"],Io(n));const s=Te(e,["referenceType"]);return null!=s&&Ae(t,["referenceType"],s),t}(e))),Ae(t,["instances[0]","referenceImages"],e)}const g=Te(e,["mask"]);void 0!==t&&null!=g&&Ae(t,["instances[0]","mask"],function(e){const t={},n=Te(e,["image"]);null!=n&&Ae(t,["_self"],Io(n));const s=Te(e,["maskMode"]);return null!=s&&Ae(t,["maskMode"],s),t}(g));const v=Te(e,["compressionQuality"]);void 0!==t&&null!=v&&Ae(t,["parameters","compressionQuality"],v)}(l,n),n}function wo(e){const t={},n=Te(e,["_self"]);null!=n&&Ae(t,["image"],No(n));const s=Te(e,["raiFilteredReason"]);null!=s&&Ae(t,["raiFilteredReason"],s);const o=Te(e,["_self"]);null!=o&&Ae(t,["safetyAttributes"],Oo(o));const i=Te(e,["prompt"]);return null!=i&&Ae(t,["enhancedPrompt"],i),t}function No(e){const t={},n=Te(e,["gcsUri"]);null!=n&&Ae(t,["gcsUri"],n);const s=Te(e,["bytesBase64Encoded"]);null!=s&&Ae(t,["imageBytes"],Ms(s));const o=Te(e,["mimeType"]);return null!=o&&Ae(t,["mimeType"],o),t}function So(e){const t={};if(void 0!==Te(e,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");const n=Te(e,["imageBytes"]);null!=n&&Ae(t,["bytesBase64Encoded"],Ms(n));const s=Te(e,["mimeType"]);return null!=s&&Ae(t,["mimeType"],s),t}function Io(e){const t={},n=Te(e,["gcsUri"]);null!=n&&Ae(t,["gcsUri"],n);const s=Te(e,["imageBytes"]);null!=s&&Ae(t,["bytesBase64Encoded"],Ms(s));const o=Te(e,["mimeType"]);return null!=o&&Ae(t,["mimeType"],o),t}function Ao(e){const t={},n=Te(e,["name"]);null!=n&&Ae(t,["name"],n);const s=Te(e,["displayName"]);null!=s&&Ae(t,["displayName"],s);const o=Te(e,["description"]);null!=o&&Ae(t,["description"],o);const i=Te(e,["version"]);null!=i&&Ae(t,["version"],i);const r=Te(e,["_self"]);null!=r&&Ae(t,["tunedModelInfo"],function(e){const t={},n=Te(e,["baseModel"]);null!=n&&Ae(t,["baseModel"],n);const s=Te(e,["createTime"]);null!=s&&Ae(t,["createTime"],s);const o=Te(e,["updateTime"]);return null!=o&&Ae(t,["updateTime"],o),t}(r));const a=Te(e,["inputTokenLimit"]);null!=a&&Ae(t,["inputTokenLimit"],a);const l=Te(e,["outputTokenLimit"]);null!=l&&Ae(t,["outputTokenLimit"],l);const c=Te(e,["supportedGenerationMethods"]);null!=c&&Ae(t,["supportedActions"],c);const u=Te(e,["temperature"]);null!=u&&Ae(t,["temperature"],u);const d=Te(e,["maxTemperature"]);null!=d&&Ae(t,["maxTemperature"],d);const p=Te(e,["topP"]);null!=p&&Ae(t,["topP"],p);const m=Te(e,["topK"]);null!=m&&Ae(t,["topK"],m);const h=Te(e,["thinking"]);return null!=h&&Ae(t,["thinking"],h),t}function To(e){const t={},n=Te(e,["name"]);null!=n&&Ae(t,["name"],n);const s=Te(e,["displayName"]);null!=s&&Ae(t,["displayName"],s);const o=Te(e,["description"]);null!=o&&Ae(t,["description"],o);const i=Te(e,["versionId"]);null!=i&&Ae(t,["version"],i);const r=Te(e,["deployedModels"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["endpoint"]);null!=n&&Ae(t,["name"],n);const s=Te(e,["deployedModelId"]);return null!=s&&Ae(t,["deployedModelId"],s),t}(e))),Ae(t,["endpoints"],e)}const a=Te(e,["labels"]);null!=a&&Ae(t,["labels"],a);const l=Te(e,["_self"]);null!=l&&Ae(t,["tunedModelInfo"],function(e){const t={},n=Te(e,["labels","google-vertex-llm-tuning-base-model-id"]);null!=n&&Ae(t,["baseModel"],n);const s=Te(e,["createTime"]);null!=s&&Ae(t,["createTime"],s);const o=Te(e,["updateTime"]);return null!=o&&Ae(t,["updateTime"],o),t}(l));const c=Te(e,["defaultCheckpointId"]);null!=c&&Ae(t,["defaultCheckpointId"],c);const u=Te(e,["checkpoints"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["checkpoints"],e)}return t}function Co(e){const t={},n=Te(e,["safetyAttributes","categories"]);null!=n&&Ae(t,["categories"],n);const s=Te(e,["safetyAttributes","scores"]);null!=s&&Ae(t,["scores"],s);const o=Te(e,["contentType"]);return null!=o&&Ae(t,["contentType"],o),t}function Oo(e){const t={},n=Te(e,["safetyAttributes","categories"]);null!=n&&Ae(t,["categories"],n);const s=Te(e,["safetyAttributes","scores"]);null!=s&&Ae(t,["scores"],s);const o=Te(e,["contentType"]);return null!=o&&Ae(t,["contentType"],o),t}function jo(e){const t={},n=Te(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==Te(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const n=Te(e,["description"]);null!=n&&Ae(t,["description"],n);const s=Te(e,["name"]);null!=s&&Ae(t,["name"],s);const o=Te(e,["parameters"]);null!=o&&Ae(t,["parameters"],o);const i=Te(e,["parametersJsonSchema"]);null!=i&&Ae(t,["parametersJsonSchema"],i);const r=Te(e,["response"]);null!=r&&Ae(t,["response"],r);const a=Te(e,["responseJsonSchema"]);return null!=a&&Ae(t,["responseJsonSchema"],a),t}(e))),Ae(t,["functionDeclarations"],e)}const s=Te(e,["retrieval"]);null!=s&&Ae(t,["retrieval"],s);const o=Te(e,["googleSearchRetrieval"]);null!=o&&Ae(t,["googleSearchRetrieval"],o);const i=Te(e,["computerUse"]);if(null!=i&&Ae(t,["computerUse"],i),void 0!==Te(e,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=Te(e,["codeExecution"]);null!=r&&Ae(t,["codeExecution"],r);const a=Te(e,["enterpriseWebSearch"]);null!=a&&Ae(t,["enterpriseWebSearch"],a);const l=Te(e,["googleMaps"]);null!=l&&Ae(t,["googleMaps"],l);const c=Te(e,["googleSearch"]);null!=c&&Ae(t,["googleSearch"],c);const u=Te(e,["urlContext"]);return null!=u&&Ae(t,["urlContext"],u),t}function Ro(e){const t={},n=Te(e,["uri"]);null!=n&&Ae(t,["uri"],n);const s=Te(e,["videoBytes"]);null!=s&&Ae(t,["encodedVideo"],Ms(s));const o=Te(e,["mimeType"]);return null!=o&&Ae(t,["encoding"],o),t}function Po(e){const t={},n=Te(e,["uri"]);null!=n&&Ae(t,["gcsUri"],n);const s=Te(e,["videoBytes"]);null!=s&&Ae(t,["bytesBase64Encoded"],Ms(s));const o=Te(e,["mimeType"]);return null!=o&&Ae(t,["mimeType"],o),t}function Do(e,t){const n=Te(e,["mimeType"]);void 0!==t&&null!=n&&Ae(t,["mimeType"],n);const s=Te(e,["displayName"]);void 0!==t&&null!=s&&Ae(t,["displayName"],s);const o=Te(e,["customMetadata"]);if(void 0!==t&&null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["customMetadata"],e)}const i=Te(e,["chunkingConfig"]);return void 0!==t&&null!=i&&Ae(t,["chunkingConfig"],i),{}}const Mo="x-goog-api-client";class Uo{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=null!==(t=this.clientOptions.apiVersion)&&void 0!==t?t:"v1beta1",s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=null!==(n=this.clientOptions.apiVersion)&&void 0!==n?n:"v1beta",s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:(this.clientOptions.project=void 0,this.clientOptions.location=void 0)}isVertexAI(){var e;return null!==(e=this.clientOptions.vertexai)&&void 0!==e&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw new Error("HTTP options are not correctly set.");const t=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&t.push(e.apiVersion),t.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol="http:"==t.protocol?"ws":"wss",t.toString()}setBaseUrl(e){if(!this.clientOptions.httpOptions)throw new Error("HTTP options are not correctly set.");this.clientOptions.httpOptions.baseUrl=e}constructUrl(e,t,n){const s=[this.getRequestUrlInternal(t)];return n&&s.push(this.getBaseResourcePath()),""!==e&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||"GET"===e.httpMethod&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[i,r]of Object.entries(e.queryParams))s.searchParams.append(i,String(r));let o={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,s.toString(),e.abortSignal),this.unaryApiCall(s,o,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[s,o]of Object.entries(t))"object"==typeof o?n[s]=Object.assign(Object.assign({},n[s]),o):void 0!==o&&(n[s]=o);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,n);s.searchParams.has("alt")&&"sse"===s.searchParams.get("alt")||s.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,s.toString(),e.abortSignal),this.streamApiCall(s,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,s){if(t&&t.timeout||s){const n=new AbortController,o=n.signal;if(t.timeout&&(null==t?void 0:t.timeout)>0){const e=setTimeout(()=>n.abort(),t.timeout);e&&"function"==typeof e.unref&&e.unref()}s&&s.addEventListener("abort",()=>{n.abort()}),e.signal=o}return t&&null!==t.extraBody&&function(e,t){if(!t||0===Object.keys(t).length)return;if(e.body instanceof Blob)return;let n={};if("string"==typeof e.body&&e.body.length>0)try{const t=JSON.parse(e.body);if("object"!=typeof t||null===t||Array.isArray(t))return;n=t}catch(o){return}const s=function e(t,n){const s=Object.assign({},t);for(const o in n)if(Object.prototype.hasOwnProperty.call(n,o)){const t=n[o],i=s[o];t&&"object"==typeof t&&!Array.isArray(t)&&i&&"object"==typeof i&&!Array.isArray(i)?s[o]=e(i,t):s[o]=t}return s}(n,t);e.body=JSON.stringify(s)}(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await ko(e),new Ln(e))).catch(e=>{throw e instanceof Error?e:new Error(JSON.stringify(e))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await ko(e),this.processStreamResponse(e))).catch(e=>{throw e instanceof Error?e:new Error(JSON.stringify(e))})}processStreamResponse(e){return no(this,arguments,function*(){var t;const n=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.getReader(),s=new TextDecoder("utf-8");if(!n)throw new Error("Response body is empty");try{let t="";const i="data:",r=["\n\n","\r\r","\r\n\r\n"];for(;;){const{done:a,value:l}=yield to(n.read());if(a){if(t.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const c=s.decode(l,{stream:!0});try{const e=JSON.parse(c);if("error"in e){const t=JSON.parse(JSON.stringify(e.error)),n=t.status,s=t.code,o=`got status: ${n}. ${JSON.stringify(e)}`;if(s>=400&&s<600)throw new co({message:o,status:s})}}catch(o){if("ApiError"===o.name)throw o}t+=c;let u=-1,d=0;for(;;){u=-1,d=0;for(const e of r){const n=t.indexOf(e);-1!==n&&(-1===u||n<u)&&(u=n,d=e.length)}if(-1===u)break;const n=t.substring(0,u);t=t.substring(u+d);const s=n.trim();if(s.startsWith(i)){const t=s.substring(i.length).trim();try{const n=new Response(t,{headers:null==e?void 0:e.headers,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText});yield yield to(new Ln(n))}catch(o){throw new Error(`exception parsing stream chunk ${t}. ${o}`)}}}}}finally{n.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(e=>{throw new Error(`exception ${e} sending request`)})}getDefaultHeaders(){const e={},t="google-genai-sdk/1.34.0 "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[Mo]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e,t){const n=new Headers;if(e&&e.headers){for(const[t,s]of Object.entries(e.headers))n.append(t,s);e.timeout&&e.timeout>0&&n.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}getFileName(e){var t;let n="";return"string"==typeof e&&(n=e.replace(/[/\\]+$/,""),n=null!==(t=n.split(/[/\\]/).pop())&&void 0!==t?t:""),n}async uploadFile(e,t){var n;const s={};null!=t&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const o=this.clientOptions.uploader,i=await o.stat(e);s.sizeBytes=String(i.size);const r=null!==(n=null==t?void 0:t.mimeType)&&void 0!==n?n:i.type;if(void 0===r||""===r)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=r;const a={file:s},l=this.getFileName(e),c=Ie("upload/v1beta/files",a._url),u=await this.fetchUploadUrl(c,s.sizeBytes,s.mimeType,l,a,null==t?void 0:t.httpOptions);return o.upload(e,u,this)}async uploadFileToFileSearchStore(e,t,n){var s;const o=this.clientOptions.uploader,i=await o.stat(t),r=String(i.size),a=null!==(s=null==n?void 0:n.mimeType)&&void 0!==s?s:i.type;if(void 0===a||""===a)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const l=`upload/v1beta/${e}:uploadToFileSearchStore`,c=this.getFileName(t),u={};null!=n&&Do(n,u);const d=await this.fetchUploadUrl(l,r,a,c,u,null==n?void 0:n.httpOptions);return o.uploadToFileSearchStore(t,d,this)}async downloadFile(e){const t=this.clientOptions.downloader;await t.download(e,this)}async fetchUploadUrl(e,t,n,s,o,i){var r;let a={};a=i||{apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${n}`},s?{"X-Goog-Upload-File-Name":s}:{})};const l=await this.request({path:e,body:JSON.stringify(o),httpMethod:"POST",httpOptions:a});if(!l||!(null==l?void 0:l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=null===(r=null==l?void 0:l.headers)||void 0===r?void 0:r["x-goog-upload-url"];if(void 0===c)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function ko(e){var t;if(void 0===e)throw new Error("response is undefined");if(!e.ok){const n=e.status;let s;s=(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}};const o=JSON.stringify(s);if(n>=400&&n<600)throw new co({message:o,status:n});throw new Error(o)}}function qo(e){for(const t of e){if(Go(t))return!0;if("object"==typeof t&&"inputSchema"in t)return!0}return!1}function Lo(e){var t;const n=null!==(t=e[Mo])&&void 0!==t?t:"";e[Mo]=(n+" mcp_used/unknown").trimStart()}function Go(e){return null!==e&&"object"==typeof e&&e instanceof Vo}function Fo(e){return no(this,arguments,function*(e,t=100){let n,s=0;for(;s<t;){const t=yield to(e.listTools({cursor:n}));for(const e of t.tools)yield yield to(e),s++;if(!t.nextCursor)break;n=t.nextCursor}})}class Vo{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Vo(e,t)}async initialize(){var e,t,n,s;if(this.mcpTools.length>0)return;const o={},i=[];for(const u of this.mcpClients)try{for(var r,a=!0,l=(t=void 0,so(Fo(u)));!(e=(r=await l.next()).done);a=!0){s=r.value,a=!1;const e=s;i.push(e);const t=e.name;if(o[t])throw new Error(`Duplicate function name ${t} found in MCP tools. Please ensure function names are unique.`);o[t]=u}}catch(c){t={error:c}}finally{try{a||e||!(n=l.return)||await n.call(l)}finally{if(t)throw t.error}}this.mcpTools=i,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),function(e,t={}){const n=[],s=new Set;for(const o of e){const e=o.name;if(s.has(e))throw new Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);s.add(e);const i=Gs(o,t);i.functionDeclarations&&n.push(...i.functionDeclarations)}return{functionDeclarations:n}}(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const e=this.functionNameToMcpClient[n.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await e.callTool({name:n.name,arguments:n.args},void 0,s);t.push({functionResponse:{name:n.name,response:o.isError?{error:o}:o}})}return t}}class Ho{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");const s=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),i=function(e){const t=new Headers;for(const[n,s]of Object.entries(e))t.append(n,s);return t}(this.apiClient.getDefaultHeaders()),r=`${s}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${this.apiClient.getApiKey()}`;let a=()=>{};const l=new Promise(e=>{a=e}),c=e.callbacks,u=(this.apiClient,{onopen:function(){a({})},onmessage:e=>{!async function(e,t,n){const s=new ds;let o;o=n.data instanceof Blob?JSON.parse(await n.data.text()):JSON.parse(n.data),Object.assign(s,o),t(s)}(0,c.onmessage,e)},onerror:null!==(t=null==c?void 0:c.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null==c?void 0:c.onclose)&&void 0!==n?n:function(e){}}),d=this.webSocketFactory.create(r,function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(i),u);d.connect(),await l;const p={setup:{model:ms(this.apiClient,e.model)}};return d.send(JSON.stringify(p)),new Bo(d,this.apiClient)}}class Bo{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=function(e){const t={},n=Te(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["weightedPrompts"],e)}return t}(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=function(e){const t={},n=Te(e,["musicGenerationConfig"]);return null!=n&&Ae(t,["musicGenerationConfig"],n),t}(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Mn.PLAY)}pause(){this.sendPlaybackControl(Mn.PAUSE)}stop(){this.sendPlaybackControl(Mn.STOP)}resetContext(){this.sendPlaybackControl(Mn.RESET_CONTEXT)}close(){this.conn.close()}}class Jo{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new Ho(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,s,o,i,r;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const a=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion();let c;const u=this.apiClient.getHeaders();e.config&&e.config.tools&&qo(e.config.tools)&&Lo(u);const d=function(e){const t=new Headers;for(const[n,s]of Object.entries(e))t.append(n,s);return t}(u);if(this.apiClient.isVertexAI())c=`${a}/ws/google.cloud.aiplatform.${l}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(d,c);else{const e=this.apiClient.getApiKey();let t="BidiGenerateContent",n="key";(null==e?void 0:e.startsWith("auth_tokens/"))&&(t="BidiGenerateContentConstrained",n="access_token"),c=`${a}/ws/google.ai.generativelanguage.${l}.GenerativeService.${t}?${n}=${e}`}let p=()=>{};const m=new Promise(e=>{p=e}),h=e.callbacks,f=this.apiClient,g={onopen:function(){var e;null===(e=null==h?void 0:h.onopen)||void 0===e||e.call(h),p({})},onmessage:e=>{!async function(e,t,n){const s=new us;let o;o=n.data instanceof Blob?await n.data.text():n.data instanceof ArrayBuffer?(new TextDecoder).decode(n.data):n.data;const i=JSON.parse(o);if(e.isVertexAI()){const e=function(e){const t={},n=Te(e,["setupComplete"]);null!=n&&Ae(t,["setupComplete"],n);const s=Te(e,["serverContent"]);null!=s&&Ae(t,["serverContent"],s);const o=Te(e,["toolCall"]);null!=o&&Ae(t,["toolCall"],o);const i=Te(e,["toolCallCancellation"]);null!=i&&Ae(t,["toolCallCancellation"],i);const r=Te(e,["usageMetadata"]);null!=r&&Ae(t,["usageMetadata"],function(e){const t={},n=Te(e,["promptTokenCount"]);null!=n&&Ae(t,["promptTokenCount"],n);const s=Te(e,["cachedContentTokenCount"]);null!=s&&Ae(t,["cachedContentTokenCount"],s);const o=Te(e,["candidatesTokenCount"]);null!=o&&Ae(t,["responseTokenCount"],o);const i=Te(e,["toolUsePromptTokenCount"]);null!=i&&Ae(t,["toolUsePromptTokenCount"],i);const r=Te(e,["thoughtsTokenCount"]);null!=r&&Ae(t,["thoughtsTokenCount"],r);const a=Te(e,["totalTokenCount"]);null!=a&&Ae(t,["totalTokenCount"],a);const l=Te(e,["promptTokensDetails"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["promptTokensDetails"],e)}const c=Te(e,["cacheTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["cacheTokensDetails"],e)}const u=Te(e,["candidatesTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["responseTokensDetails"],e)}const d=Te(e,["toolUsePromptTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["toolUsePromptTokensDetails"],e)}const p=Te(e,["trafficType"]);return null!=p&&Ae(t,["trafficType"],p),t}(r));const a=Te(e,["goAway"]);null!=a&&Ae(t,["goAway"],a);const l=Te(e,["sessionResumptionUpdate"]);null!=l&&Ae(t,["sessionResumptionUpdate"],l);const c=Te(e,["voiceActivityDetectionSignal"]);return null!=c&&Ae(t,["voiceActivityDetectionSignal"],c),t}(i);Object.assign(s,e)}else{const e=i;Object.assign(s,e)}t(s)}(f,h.onmessage,e)},onerror:null!==(t=null==h?void 0:h.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null==h?void 0:h.onclose)&&void 0!==n?n:function(e){}},v=this.webSocketFactory.create(c,function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(d),g);v.connect(),await m;let x=ms(this.apiClient,e.model);this.apiClient.isVertexAI()&&x.startsWith("publishers/")&&(x=`projects/${this.apiClient.getProject()}/locations/${this.apiClient.getLocation()}/`+x);let y={};this.apiClient.isVertexAI()&&void 0===(null===(s=e.config)||void 0===s?void 0:s.responseModalities)&&(void 0===e.config?e.config={responseModalities:[gt.AUDIO]}:e.config.responseModalities=[gt.AUDIO]),null===(o=e.config)||void 0===o||o.generationConfig;const b=null!==(r=null===(i=e.config)||void 0===i?void 0:i.tools)&&void 0!==r?r:[],E=[];for(const w of b)if(this.isCallableTool(w)){const e=w;E.push(await e.tool())}else E.push(w);E.length>0&&(e.config.tools=E);const _={model:x,config:e.config,callbacks:e.callbacks};return y=this.apiClient.isVertexAI()?function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["setup","model"],ms(e,s));const o=Te(t,["config"]);return null!=o&&Ae(n,["config"],function(e,t){const n=Te(e,["generationConfig"]);void 0!==t&&null!=n&&Ae(t,["setup","generationConfig"],function(e){const t={},n=Te(e,["modelSelectionConfig"]);null!=n&&Ae(t,["modelConfig"],n);const s=Te(e,["responseJsonSchema"]);null!=s&&Ae(t,["responseJsonSchema"],s);const o=Te(e,["audioTimestamp"]);null!=o&&Ae(t,["audioTimestamp"],o);const i=Te(e,["candidateCount"]);null!=i&&Ae(t,["candidateCount"],i);const r=Te(e,["enableAffectiveDialog"]);null!=r&&Ae(t,["enableAffectiveDialog"],r);const a=Te(e,["frequencyPenalty"]);null!=a&&Ae(t,["frequencyPenalty"],a);const l=Te(e,["logprobs"]);null!=l&&Ae(t,["logprobs"],l);const c=Te(e,["maxOutputTokens"]);null!=c&&Ae(t,["maxOutputTokens"],c);const u=Te(e,["mediaResolution"]);null!=u&&Ae(t,["mediaResolution"],u);const d=Te(e,["presencePenalty"]);null!=d&&Ae(t,["presencePenalty"],d);const p=Te(e,["responseLogprobs"]);null!=p&&Ae(t,["responseLogprobs"],p);const m=Te(e,["responseMimeType"]);null!=m&&Ae(t,["responseMimeType"],m);const h=Te(e,["responseModalities"]);null!=h&&Ae(t,["responseModalities"],h);const f=Te(e,["responseSchema"]);null!=f&&Ae(t,["responseSchema"],f);const g=Te(e,["routingConfig"]);null!=g&&Ae(t,["routingConfig"],g);const v=Te(e,["seed"]);null!=v&&Ae(t,["seed"],v);const x=Te(e,["speechConfig"]);null!=x&&Ae(t,["speechConfig"],x);const y=Te(e,["stopSequences"]);null!=y&&Ae(t,["stopSequences"],y);const b=Te(e,["temperature"]);null!=b&&Ae(t,["temperature"],b);const E=Te(e,["thinkingConfig"]);null!=E&&Ae(t,["thinkingConfig"],E);const _=Te(e,["topK"]);null!=_&&Ae(t,["topK"],_);const w=Te(e,["topP"]);if(null!=w&&Ae(t,["topP"],w),void 0!==Te(e,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(n));const s=Te(e,["responseModalities"]);void 0!==t&&null!=s&&Ae(t,["setup","generationConfig","responseModalities"],s);const o=Te(e,["temperature"]);void 0!==t&&null!=o&&Ae(t,["setup","generationConfig","temperature"],o);const i=Te(e,["topP"]);void 0!==t&&null!=i&&Ae(t,["setup","generationConfig","topP"],i);const r=Te(e,["topK"]);void 0!==t&&null!=r&&Ae(t,["setup","generationConfig","topK"],r);const a=Te(e,["maxOutputTokens"]);void 0!==t&&null!=a&&Ae(t,["setup","generationConfig","maxOutputTokens"],a);const l=Te(e,["mediaResolution"]);void 0!==t&&null!=l&&Ae(t,["setup","generationConfig","mediaResolution"],l);const c=Te(e,["seed"]);void 0!==t&&null!=c&&Ae(t,["setup","generationConfig","seed"],c);const u=Te(e,["speechConfig"]);void 0!==t&&null!=u&&Ae(t,["setup","generationConfig","speechConfig"],Os(u));const d=Te(e,["thinkingConfig"]);void 0!==t&&null!=d&&Ae(t,["setup","generationConfig","thinkingConfig"],d);const p=Te(e,["enableAffectiveDialog"]);void 0!==t&&null!=p&&Ae(t,["setup","generationConfig","enableAffectiveDialog"],p);const m=Te(e,["systemInstruction"]);void 0!==t&&null!=m&&Ae(t,["setup","systemInstruction"],Ns(m));const h=Te(e,["tools"]);if(void 0!==t&&null!=h){let e=Rs(h);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==Te(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const n=Te(e,["description"]);null!=n&&Ae(t,["description"],n);const s=Te(e,["name"]);null!=s&&Ae(t,["name"],s);const o=Te(e,["parameters"]);null!=o&&Ae(t,["parameters"],o);const i=Te(e,["parametersJsonSchema"]);null!=i&&Ae(t,["parametersJsonSchema"],i);const r=Te(e,["response"]);null!=r&&Ae(t,["response"],r);const a=Te(e,["responseJsonSchema"]);return null!=a&&Ae(t,["responseJsonSchema"],a),t}(e))),Ae(t,["functionDeclarations"],e)}const s=Te(e,["retrieval"]);null!=s&&Ae(t,["retrieval"],s);const o=Te(e,["googleSearchRetrieval"]);null!=o&&Ae(t,["googleSearchRetrieval"],o);const i=Te(e,["computerUse"]);if(null!=i&&Ae(t,["computerUse"],i),void 0!==Te(e,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=Te(e,["codeExecution"]);null!=r&&Ae(t,["codeExecution"],r);const a=Te(e,["enterpriseWebSearch"]);null!=a&&Ae(t,["enterpriseWebSearch"],a);const l=Te(e,["googleMaps"]);null!=l&&Ae(t,["googleMaps"],l);const c=Te(e,["googleSearch"]);null!=c&&Ae(t,["googleSearch"],c);const u=Te(e,["urlContext"]);return null!=u&&Ae(t,["urlContext"],u),t}(js(e)))),Ae(t,["setup","tools"],e)}const f=Te(e,["sessionResumption"]);void 0!==t&&null!=f&&Ae(t,["setup","sessionResumption"],f);const g=Te(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&Ae(t,["setup","inputAudioTranscription"],g);const v=Te(e,["outputAudioTranscription"]);void 0!==t&&null!=v&&Ae(t,["setup","outputAudioTranscription"],v);const x=Te(e,["realtimeInputConfig"]);void 0!==t&&null!=x&&Ae(t,["setup","realtimeInputConfig"],x);const y=Te(e,["contextWindowCompression"]);void 0!==t&&null!=y&&Ae(t,["setup","contextWindowCompression"],y);const b=Te(e,["proactivity"]);void 0!==t&&null!=b&&Ae(t,["setup","proactivity"],b);const E=Te(e,["explicitVadSignal"]);return void 0!==t&&null!=E&&Ae(t,["setup","explicitVadSignal"],E),{}}(o,n)),n}(this.apiClient,_):function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["setup","model"],ms(e,s));const o=Te(t,["config"]);return null!=o&&Ae(n,["config"],mo(o,n)),n}(this.apiClient,_),delete y.config,v.send(JSON.stringify(y)),new Yo(v,this.apiClient)}isCallableTool(e){return"callTool"in e&&"function"==typeof e.callTool}}const $o={turnComplete:!0};class Yo{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let s=[];try{s=Is(t.turns),e.isVertexAI()||(s=s.map(e=>go(e)))}catch(n){throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:s,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(null==t.functionResponses)throw new Error("functionResponses is required.");if(n=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses],0===n.length)throw new Error("functionResponses is required.");for(const s of n){if("object"!=typeof s||null===s||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},$o),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:fo(e)}:{realtimeInput:ho(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function zo(e){var t,n,s;if(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.disable)return!0;let o=!1;for(const r of null!==(n=null==e?void 0:e.tools)&&void 0!==n?n:[])if(Wo(r)){o=!0;break}if(!o)return!0;const i=null===(s=null==e?void 0:e.automaticFunctionCalling)||void 0===s?void 0:s.maximumRemoteCalls;return!!(i&&(i<0||!Number.isInteger(i))||0==i)}function Wo(e){return"callTool"in e&&"function"==typeof e.callTool}function Ko(e){var t;const n=[];return(null===(t=null==e?void 0:e.config)||void 0===t?void 0:t.tools)?(e.config.tools.forEach((e,t)=>{if(Wo(e))return;const s=e;s.functionDeclarations&&s.functionDeclarations.length>0&&n.push(t)}),n):n}function Xo(e){var t;return!(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.ignoreCallHistory)}class Qo extends Se{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>{var t,n,s,o,i;const r=await this.processParamsMaybeAddMcpUsage(e);if(this.maybeMoveToResponseJsonSchem(e),!function(e){var t,n,s;return null!==(s=null===(n=null===(t=e.config)||void 0===t?void 0:t.tools)||void 0===n?void 0:n.some(e=>Wo(e)))&&void 0!==s&&s}(e)||zo(e.config))return await this.generateContentInternal(r);const a=Ko(e);if(a.length>0){const e=a.map(e=>`tools[${e}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${e}.`)}let l,c;const u=Is(r.contents),d=null!==(s=null===(n=null===(t=r.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==s?s:10;let p=0;for(;p<d&&(l=await this.generateContentInternal(r),l.functionCalls&&0!==l.functionCalls.length);){const t=l.candidates[0].content,n=[];for(const s of null!==(i=null===(o=e.config)||void 0===o?void 0:o.tools)&&void 0!==i?i:[])if(Wo(s)){const e=s,t=await e.callTool(l.functionCalls);n.push(...t)}p++,c={role:"user",parts:n},r.contents=Is(r.contents),r.contents.push(t),r.contents.push(c),Xo(r.config)&&(u.push(t),u.push(c))}return Xo(r.config)&&(l.automaticFunctionCallingHistory=u),l},this.generateContentStream=async e=>{var t,n,s,o,i;if(this.maybeMoveToResponseJsonSchem(e),zo(e.config)){const t=await this.processParamsMaybeAddMcpUsage(e);return await this.generateContentStreamInternal(t)}const r=Ko(e);if(r.length>0){const e=r.map(e=>`tools[${e}]`).join(", ");throw new Error(`Incompatible tools found at ${e}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const a=null===(s=null===(n=null===(t=null==e?void 0:e.config)||void 0===t?void 0:t.toolConfig)||void 0===n?void 0:n.functionCallingConfig)||void 0===s?void 0:s.streamFunctionCallArguments,l=null===(i=null===(o=null==e?void 0:e.config)||void 0===o?void 0:o.automaticFunctionCalling)||void 0===i?void 0:i.disable;if(a&&!l)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(e)},this.generateImages=async e=>await this.generateImagesInternal(e).then(e=>{var t;let n;const s=[];if(null==e?void 0:e.generatedImages)for(const i of e.generatedImages)i&&(null==i?void 0:i.safetyAttributes)&&"Positive Prompt"===(null===(t=null==i?void 0:i.safetyAttributes)||void 0===t?void 0:t.contentType)?n=null==i?void 0:i.safetyAttributes:s.push(i);let o;return o=n?{generatedImages:s,positivePromptSafetyAttributes:n,sdkHttpResponse:e.sdkHttpResponse}:{generatedImages:s,sdkHttpResponse:e.sdkHttpResponse},o}),this.list=async e=>{var t;const n={config:Object.assign(Object.assign({},{queryBase:!0}),null==e?void 0:e.config)};if(this.apiClient.isVertexAI()&&!n.config.queryBase){if(null===(t=n.config)||void 0===t?void 0:t.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");n.config.filter="labels.tune-type:*"}return new Ks(kn.PAGED_ITEM_MODELS,e=>this.listInternal(e),await this.listInternal(n),n)},this.editImage=async e=>{const t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(e=>e.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));const n={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(n)},this.generateVideos=async e=>{var t,n,s,o,i,r;if((e.prompt||e.image||e.video)&&e.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||((null===(t=e.video)||void 0===t?void 0:t.uri)&&(null===(n=e.video)||void 0===n?void 0:n.videoBytes)?e.video={uri:e.video.uri,mimeType:e.video.mimeType}:(null===(o=null===(s=e.source)||void 0===s?void 0:s.video)||void 0===o?void 0:o.uri)&&(null===(r=null===(i=e.source)||void 0===i?void 0:i.video)||void 0===r?void 0:r.videoBytes)&&(e.source.video={uri:e.source.video.uri,mimeType:e.source.video.mimeType})),await this.generateVideosInternal(e)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,n,s;const o=null===(t=e.config)||void 0===t?void 0:t.tools;if(!o)return e;const i=await Promise.all(o.map(async e=>{if(Wo(e)){const t=e;return await t.tool()}return e})),r={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:i})};if(r.config.tools=i,e.config&&e.config.tools&&qo(e.config.tools)){const t=null!==(s=null===(n=e.config.httpOptions)||void 0===n?void 0:n.headers)&&void 0!==s?s:{};let o=Object.assign({},t);0===Object.keys(o).length&&(o=this.apiClient.getDefaultHeaders()),Lo(o),r.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:o})}return r}async initAfcToolsMap(e){var t,n,s;const o=new Map;for(const i of null!==(n=null===(t=e.config)||void 0===t?void 0:t.tools)&&void 0!==n?n:[])if(Wo(i)){const e=i,t=await e.tool();for(const n of null!==(s=t.functionDeclarations)&&void 0!==s?s:[]){if(!n.name)throw new Error("Function declaration name is required.");if(o.has(n.name))throw new Error(`Duplicate tool declaration name: ${n.name}`);o.set(n.name,e)}}return o}async processAfcStream(e){var t,n,s;const o=null!==(s=null===(n=null===(t=e.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==s?s:10;let i=!1,r=0;return function(e,t,n){return no(this,arguments,function*(){for(var s,a,l,c,u,d;r<o;){i&&(r++,i=!1);const g=yield to(e.processParamsMaybeAddMcpUsage(n)),v=yield to(e.generateContentStreamInternal(g)),x=[],y=[];try{for(var p,m=!0,h=(a=void 0,so(v));!(s=(p=yield to(h.next())).done);m=!0){c=p.value,m=!1;const e=c;if(yield yield to(e),e.candidates&&(null===(u=e.candidates[0])||void 0===u?void 0:u.content)){y.push(e.candidates[0].content);for(const n of null!==(d=e.candidates[0].content.parts)&&void 0!==d?d:[])if(r<o&&n.functionCall){if(!n.functionCall.name)throw new Error("Function call name was not returned by the model.");if(!t.has(n.functionCall.name))throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${t.keys()}, mising tool: ${n.functionCall.name}`);{const e=yield to(t.get(n.functionCall.name).callTool([n.functionCall]));x.push(...e)}}}}}catch(f){a={error:f}}finally{try{m||s||!(l=h.return)||(yield to(l.call(h)))}finally{if(a)throw a.error}}if(!(x.length>0))break;{i=!0;const e=new Gn;e.candidates=[{content:{role:"user",parts:x}}],yield yield to(e);const t=[];t.push(...y),t.push({role:"user",parts:x});const s=Is(n.contents).concat(t);n.contents=s}}})}(this,await this.initAfcToolsMap(e),e)}async generateContentInternal(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=xo(this.apiClient,e);return r=Ie("{model}:generateContent",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=bo(e),n=new Gn;return Object.assign(n,t),n})}{const t=vo(this.apiClient,e);return r=Ie("{model}:generateContent",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=yo(e),n=new Gn;return Object.assign(n,t),n})}}async generateContentStreamInternal(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=xo(this.apiClient,e);return r=Ie("{model}:streamGenerateContent?alt=sse",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.requestStream({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}),i.then(function(e){return no(this,arguments,function*(){var t,n,s,o;try{for(var i,r=!0,a=so(e);!(t=(i=yield to(a.next())).done);r=!0){o=i.value,r=!1;const e=o,t=bo(yield to(e.json()));t.sdkHttpResponse={headers:e.headers};const n=new Gn;Object.assign(n,t),yield yield to(n)}}catch(l){n={error:l}}finally{try{r||t||!(s=a.return)||(yield to(s.call(a)))}finally{if(n)throw n.error}}})})}{const t=vo(this.apiClient,e);return r=Ie("{model}:streamGenerateContent?alt=sse",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.requestStream({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}),i.then(function(e){return no(this,arguments,function*(){var t,n,s,o;try{for(var i,r=!0,a=so(e);!(t=(i=yield to(a.next())).done);r=!0){o=i.value,r=!1;const e=o,t=yo(yield to(e.json()));t.sdkHttpResponse={headers:e.headers};const n=new Gn;Object.assign(n,t),yield yield to(n)}}catch(l){n={error:l}}finally{try{r||t||!(s=a.return)||(yield to(s.call(a)))}finally{if(n)throw n.error}}})})}}async embedContent(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["contents"]);if(null!=o){let t=Ss(e,o);Array.isArray(t)&&(t=t.map(e=>e)),Ae(n,["instances[]","content"],t)}const i=Te(t,["config"]);return null!=i&&function(e,t){const n=Te(e,["taskType"]);void 0!==t&&null!=n&&Ae(t,["instances[]","task_type"],n);const s=Te(e,["title"]);void 0!==t&&null!=s&&Ae(t,["instances[]","title"],s);const o=Te(e,["outputDimensionality"]);void 0!==t&&null!=o&&Ae(t,["parameters","outputDimensionality"],o);const i=Te(e,["mimeType"]);void 0!==t&&null!=i&&Ae(t,["instances[]","mimeType"],i);const r=Te(e,["autoTruncate"]);void 0!==t&&null!=r&&Ae(t,["parameters","autoTruncate"],r)}(i,n),n}(this.apiClient,e);return r=Ie("{model}:predict",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["predictions[]","embeddings"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["values"]);null!=n&&Ae(t,["values"],n);const s=Te(e,["statistics"]);return null!=s&&Ae(t,["statistics"],function(e){const t={},n=Te(e,["truncated"]);null!=n&&Ae(t,["truncated"],n);const s=Te(e,["token_count"]);return null!=s&&Ae(t,["tokenCount"],s),t}(s)),t}(e))),Ae(t,["embeddings"],e)}const o=Te(e,["metadata"]);return null!=o&&Ae(t,["metadata"],o),t}(e),n=new Fn;return Object.assign(n,t),n})}{const t=function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["contents"]);if(null!=o){let t=Ss(e,o);Array.isArray(t)&&(t=t.map(e=>e)),Ae(n,["requests[]","content"],t)}const i=Te(t,["config"]);null!=i&&function(e,t){const n=Te(e,["taskType"]);void 0!==t&&null!=n&&Ae(t,["requests[]","taskType"],n);const s=Te(e,["title"]);void 0!==t&&null!=s&&Ae(t,["requests[]","title"],s);const o=Te(e,["outputDimensionality"]);if(void 0!==t&&null!=o&&Ae(t,["requests[]","outputDimensionality"],o),void 0!==Te(e,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==Te(e,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.")}(i,n);const r=Te(t,["model"]);return void 0!==r&&Ae(n,["requests[]","model"],ms(e,r)),n}(this.apiClient,e);return r=Ie("{model}:batchEmbedContents",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["embeddings"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["embeddings"],e)}const o=Te(e,["metadata"]);return null!=o&&Ae(t,["metadata"],o),t}(e),n=new Fn;return Object.assign(n,t),n})}}async generateImagesInternal(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["prompt"]);null!=o&&Ae(n,["instances[0]","prompt"],o);const i=Te(t,["config"]);return null!=i&&function(e,t){const n=Te(e,["outputGcsUri"]);void 0!==t&&null!=n&&Ae(t,["parameters","storageUri"],n);const s=Te(e,["negativePrompt"]);void 0!==t&&null!=s&&Ae(t,["parameters","negativePrompt"],s);const o=Te(e,["numberOfImages"]);void 0!==t&&null!=o&&Ae(t,["parameters","sampleCount"],o);const i=Te(e,["aspectRatio"]);void 0!==t&&null!=i&&Ae(t,["parameters","aspectRatio"],i);const r=Te(e,["guidanceScale"]);void 0!==t&&null!=r&&Ae(t,["parameters","guidanceScale"],r);const a=Te(e,["seed"]);void 0!==t&&null!=a&&Ae(t,["parameters","seed"],a);const l=Te(e,["safetyFilterLevel"]);void 0!==t&&null!=l&&Ae(t,["parameters","safetySetting"],l);const c=Te(e,["personGeneration"]);void 0!==t&&null!=c&&Ae(t,["parameters","personGeneration"],c);const u=Te(e,["includeSafetyAttributes"]);void 0!==t&&null!=u&&Ae(t,["parameters","includeSafetyAttributes"],u);const d=Te(e,["includeRaiReason"]);void 0!==t&&null!=d&&Ae(t,["parameters","includeRaiReason"],d);const p=Te(e,["language"]);void 0!==t&&null!=p&&Ae(t,["parameters","language"],p);const m=Te(e,["outputMimeType"]);void 0!==t&&null!=m&&Ae(t,["parameters","outputOptions","mimeType"],m);const h=Te(e,["outputCompressionQuality"]);void 0!==t&&null!=h&&Ae(t,["parameters","outputOptions","compressionQuality"],h);const f=Te(e,["addWatermark"]);void 0!==t&&null!=f&&Ae(t,["parameters","addWatermark"],f);const g=Te(e,["labels"]);void 0!==t&&null!=g&&Ae(t,["labels"],g);const v=Te(e,["imageSize"]);void 0!==t&&null!=v&&Ae(t,["parameters","sampleImageSize"],v);const x=Te(e,["enhancePrompt"]);void 0!==t&&null!=x&&Ae(t,["parameters","enhancePrompt"],x)}(i,n),n}(this.apiClient,e);return r=Ie("{model}:predict",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["predictions"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>wo(e))),Ae(t,["generatedImages"],e)}const o=Te(e,["positivePromptSafetyAttributes"]);return null!=o&&Ae(t,["positivePromptSafetyAttributes"],Oo(o)),t}(e),n=new Vn;return Object.assign(n,t),n})}{const t=function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["prompt"]);null!=o&&Ae(n,["instances[0]","prompt"],o);const i=Te(t,["config"]);return null!=i&&function(e,t){if(void 0!==Te(e,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==Te(e,["negativePrompt"]))throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=Te(e,["numberOfImages"]);void 0!==t&&null!=n&&Ae(t,["parameters","sampleCount"],n);const s=Te(e,["aspectRatio"]);void 0!==t&&null!=s&&Ae(t,["parameters","aspectRatio"],s);const o=Te(e,["guidanceScale"]);if(void 0!==t&&null!=o&&Ae(t,["parameters","guidanceScale"],o),void 0!==Te(e,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const i=Te(e,["safetyFilterLevel"]);void 0!==t&&null!=i&&Ae(t,["parameters","safetySetting"],i);const r=Te(e,["personGeneration"]);void 0!==t&&null!=r&&Ae(t,["parameters","personGeneration"],r);const a=Te(e,["includeSafetyAttributes"]);void 0!==t&&null!=a&&Ae(t,["parameters","includeSafetyAttributes"],a);const l=Te(e,["includeRaiReason"]);void 0!==t&&null!=l&&Ae(t,["parameters","includeRaiReason"],l);const c=Te(e,["language"]);void 0!==t&&null!=c&&Ae(t,["parameters","language"],c);const u=Te(e,["outputMimeType"]);void 0!==t&&null!=u&&Ae(t,["parameters","outputOptions","mimeType"],u);const d=Te(e,["outputCompressionQuality"]);if(void 0!==t&&null!=d&&Ae(t,["parameters","outputOptions","compressionQuality"],d),void 0!==Te(e,["addWatermark"]))throw new Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==Te(e,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const p=Te(e,["imageSize"]);if(void 0!==t&&null!=p&&Ae(t,["parameters","sampleImageSize"],p),void 0!==Te(e,["enhancePrompt"]))throw new Error("enhancePrompt parameter is not supported in Gemini API.")}(i,n),n}(this.apiClient,e);return r=Ie("{model}:predict",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["predictions"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["_self"]);null!=n&&Ae(t,["image"],function(e){const t={},n=Te(e,["bytesBase64Encoded"]);null!=n&&Ae(t,["imageBytes"],Ms(n));const s=Te(e,["mimeType"]);return null!=s&&Ae(t,["mimeType"],s),t}(n));const s=Te(e,["raiFilteredReason"]);null!=s&&Ae(t,["raiFilteredReason"],s);const o=Te(e,["_self"]);return null!=o&&Ae(t,["safetyAttributes"],Co(o)),t}(e))),Ae(t,["generatedImages"],e)}const o=Te(e,["positivePromptSafetyAttributes"]);return null!=o&&Ae(t,["positivePromptSafetyAttributes"],Co(o)),t}(e),n=new Vn;return Object.assign(n,t),n})}}async editImageInternal(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["prompt"]);null!=o&&Ae(n,["instances[0]","prompt"],o);const i=Te(t,["referenceImages"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["referenceImage"]);null!=n&&Ae(t,["referenceImage"],Io(n));const s=Te(e,["referenceId"]);null!=s&&Ae(t,["referenceId"],s);const o=Te(e,["referenceType"]);null!=o&&Ae(t,["referenceType"],o);const i=Te(e,["maskImageConfig"]);null!=i&&Ae(t,["maskImageConfig"],function(e){const t={},n=Te(e,["maskMode"]);null!=n&&Ae(t,["maskMode"],n);const s=Te(e,["segmentationClasses"]);null!=s&&Ae(t,["maskClasses"],s);const o=Te(e,["maskDilation"]);return null!=o&&Ae(t,["dilation"],o),t}(i));const r=Te(e,["controlImageConfig"]);null!=r&&Ae(t,["controlImageConfig"],function(e){const t={},n=Te(e,["controlType"]);null!=n&&Ae(t,["controlType"],n);const s=Te(e,["enableControlImageComputation"]);return null!=s&&Ae(t,["computeControl"],s),t}(r));const a=Te(e,["styleImageConfig"]);null!=a&&Ae(t,["styleImageConfig"],a);const l=Te(e,["subjectImageConfig"]);return null!=l&&Ae(t,["subjectImageConfig"],l),t}(e))),Ae(n,["instances[0]","referenceImages"],e)}const r=Te(t,["config"]);return null!=r&&function(e,t){const n=Te(e,["outputGcsUri"]);void 0!==t&&null!=n&&Ae(t,["parameters","storageUri"],n);const s=Te(e,["negativePrompt"]);void 0!==t&&null!=s&&Ae(t,["parameters","negativePrompt"],s);const o=Te(e,["numberOfImages"]);void 0!==t&&null!=o&&Ae(t,["parameters","sampleCount"],o);const i=Te(e,["aspectRatio"]);void 0!==t&&null!=i&&Ae(t,["parameters","aspectRatio"],i);const r=Te(e,["guidanceScale"]);void 0!==t&&null!=r&&Ae(t,["parameters","guidanceScale"],r);const a=Te(e,["seed"]);void 0!==t&&null!=a&&Ae(t,["parameters","seed"],a);const l=Te(e,["safetyFilterLevel"]);void 0!==t&&null!=l&&Ae(t,["parameters","safetySetting"],l);const c=Te(e,["personGeneration"]);void 0!==t&&null!=c&&Ae(t,["parameters","personGeneration"],c);const u=Te(e,["includeSafetyAttributes"]);void 0!==t&&null!=u&&Ae(t,["parameters","includeSafetyAttributes"],u);const d=Te(e,["includeRaiReason"]);void 0!==t&&null!=d&&Ae(t,["parameters","includeRaiReason"],d);const p=Te(e,["language"]);void 0!==t&&null!=p&&Ae(t,["parameters","language"],p);const m=Te(e,["outputMimeType"]);void 0!==t&&null!=m&&Ae(t,["parameters","outputOptions","mimeType"],m);const h=Te(e,["outputCompressionQuality"]);void 0!==t&&null!=h&&Ae(t,["parameters","outputOptions","compressionQuality"],h);const f=Te(e,["addWatermark"]);void 0!==t&&null!=f&&Ae(t,["parameters","addWatermark"],f);const g=Te(e,["labels"]);void 0!==t&&null!=g&&Ae(t,["labels"],g);const v=Te(e,["editMode"]);void 0!==t&&null!=v&&Ae(t,["parameters","editMode"],v);const x=Te(e,["baseSteps"]);void 0!==t&&null!=x&&Ae(t,["parameters","editConfig","baseSteps"],x)}(r,n),n}(this.apiClient,e);return o=Ie("{model}:predict",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["predictions"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>wo(e))),Ae(t,["generatedImages"],e)}return t}(e),n=new Hn;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["image"]);null!=o&&Ae(n,["instances[0]","image"],Io(o));const i=Te(t,["upscaleFactor"]);null!=i&&Ae(n,["parameters","upscaleConfig","upscaleFactor"],i);const r=Te(t,["config"]);return null!=r&&function(e,t){const n=Te(e,["outputGcsUri"]);void 0!==t&&null!=n&&Ae(t,["parameters","storageUri"],n);const s=Te(e,["safetyFilterLevel"]);void 0!==t&&null!=s&&Ae(t,["parameters","safetySetting"],s);const o=Te(e,["personGeneration"]);void 0!==t&&null!=o&&Ae(t,["parameters","personGeneration"],o);const i=Te(e,["includeRaiReason"]);void 0!==t&&null!=i&&Ae(t,["parameters","includeRaiReason"],i);const r=Te(e,["outputMimeType"]);void 0!==t&&null!=r&&Ae(t,["parameters","outputOptions","mimeType"],r);const a=Te(e,["outputCompressionQuality"]);void 0!==t&&null!=a&&Ae(t,["parameters","outputOptions","compressionQuality"],a);const l=Te(e,["enhanceInputImage"]);void 0!==t&&null!=l&&Ae(t,["parameters","upscaleConfig","enhanceInputImage"],l);const c=Te(e,["imagePreservationFactor"]);void 0!==t&&null!=c&&Ae(t,["parameters","upscaleConfig","imagePreservationFactor"],c);const u=Te(e,["labels"]);void 0!==t&&null!=u&&Ae(t,["labels"],u);const d=Te(e,["numberOfImages"]);void 0!==t&&null!=d&&Ae(t,["parameters","sampleCount"],d);const p=Te(e,["mode"]);void 0!==t&&null!=p&&Ae(t,["parameters","mode"],p)}(r,n),n}(this.apiClient,e);return o=Ie("{model}:predict",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["predictions"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>wo(e))),Ae(t,["generatedImages"],e)}return t}(e),n=new Bn;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["source"]);null!=o&&function(e,t){const n=Te(e,["prompt"]);void 0!==t&&null!=n&&Ae(t,["instances[0]","prompt"],n);const s=Te(e,["personImage"]);void 0!==t&&null!=s&&Ae(t,["instances[0]","personImage","image"],Io(s));const o=Te(e,["productImages"]);if(void 0!==t&&null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["productImage"]);return null!=n&&Ae(t,["image"],Io(n)),t}(e))),Ae(t,["instances[0]","productImages"],e)}}(o,n);const i=Te(t,["config"]);return null!=i&&function(e,t){const n=Te(e,["numberOfImages"]);void 0!==t&&null!=n&&Ae(t,["parameters","sampleCount"],n);const s=Te(e,["baseSteps"]);void 0!==t&&null!=s&&Ae(t,["parameters","baseSteps"],s);const o=Te(e,["outputGcsUri"]);void 0!==t&&null!=o&&Ae(t,["parameters","storageUri"],o);const i=Te(e,["seed"]);void 0!==t&&null!=i&&Ae(t,["parameters","seed"],i);const r=Te(e,["safetyFilterLevel"]);void 0!==t&&null!=r&&Ae(t,["parameters","safetySetting"],r);const a=Te(e,["personGeneration"]);void 0!==t&&null!=a&&Ae(t,["parameters","personGeneration"],a);const l=Te(e,["addWatermark"]);void 0!==t&&null!=l&&Ae(t,["parameters","addWatermark"],l);const c=Te(e,["outputMimeType"]);void 0!==t&&null!=c&&Ae(t,["parameters","outputOptions","mimeType"],c);const u=Te(e,["outputCompressionQuality"]);void 0!==t&&null!=u&&Ae(t,["parameters","outputOptions","compressionQuality"],u);const d=Te(e,["enhancePrompt"]);void 0!==t&&null!=d&&Ae(t,["parameters","enhancePrompt"],d);const p=Te(e,["labels"]);void 0!==t&&null!=p&&Ae(t,["labels"],p)}(i,n),n}(this.apiClient,e);return o=Ie("{model}:predict",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=Te(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>wo(e))),Ae(t,["generatedImages"],e)}return t}(e),n=new Jn;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["source"]);null!=o&&function(e,t){const n=Te(e,["prompt"]);void 0!==t&&null!=n&&Ae(t,["instances[0]","prompt"],n);const s=Te(e,["image"]);void 0!==t&&null!=s&&Ae(t,["instances[0]","image"],Io(s));const o=Te(e,["scribbleImage"]);void 0!==t&&null!=o&&Ae(t,["instances[0]","scribble"],function(e){const t={},n=Te(e,["image"]);return null!=n&&Ae(t,["image"],Io(n)),t}(o))}(o,n);const i=Te(t,["config"]);return null!=i&&function(e,t){const n=Te(e,["mode"]);void 0!==t&&null!=n&&Ae(t,["parameters","mode"],n);const s=Te(e,["maxPredictions"]);void 0!==t&&null!=s&&Ae(t,["parameters","maxPredictions"],s);const o=Te(e,["confidenceThreshold"]);void 0!==t&&null!=o&&Ae(t,["parameters","confidenceThreshold"],o);const i=Te(e,["maskDilation"]);void 0!==t&&null!=i&&Ae(t,["parameters","maskDilation"],i);const r=Te(e,["binaryColorThreshold"]);void 0!==t&&null!=r&&Ae(t,["parameters","binaryColorThreshold"],r);const a=Te(e,["labels"]);void 0!==t&&null!=a&&Ae(t,["labels"],a)}(i,n),n}(this.apiClient,e);return o=Ie("{model}:predict",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=Te(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["_self"]);null!=n&&Ae(t,["mask"],No(n));const s=Te(e,["labels"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["labels"],e)}return t}(e))),Ae(t,["generatedMasks"],e)}return t}(e),n=new $n;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=Te(t,["model"]);return null!=s&&Ae(n,["_url","name"],ms(e,s)),n}(this.apiClient,e);return r=Ie("{name}",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>To(e))}{const t=function(e,t){const n={},s=Te(t,["model"]);return null!=s&&Ae(n,["_url","name"],ms(e,s)),n}(this.apiClient,e);return r=Ie("{name}",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json()),i.then(e=>Ao(e))}}async listInternal(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=Te(t,["config"]);return null!=s&&function(e,t,n){const s=Te(t,["pageSize"]);void 0!==n&&null!=s&&Ae(n,["_query","pageSize"],s);const o=Te(t,["pageToken"]);void 0!==n&&null!=o&&Ae(n,["_query","pageToken"],o);const i=Te(t,["filter"]);void 0!==n&&null!=i&&Ae(n,["_query","filter"],i);const r=Te(t,["queryBase"]);void 0!==n&&null!=r&&Ae(n,["_url","models_url"],ks(e,r))}(e,s,n),n}(this.apiClient,e);return r=Ie("{models_url}",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["nextPageToken"]);null!=s&&Ae(t,["nextPageToken"],s);const o=Te(e,["_self"]);if(null!=o){let e=qs(o);Array.isArray(e)&&(e=e.map(e=>To(e))),Ae(t,["models"],e)}return t}(e),n=new Yn;return Object.assign(n,t),n})}{const t=function(e,t){const n={},s=Te(t,["config"]);return null!=s&&function(e,t,n){const s=Te(t,["pageSize"]);void 0!==n&&null!=s&&Ae(n,["_query","pageSize"],s);const o=Te(t,["pageToken"]);void 0!==n&&null!=o&&Ae(n,["_query","pageToken"],o);const i=Te(t,["filter"]);void 0!==n&&null!=i&&Ae(n,["_query","filter"],i);const r=Te(t,["queryBase"]);void 0!==n&&null!=r&&Ae(n,["_url","models_url"],ks(e,r))}(e,s,n),n}(this.apiClient,e);return r=Ie("{models_url}",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["nextPageToken"]);null!=s&&Ae(t,["nextPageToken"],s);const o=Te(e,["_self"]);if(null!=o){let e=qs(o);Array.isArray(e)&&(e=e.map(e=>Ao(e))),Ae(t,["models"],e)}return t}(e),n=new Yn;return Object.assign(n,t),n})}}async update(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["config"]);return null!=o&&function(e,t){const n=Te(e,["displayName"]);void 0!==t&&null!=n&&Ae(t,["displayName"],n);const s=Te(e,["description"]);void 0!==t&&null!=s&&Ae(t,["description"],s);const o=Te(e,["defaultCheckpointId"]);void 0!==t&&null!=o&&Ae(t,["defaultCheckpointId"],o)}(o,n),n}(this.apiClient,e);return r=Ie("{model}",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>To(e))}{const t=function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","name"],ms(e,s));const o=Te(t,["config"]);return null!=o&&function(e,t){const n=Te(e,["displayName"]);void 0!==t&&null!=n&&Ae(t,["displayName"],n);const s=Te(e,["description"]);void 0!==t&&null!=s&&Ae(t,["description"],s);const o=Te(e,["defaultCheckpointId"]);void 0!==t&&null!=o&&Ae(t,["defaultCheckpointId"],o)}(o,n),n}(this.apiClient,e);return r=Ie("{name}",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json()),i.then(e=>Ao(e))}}async delete(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=Te(t,["model"]);return null!=s&&Ae(n,["_url","name"],ms(e,s)),n}(this.apiClient,e);return r=Ie("{name}",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);return null!=n&&Ae(t,["sdkHttpResponse"],n),t}(e),n=new zn;return Object.assign(n,t),n})}{const t=function(e,t){const n={},s=Te(t,["model"]);return null!=s&&Ae(n,["_url","name"],ms(e,s)),n}(this.apiClient,e);return r=Ie("{name}",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);return null!=n&&Ae(t,["sdkHttpResponse"],n),t}(e),n=new zn;return Object.assign(n,t),n})}}async countTokens(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["contents"]);if(null!=o){let e=Is(o);Array.isArray(e)&&(e=e.map(e=>e)),Ae(n,["contents"],e)}const i=Te(t,["config"]);return null!=i&&function(e,t){const n=Te(e,["systemInstruction"]);void 0!==t&&null!=n&&Ae(t,["systemInstruction"],Ns(n));const s=Te(e,["tools"]);if(void 0!==t&&null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>jo(e))),Ae(t,["tools"],e)}const o=Te(e,["generationConfig"]);void 0!==t&&null!=o&&Ae(t,["generationConfig"],function(e){const t={},n=Te(e,["modelSelectionConfig"]);null!=n&&Ae(t,["modelConfig"],n);const s=Te(e,["responseJsonSchema"]);null!=s&&Ae(t,["responseJsonSchema"],s);const o=Te(e,["audioTimestamp"]);null!=o&&Ae(t,["audioTimestamp"],o);const i=Te(e,["candidateCount"]);null!=i&&Ae(t,["candidateCount"],i);const r=Te(e,["enableAffectiveDialog"]);null!=r&&Ae(t,["enableAffectiveDialog"],r);const a=Te(e,["frequencyPenalty"]);null!=a&&Ae(t,["frequencyPenalty"],a);const l=Te(e,["logprobs"]);null!=l&&Ae(t,["logprobs"],l);const c=Te(e,["maxOutputTokens"]);null!=c&&Ae(t,["maxOutputTokens"],c);const u=Te(e,["mediaResolution"]);null!=u&&Ae(t,["mediaResolution"],u);const d=Te(e,["presencePenalty"]);null!=d&&Ae(t,["presencePenalty"],d);const p=Te(e,["responseLogprobs"]);null!=p&&Ae(t,["responseLogprobs"],p);const m=Te(e,["responseMimeType"]);null!=m&&Ae(t,["responseMimeType"],m);const h=Te(e,["responseModalities"]);null!=h&&Ae(t,["responseModalities"],h);const f=Te(e,["responseSchema"]);null!=f&&Ae(t,["responseSchema"],f);const g=Te(e,["routingConfig"]);null!=g&&Ae(t,["routingConfig"],g);const v=Te(e,["seed"]);null!=v&&Ae(t,["seed"],v);const x=Te(e,["speechConfig"]);null!=x&&Ae(t,["speechConfig"],x);const y=Te(e,["stopSequences"]);null!=y&&Ae(t,["stopSequences"],y);const b=Te(e,["temperature"]);null!=b&&Ae(t,["temperature"],b);const E=Te(e,["thinkingConfig"]);null!=E&&Ae(t,["thinkingConfig"],E);const _=Te(e,["topK"]);null!=_&&Ae(t,["topK"],_);const w=Te(e,["topP"]);if(null!=w&&Ae(t,["topP"],w),void 0!==Te(e,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(o))}(i,n),n}(this.apiClient,e);return r=Ie("{model}:countTokens",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["totalTokens"]);return null!=s&&Ae(t,["totalTokens"],s),t}(e),n=new Wn;return Object.assign(n,t),n})}{const t=function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["contents"]);if(null!=o){let e=Is(o);Array.isArray(e)&&(e=e.map(e=>go(e))),Ae(n,["contents"],e)}const i=Te(t,["config"]);return null!=i&&function(e){if(void 0!==Te(e,["systemInstruction"]))throw new Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==Te(e,["tools"]))throw new Error("tools parameter is not supported in Gemini API.");if(void 0!==Te(e,["generationConfig"]))throw new Error("generationConfig parameter is not supported in Gemini API.")}(i),n}(this.apiClient,e);return r=Ie("{model}:countTokens",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["totalTokens"]);null!=s&&Ae(t,["totalTokens"],s);const o=Te(e,["cachedContentTokenCount"]);return null!=o&&Ae(t,["cachedContentTokenCount"],o),t}(e),n=new Wn;return Object.assign(n,t),n})}}async computeTokens(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["_url","model"],ms(e,s));const o=Te(t,["contents"]);if(null!=o){let e=Is(o);Array.isArray(e)&&(e=e.map(e=>e)),Ae(n,["contents"],e)}return n}(this.apiClient,e);return o=Ie("{model}:computeTokens",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["tokensInfo"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["tokensInfo"],e)}return t}(e),n=new Kn;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=_o(this.apiClient,e);return r=Ie("{model}:predictLongRunning",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i.then(e=>{const t=function(e){const t={},n=Te(e,["name"]);null!=n&&Ae(t,["name"],n);const s=Te(e,["metadata"]);null!=s&&Ae(t,["metadata"],s);const o=Te(e,["done"]);null!=o&&Ae(t,["done"],o);const i=Te(e,["error"]);null!=i&&Ae(t,["error"],i);const r=Te(e,["response"]);return null!=r&&Ae(t,["response"],function(e){const t={},n=Te(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["_self"]);return null!=n&&Ae(t,["video"],function(e){const t={},n=Te(e,["gcsUri"]);null!=n&&Ae(t,["uri"],n);const s=Te(e,["bytesBase64Encoded"]);null!=s&&Ae(t,["videoBytes"],Ms(s));const o=Te(e,["mimeType"]);return null!=o&&Ae(t,["mimeType"],o),t}(n)),t}(e))),Ae(t,["generatedVideos"],e)}const s=Te(e,["raiMediaFilteredCount"]);null!=s&&Ae(t,["raiMediaFilteredCount"],s);const o=Te(e,["raiMediaFilteredReasons"]);return null!=o&&Ae(t,["raiMediaFilteredReasons"],o),t}(r)),t}(e),n=new Xn;return Object.assign(n,t),n})}{const t=Eo(this.apiClient,e);return r=Ie("{model}:predictLongRunning",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json()),i.then(e=>{const t=function(e){const t={},n=Te(e,["name"]);null!=n&&Ae(t,["name"],n);const s=Te(e,["metadata"]);null!=s&&Ae(t,["metadata"],s);const o=Te(e,["done"]);null!=o&&Ae(t,["done"],o);const i=Te(e,["error"]);null!=i&&Ae(t,["error"],i);const r=Te(e,["response","generateVideoResponse"]);return null!=r&&Ae(t,["response"],function(e){const t={},n=Te(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["video"]);return null!=n&&Ae(t,["video"],function(e){const t={},n=Te(e,["uri"]);null!=n&&Ae(t,["uri"],n);const s=Te(e,["encodedVideo"]);null!=s&&Ae(t,["videoBytes"],Ms(s));const o=Te(e,["encoding"]);return null!=o&&Ae(t,["mimeType"],o),t}(n)),t}(e))),Ae(t,["generatedVideos"],e)}const s=Te(e,["raiMediaFilteredCount"]);null!=s&&Ae(t,["raiMediaFilteredCount"],s);const o=Te(e,["raiMediaFilteredReasons"]);return null!=o&&Ae(t,["raiMediaFilteredReasons"],o),t}(r)),t}(e),n=new Xn;return Object.assign(n,t),n})}}}class Zo extends Se{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const e=t.name.split("/operations/")[0];let s;n&&"httpOptions"in n&&(s=n.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:e,config:{httpOptions:s}});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}{const e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async get(e){const t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const e=t.name.split("/operations/")[0];let s;n&&"httpOptions"in n&&(s=n.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:e,config:{httpOptions:s}});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}{const e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e){const t={},n=Te(e,["operationName"]);return null!=n&&Ae(t,["_url","operationName"],n),t}(e);return r=Ie("{operationName}",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),i}{const t=function(e){const t={},n=Te(e,["operationName"]);return null!=n&&Ae(t,["_url","operationName"],n),t}(e);return r=Ie("{operationName}",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json()),i}}async fetchPredictVideosOperationInternal(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI()){const r=function(e){const t={},n=Te(e,["operationName"]);null!=n&&Ae(t,["operationName"],n);const s=Te(e,["resourceName"]);return null!=s&&Ae(t,["_url","resourceName"],s),t}(e);return o=Ie("{resourceName}:fetchPredictOperation",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s}throw new Error("This method is only supported by the Vertex AI.")}}function ei(e,t,n){const s=Te(t,["expireTime"]);void 0!==n&&null!=s&&Ae(n,["expireTime"],s);const o=Te(t,["newSessionExpireTime"]);void 0!==n&&null!=o&&Ae(n,["newSessionExpireTime"],o);const i=Te(t,["uses"]);void 0!==n&&null!=i&&Ae(n,["uses"],i);const r=Te(t,["liveConnectConstraints"]);void 0!==n&&null!=r&&Ae(n,["bidiGenerateContentSetup"],function(e,t){const n={},s=Te(t,["model"]);null!=s&&Ae(n,["setup","model"],ms(e,s));const o=Te(t,["config"]);return null!=o&&Ae(n,["config"],function(e,t){const n=Te(e,["generationConfig"]);void 0!==t&&null!=n&&Ae(t,["setup","generationConfig"],n);const s=Te(e,["responseModalities"]);void 0!==t&&null!=s&&Ae(t,["setup","generationConfig","responseModalities"],s);const o=Te(e,["temperature"]);void 0!==t&&null!=o&&Ae(t,["setup","generationConfig","temperature"],o);const i=Te(e,["topP"]);void 0!==t&&null!=i&&Ae(t,["setup","generationConfig","topP"],i);const r=Te(e,["topK"]);void 0!==t&&null!=r&&Ae(t,["setup","generationConfig","topK"],r);const a=Te(e,["maxOutputTokens"]);void 0!==t&&null!=a&&Ae(t,["setup","generationConfig","maxOutputTokens"],a);const l=Te(e,["mediaResolution"]);void 0!==t&&null!=l&&Ae(t,["setup","generationConfig","mediaResolution"],l);const c=Te(e,["seed"]);void 0!==t&&null!=c&&Ae(t,["setup","generationConfig","seed"],c);const u=Te(e,["speechConfig"]);void 0!==t&&null!=u&&Ae(t,["setup","generationConfig","speechConfig"],Os(u));const d=Te(e,["thinkingConfig"]);void 0!==t&&null!=d&&Ae(t,["setup","generationConfig","thinkingConfig"],d);const p=Te(e,["enableAffectiveDialog"]);void 0!==t&&null!=p&&Ae(t,["setup","generationConfig","enableAffectiveDialog"],p);const m=Te(e,["systemInstruction"]);void 0!==t&&null!=m&&Ae(t,["setup","systemInstruction"],function(e){const t={},n=Te(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["mediaResolution"]);null!=n&&Ae(t,["mediaResolution"],n);const s=Te(e,["codeExecutionResult"]);null!=s&&Ae(t,["codeExecutionResult"],s);const o=Te(e,["executableCode"]);null!=o&&Ae(t,["executableCode"],o);const i=Te(e,["fileData"]);null!=i&&Ae(t,["fileData"],function(e){const t={};if(void 0!==Te(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=Te(e,["fileUri"]);null!=n&&Ae(t,["fileUri"],n);const s=Te(e,["mimeType"]);return null!=s&&Ae(t,["mimeType"],s),t}(i));const r=Te(e,["functionCall"]);null!=r&&Ae(t,["functionCall"],function(e){const t={},n=Te(e,["id"]);null!=n&&Ae(t,["id"],n);const s=Te(e,["args"]);null!=s&&Ae(t,["args"],s);const o=Te(e,["name"]);if(null!=o&&Ae(t,["name"],o),void 0!==Te(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==Te(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(r));const a=Te(e,["functionResponse"]);null!=a&&Ae(t,["functionResponse"],a);const l=Te(e,["inlineData"]);null!=l&&Ae(t,["inlineData"],function(e){const t={},n=Te(e,["data"]);if(null!=n&&Ae(t,["data"],n),void 0!==Te(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const s=Te(e,["mimeType"]);return null!=s&&Ae(t,["mimeType"],s),t}(l));const c=Te(e,["text"]);null!=c&&Ae(t,["text"],c);const u=Te(e,["thought"]);null!=u&&Ae(t,["thought"],u);const d=Te(e,["thoughtSignature"]);null!=d&&Ae(t,["thoughtSignature"],d);const p=Te(e,["videoMetadata"]);return null!=p&&Ae(t,["videoMetadata"],p),t}(e))),Ae(t,["parts"],e)}const s=Te(e,["role"]);return null!=s&&Ae(t,["role"],s),t}(Ns(m)));const h=Te(e,["tools"]);if(void 0!==t&&null!=h){let e=Rs(h);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=Te(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["functionDeclarations"],e)}if(void 0!==Te(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const s=Te(e,["googleSearchRetrieval"]);null!=s&&Ae(t,["googleSearchRetrieval"],s);const o=Te(e,["computerUse"]);null!=o&&Ae(t,["computerUse"],o);const i=Te(e,["fileSearch"]);null!=i&&Ae(t,["fileSearch"],i);const r=Te(e,["codeExecution"]);if(null!=r&&Ae(t,["codeExecution"],r),void 0!==Te(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=Te(e,["googleMaps"]);null!=a&&Ae(t,["googleMaps"],function(e){const t={};if(void 0!==Te(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=Te(e,["enableWidget"]);return null!=n&&Ae(t,["enableWidget"],n),t}(a));const l=Te(e,["googleSearch"]);null!=l&&Ae(t,["googleSearch"],function(e){const t={};if(void 0!==Te(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==Te(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=Te(e,["timeRangeFilter"]);return null!=n&&Ae(t,["timeRangeFilter"],n),t}(l));const c=Te(e,["urlContext"]);return null!=c&&Ae(t,["urlContext"],c),t}(js(e)))),Ae(t,["setup","tools"],e)}const f=Te(e,["sessionResumption"]);void 0!==t&&null!=f&&Ae(t,["setup","sessionResumption"],function(e){const t={},n=Te(e,["handle"]);if(null!=n&&Ae(t,["handle"],n),void 0!==Te(e,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return t}(f));const g=Te(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&Ae(t,["setup","inputAudioTranscription"],g);const v=Te(e,["outputAudioTranscription"]);void 0!==t&&null!=v&&Ae(t,["setup","outputAudioTranscription"],v);const x=Te(e,["realtimeInputConfig"]);void 0!==t&&null!=x&&Ae(t,["setup","realtimeInputConfig"],x);const y=Te(e,["contextWindowCompression"]);void 0!==t&&null!=y&&Ae(t,["setup","contextWindowCompression"],y);const b=Te(e,["proactivity"]);if(void 0!==t&&null!=b&&Ae(t,["setup","proactivity"],b),void 0!==Te(e,["explicitVadSignal"]))throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return{}}(o,n)),n}(e,r));const a=Te(t,["lockAdditionalFields"]);return void 0!==n&&null!=a&&Ae(n,["fieldMask"],a),{}}class ti extends Se{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const r=function(e,t){const n={},s=Te(t,["config"]);return null!=s&&Ae(n,["config"],ei(e,s,n)),n}(this.apiClient,e);o=Ie("auth_tokens",r._url),i=r._query,delete r.config,delete r._url,delete r._query;const a=function(e,t){let n=null;const s=e.bidiGenerateContentSetup;if("object"==typeof s&&null!==s&&"setup"in s){const t=s.setup;"object"==typeof t&&null!==t?(e.bidiGenerateContentSetup=t,n=t):delete e.bidiGenerateContentSetup}else void 0!==s&&delete e.bidiGenerateContentSetup;const o=e.fieldMask;if(n){const s=function(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const s=e[n];if("object"==typeof s&&null!=s&&Object.keys(s).length>0){const e=Object.keys(s).map(e=>`${n}.${e}`);t.push(...e)}else t.push(n)}return t.join(",")}(n);if(Array.isArray(null==t?void 0:t.lockAdditionalFields)&&0===(null==t?void 0:t.lockAdditionalFields.length))s?e.fieldMask=s:delete e.fieldMask;else if((null==t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==o&&Array.isArray(o)&&o.length>0){const t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let n=[];o.length>0&&(n=o.map(e=>t.includes(e)?`generationConfig.${e}`:e));const i=[];s&&i.push(s),n.length>0&&i.push(...n),i.length>0?e.fieldMask=i.join(","):delete e.fieldMask}else delete e.fieldMask}else null!==o&&Array.isArray(o)&&o.length>0?e.fieldMask=o.join(","):delete e.fieldMask;return e}(r,e.config);return s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>e)}}}class ni extends Se{constructor(e){super(),this.apiClient=e,this.list=async e=>new Ks(kn.PAGED_ITEM_DOCUMENTS,t=>this.listInternal({parent:e.parent,config:t.config}),await this.listInternal(e),e)}async get(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=Te(e,["name"]);return null!=n&&Ae(t,["_url","name"],n),t}(e);return o=Ie("{name}",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>e)}}async delete(e){var t,n;let s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=function(e){const t={},n=Te(e,["name"]);null!=n&&Ae(t,["_url","name"],n);const s=Te(e,["config"]);return null!=s&&function(e,t){const n=Te(e,["force"]);void 0!==t&&null!=n&&Ae(t,["_query","force"],n)}(s,t),t}(e);s=Ie("{name}",i._url),o=i._query,delete i._url,delete i._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}}async listInternal(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=Te(e,["parent"]);null!=n&&Ae(t,["_url","parent"],n);const s=Te(e,["config"]);return null!=s&&function(e,t){const n=Te(e,["pageSize"]);void 0!==t&&null!=n&&Ae(t,["_query","pageSize"],n);const s=Te(e,["pageToken"]);void 0!==t&&null!=s&&Ae(t,["_query","pageToken"],s)}(s,t),t}(e);return o=Ie("{parent}/documents",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["nextPageToken"]);null!=s&&Ae(t,["nextPageToken"],s);const o=Te(e,["documents"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["documents"],e)}return t}(e),n=new ns;return Object.assign(n,t),n})}}}class si extends Se{constructor(e,t=new ni(e)){super(),this.apiClient=e,this.documents=t,this.list=async(e={})=>new Ks(kn.PAGED_ITEM_FILE_SEARCH_STORES,e=>this.listInternal(e),await this.listInternal(e),e)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=Te(e,["config"]);return null!=n&&function(e,t){const n=Te(e,["displayName"]);void 0!==t&&null!=n&&Ae(t,["displayName"],n)}(n,t),t}(e);return o=Ie("fileSearchStores",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>e)}}async get(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=Te(e,["name"]);return null!=n&&Ae(t,["_url","name"],n),t}(e);return o=Ie("{name}",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>e)}}async delete(e){var t,n;let s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=function(e){const t={},n=Te(e,["name"]);null!=n&&Ae(t,["_url","name"],n);const s=Te(e,["config"]);return null!=s&&function(e,t){const n=Te(e,["force"]);void 0!==t&&null!=n&&Ae(t,["_query","force"],n)}(s,t),t}(e);s=Ie("{name}",i._url),o=i._query,delete i._url,delete i._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}}async listInternal(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=Te(e,["config"]);return null!=n&&function(e,t){const n=Te(e,["pageSize"]);void 0!==t&&null!=n&&Ae(t,["_query","pageSize"],n);const s=Te(e,["pageToken"]);void 0!==t&&null!=s&&Ae(t,["_query","pageToken"],s)}(n,t),t}(e);return o=Ie("fileSearchStores",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["nextPageToken"]);null!=s&&Ae(t,["nextPageToken"],s);const o=Te(e,["fileSearchStores"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["fileSearchStores"],e)}return t}(e),n=new ss;return Object.assign(n,t),n})}}async uploadToFileSearchStoreInternal(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=Te(e,["fileSearchStoreName"]);null!=n&&Ae(t,["_url","file_search_store_name"],n);const s=Te(e,["config"]);return null!=s&&Do(s,t),t}(e);return o=Ie("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);return null!=n&&Ae(t,["sdkHttpResponse"],n),t}(e),n=new os;return Object.assign(n,t),n})}}async importFile(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=Te(e,["fileSearchStoreName"]);null!=n&&Ae(t,["_url","file_search_store_name"],n);const s=Te(e,["fileName"]);null!=s&&Ae(t,["fileName"],s);const o=Te(e,["config"]);return null!=o&&function(e,t){const n=Te(e,["customMetadata"]);if(void 0!==t&&null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["customMetadata"],e)}const s=Te(e,["chunkingConfig"]);void 0!==t&&null!=s&&Ae(t,["chunkingConfig"],s)}(o,t),t}(e);return o=Ie("{file_search_store_name}:importFile",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=Te(e,["name"]);null!=n&&Ae(t,["name"],n);const s=Te(e,["metadata"]);null!=s&&Ae(t,["metadata"],s);const o=Te(e,["done"]);null!=o&&Ae(t,["done"],o);const i=Te(e,["error"]);null!=i&&Ae(t,["error"],i);const r=Te(e,["response"]);return null!=r&&Ae(t,["response"],function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["parent"]);null!=s&&Ae(t,["parent"],s);const o=Te(e,["documentName"]);return null!=o&&Ae(t,["documentName"],o),t}(r)),t}(e),n=new is;return Object.assign(n,t),n})}}}let oi=function(){const{crypto:e}=globalThis;if(null==e?void 0:e.randomUUID)return oi=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(+e^n()&15>>+e/4).toString(16))};function ii(e){return"object"==typeof e&&null!==e&&("name"in e&&"AbortError"===e.name||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const ri=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e){try{if("[object Error]"===Object.prototype.toString.call(e)){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch(t){}try{return new Error(JSON.stringify(e))}catch(n){}}return new Error(e)};class ai extends Error{}class li extends ai{constructor(e,t,n,s){super(`${li.makeMessage(e,t,n)}`),this.status=e,this.headers=s,this.error=t}static makeMessage(e,t,n){const s=(null==t?void 0:t.message)?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,n,s){if(!e||!s)return new ui({message:n,cause:ri(t)});const o=t;return 400===e?new pi(e,o,n,s):401===e?new mi(e,o,n,s):403===e?new hi(e,o,n,s):404===e?new fi(e,o,n,s):409===e?new gi(e,o,n,s):422===e?new vi(e,o,n,s):429===e?new xi(e,o,n,s):e>=500?new yi(e,o,n,s):new li(e,o,n,s)}}class ci extends li{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class ui extends li{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class di extends ui{constructor({message:e}={}){super({message:null!=e?e:"Request timed out."})}}class pi extends li{}class mi extends li{}class hi extends li{}class fi extends li{}class gi extends li{}class vi extends li{}class xi extends li{}class yi extends li{}const bi=/^[a-z][a-z0-9+.-]*:/i;let Ei=e=>(Ei=Array.isArray,Ei(e));const _i=Ei,wi="0.0.1",Ni=()=>{var e,t,n,s,o;const i="undefined"!=typeof Deno&&null!=Deno.build?"deno":"undefined"!=typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===i)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wi,"X-Stainless-OS":Ii(Deno.build.os),"X-Stainless-Arch":Si(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:null!==(t=null===(e=Deno.version)||void 0===e?void 0:e.deno)&&void 0!==t?t:"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===i)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wi,"X-Stainless-OS":Ii(null!==(n=globalThis.process.platform)&&void 0!==n?n:"unknown"),"X-Stainless-Arch":Si(null!==(s=globalThis.process.arch)&&void 0!==s?s:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":null!==(o=globalThis.process.version)&&void 0!==o?o:"unknown"};const r=function(){if("undefined"==typeof navigator||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const e=n.exec(navigator.userAgent);if(e)return{browser:t,version:`${e[1]||0}.${e[2]||0}.${e[3]||0}`}}return null}();return r?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${r.browser}`,"X-Stainless-Runtime-Version":r.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}},Si=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",Ii=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown";let Ai;function Ti(...e){const t=globalThis.ReadableStream;if(void 0===t)throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function Ci(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return Ti({start(){},async pull(e){const{done:n,value:s}=await t.next();n?e.close():e.enqueue(s)},async cancel(){var e;await(null===(e=t.return)||void 0===e?void 0:e.call(t))}})}function Oi(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();return(null==e?void 0:e.done)&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const ji=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)}),Ri=()=>{var e;if("undefined"==typeof File){const{process:t}=globalThis,n="string"==typeof(null===(e=null==t?void 0:t.versions)||void 0===e?void 0:e.node)&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Pi(e,t,n){return Ri(),new File(e,null!=t?t:"unknown_file",n)}const Di=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer;async function Mi(e){var t,n,s,o,i;let r=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)r.push(e);else if(Di(e))r.push(e instanceof Blob?e:await e.arrayBuffer());else{if(!(e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator])(e)){const t=null===(i=null==e?void 0:e.constructor)||void 0===i?void 0:i.name;throw new Error(`Unexpected data type: ${typeof e}${t?`; constructor: ${t}`:""}${function(e){if("object"!=typeof e||null===e)return"";return`; props: [${Object.getOwnPropertyNames(e).map(e=>`"${e}"`).join(", ")}]`}(e)}`)}try{for(var a,l=!0,c=so(e);!(t=(a=await c.next()).done);l=!0){o=a.value,l=!1;const e=o;r.push(...await Mi(e))}}catch(u){n={error:u}}finally{try{l||t||!(s=c.return)||await s.call(c)}finally{if(n)throw n.error}}}return r}class Ui{constructor(e){this._client=e}}function ki(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}Ui._key=[];const qi=Object.freeze(Object.create(null)),Li=((e=ki)=>function(t,...n){if(1===t.length)return t[0];let s=!1;const o=[],i=t.reduce((t,i,r)=>{var a,l,c;/[?#]/.test(i)&&(s=!0);const u=n[r];let d=(s?encodeURIComponent:e)(""+u);return r!==n.length&&(null==u||"object"==typeof u&&u.toString===(null===(c=Object.getPrototypeOf(null!==(l=Object.getPrototypeOf(null!==(a=u.hasOwnProperty)&&void 0!==a?a:qi))&&void 0!==l?l:qi))||void 0===c?void 0:c.toString))&&(d=u+"",o.push({start:t.length+i.length,length:d.length,error:`Value of type ${Object.prototype.toString.call(u).slice(8,-1)} is not a valid path parameter`})),t+i+(r===n.length?"":d)},""),r=i.split(/[?#]/,1)[0],a=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let l;for(;null!==(l=a.exec(r));)o.push({start:l.index,length:l[0].length,error:`Value "${l[0]}" can't be safely passed as a path parameter`});if(o.sort((e,t)=>e.start-t.start),o.length>0){let e=0;const t=o.reduce((t,n)=>{const s=" ".repeat(n.start-e),o="^".repeat(n.length);return e=n.start+n.length,t+s+o},"");throw new ai(`Path parameters result in path with invalid segments:\n${o.map(e=>e.error).join("\n")}\n${i}\n${t}`)}return i})(ki);class Gi extends Ui{create(e,t){var n;const{api_version:s=this._client.apiVersion}=e,o=eo(e,["api_version"]);if("model"in o&&"agent_config"in o)throw new ai("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in o&&"generation_config"in o)throw new ai("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Li`/${s}/interactions`,Object.assign(Object.assign({body:o},t),{stream:null!==(n=e.stream)&&void 0!==n&&n}))}delete(e,t={},n){const{api_version:s=this._client.apiVersion}=null!=t?t:{};return this._client.delete(Li`/${s}/interactions/${e}`,n)}cancel(e,t={},n){const{api_version:s=this._client.apiVersion}=null!=t?t:{};return this._client.post(Li`/${s}/interactions/${e}/cancel`,n)}get(e,t={},n){var s;const o=null!=t?t:{},{api_version:i=this._client.apiVersion}=o,r=eo(o,["api_version"]);return this._client.get(Li`/${i}/interactions/${e}`,Object.assign(Object.assign({query:r},n),{stream:null!==(s=null==t?void 0:t.stream)&&void 0!==s&&s}))}}Gi._key=Object.freeze(["interactions"]);class Fi extends Gi{}let Vi,Hi;function Bi(e){let t;return(null!=Vi?Vi:(t=new globalThis.TextEncoder,Vi=t.encode.bind(t)))(e)}function Ji(e){let t;return(null!=Hi?Hi:(t=new globalThis.TextDecoder,Hi=t.decode.bind(t)))(e)}class $i{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(null==e)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?Bi(e):e;this.buffer=function(e){let t=0;for(const o of e)t+=o.length;const n=new Uint8Array(t);let s=0;for(const o of e)n.set(o,s),s+=o.length;return n}([this.buffer,t]);const n=[];let s;for(;null!=(s=Yi(this.buffer,this.carriageReturnIndex));){if(s.carriage&&null==this.carriageReturnIndex){this.carriageReturnIndex=s.index;continue}if(null!=this.carriageReturnIndex&&(s.index!==this.carriageReturnIndex+1||s.carriage)){n.push(Ji(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const e=null!==this.carriageReturnIndex?s.preceding-1:s.preceding,t=Ji(this.buffer.subarray(0,e));n.push(t),this.buffer=this.buffer.subarray(s.index),this.carriageReturnIndex=null}return n}flush(){return this.buffer.length?this.decode("\n"):[]}}function Yi(e,t){for(let n=null!=t?t:0;n<e.length;n++){if(10===e[n])return{preceding:n,index:n+1,carriage:!1};if(13===e[n])return{preceding:n,index:n+1,carriage:!0}}return null}function zi(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1])return t+2;if(13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return-1}$i.NEWLINE_CHARS=new Set(["\n","\r"]),$i.NEWLINE_REGEXP=/\r\n|[\n\r]/g;const Wi={off:0,error:200,warn:300,info:400,debug:500},Ki=(e,t,n)=>{var s,o;if(e)return s=Wi,o=e,Object.prototype.hasOwnProperty.call(s,o)?e:void tr(n).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(Wi))}`)};function Xi(){}function Qi(e,t,n){return!t||Wi[e]>Wi[n]?Xi:t[e].bind(t)}const Zi={error:Xi,warn:Xi,info:Xi,debug:Xi};let er=new WeakMap;function tr(e){var t;const n=e.logger,s=null!==(t=e.logLevel)&&void 0!==t?t:"off";if(!n)return Zi;const o=er.get(n);if(o&&o[0]===s)return o[1];const i={error:Qi("error",n,s),warn:Qi("warn",n,s),info:Qi("info",n,s),debug:Qi("debug",n,s)};return er.set(n,[s,i]),i}const nr=e=>(e.options&&(e.options=Object.assign({},e.options),delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([e,t])=>[e,"x-goog-api-key"===e.toLowerCase()||"authorization"===e.toLowerCase()||"cookie"===e.toLowerCase()||"set-cookie"===e.toLowerCase()?"***":t]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);class sr{constructor(e,t,n){this.iterator=e,this.controller=t,this.client=n}static fromSSEResponse(e,t,n){let s=!1;const o=n?tr(n):console;return new sr(function(){return no(this,arguments,function*(){var n,i,r,a;if(s)throw new ai("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let l=!1;try{try{for(var c,u=!0,d=so(function(e,t){return no(this,arguments,function*(){var n,s,o,i;if(!e.body){if(t.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new ai("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new ai("Attempted to iterate over a response with no body")}const r=new or,a=new $i,l=Oi(e.body);try{for(var c,u=!0,d=so(function(e){return no(this,arguments,function*(){var t,n,s,o;let i=new Uint8Array;try{for(var r,a=!0,l=so(e);!(t=(r=yield to(l.next())).done);a=!0){o=r.value,a=!1;const e=o;if(null==e)continue;const t=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?Bi(e):e;let n,s=new Uint8Array(i.length+t.length);for(s.set(i),s.set(t,i.length),i=s;-1!==(n=zi(i));)yield yield to(i.slice(0,n)),i=i.slice(n)}}catch(c){n={error:c}}finally{try{a||t||!(s=l.return)||(yield to(s.call(l)))}finally{if(n)throw n.error}}i.length>0&&(yield yield to(i))})}(l));!(n=(c=yield to(d.next())).done);u=!0){i=c.value,u=!1;const e=i;for(const t of a.decode(e)){const e=r.decode(t);e&&(yield yield to(e))}}}catch(p){s={error:p}}finally{try{u||n||!(o=d.return)||(yield to(o.call(d)))}finally{if(s)throw s.error}}for(const e of a.flush()){const t=r.decode(e);t&&(yield yield to(t))}})}(e,t));!(n=(c=yield to(d.next())).done);u=!0){a=c.value,u=!1;const e=a;if(!l)if(e.data.startsWith("[DONE]"))l=!0;else try{yield yield to(JSON.parse(e.data))}catch(p){throw o.error("Could not parse message into JSON:",e.data),o.error("From chunk:",e.raw),p}}}catch(m){i={error:m}}finally{try{u||n||!(r=d.return)||(yield to(r.call(d)))}finally{if(i)throw i.error}}l=!0}catch(p){if(ii(p))return yield to(void 0);throw p}finally{l||t.abort()}})},t,n)}static fromReadableStream(e,t,n){let s=!1;return new sr(function(){return no(this,arguments,function*(){var n,o,i,r;if(s)throw new ai("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let a=!1;try{try{for(var l,c=!0,u=so(function(){return no(this,arguments,function*(){var t,n,s,o;const i=new $i,r=Oi(e);try{for(var a,l=!0,c=so(r);!(t=(a=yield to(c.next())).done);l=!0){o=a.value,l=!1;const e=o;for(const t of i.decode(e))yield yield to(t)}}catch(u){n={error:u}}finally{try{l||t||!(s=c.return)||(yield to(s.call(c)))}finally{if(n)throw n.error}}for(const e of i.flush())yield yield to(e)})}());!(n=(l=yield to(u.next())).done);c=!0){r=l.value,c=!1;const e=r;a||e&&(yield yield to(JSON.parse(e)))}}catch(d){o={error:d}}finally{try{c||n||!(i=u.return)||(yield to(i.call(u)))}finally{if(o)throw o.error}}a=!0}catch(p){if(ii(p))return yield to(void 0);throw p}finally{a||t.abort()}})},t,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),s=s=>({next:()=>{if(0===s.length){const s=n.next();e.push(s),t.push(s)}return s.shift()}});return[new sr(()=>s(e),this.controller,this.client),new sr(()=>s(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return Ti({async start(){t=e[Symbol.asyncIterator]()},async pull(e){try{const{value:n,done:s}=await t.next();if(s)return e.close();const o=Bi(JSON.stringify(n)+"\n");e.enqueue(o)}catch(n){e.error(n)}},async cancel(){var e;await(null===(e=t.return)||void 0===e?void 0:e.call(t))}})}}class or{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,s]=function(e){const t=e.indexOf(":");return-1!==t?[e.substring(0,t),":",e.substring(t+1)]:[e,"",""]}(e);return s.startsWith(" ")&&(s=s.substring(1)),"event"===t?this.event=s:"data"===t&&this.data.push(s),null}}async function ir(e,t){const{response:n,requestLogID:s,retryOfRequestLogID:o,startTime:i}=t,r=await(async()=>{var s;if(t.options.stream)return tr(e).debug("response",n.status,n.url,n.headers,n.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(n,t.controller,e):sr.fromSSEResponse(n,t.controller,e);if(204===n.status)return null;if(t.options.__binaryResponse)return n;const o=n.headers.get("content-type"),i=null===(s=null==o?void 0:o.split(";")[0])||void 0===s?void 0:s.trim();return(null==i?void 0:i.includes("application/json"))||(null==i?void 0:i.endsWith("+json"))?await n.json():await n.text()})();return tr(e).debug(`[${s}] response parsed`,nr({retryOfRequestLogID:o,url:n.url,status:n.status,body:r,durationMs:Date.now()-i})),r}class rr extends Promise{constructor(e,t,n=ir){super(e=>{e(null)}),this.responsePromise=t,this.parseResponse=n,this.client=e}_thenUnwrap(e){return new rr(this.client,this.responsePromise,async(t,n)=>e(await this.parseResponse(t,n),n))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}const ar=Symbol("brand.privateNullableHeaders");function*lr(e){if(!e)return;if(ar in e){const{values:t,nulls:n}=e;yield*t.entries();for(const e of n)yield[e,null];return}let t,n=!1;e instanceof Headers?t=e.entries():_i(e)?t=e:(n=!0,t=Object.entries(null!=e?e:{}));for(let s of t){const e=s[0];if("string"!=typeof e)throw new TypeError("expected header name to be a string");const t=_i(s[1])?s[1]:[s[1]];let o=!1;for(const s of t)void 0!==s&&(n&&!o&&(o=!0,yield[e,null]),yield[e,s])}}const cr=e=>{const t=new Headers,n=new Set;for(const s of e){const e=new Set;for(const[o,i]of lr(s)){const s=o.toLowerCase();e.has(s)||(t.delete(o),e.add(s)),null===i?(t.delete(o),n.add(s)):(t.append(o,i),n.delete(s))}}return{[ar]:!0,values:t,nulls:n}},ur=e=>{var t,n,s,o,i,r;return void 0!==globalThis.process?null!==(s=null===(n=null===(t=Ne)||void 0===t?void 0:t[e])||void 0===n?void 0:n.trim())&&void 0!==s?s:void 0:void 0!==globalThis.Deno?null===(r=null===(i=null===(o=globalThis.Deno.env)||void 0===o?void 0:o.get)||void 0===i?void 0:i.call(o,e))||void 0===r?void 0:r.trim():void 0};var dr;class pr{constructor(e){var t,n,s,o,i,r,a,{baseURL:l=ur("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:c=(null!==(t=ur("GEMINI_API_KEY"))&&void 0!==t?t:null),apiVersion:u="v1beta"}=e,d=eo(e,["baseURL","apiKey","apiVersion"]);const p=Object.assign(Object.assign({apiKey:c,apiVersion:u},d),{baseURL:l||"https://generativelanguage.googleapis.com"});this.baseURL=p.baseURL,this.timeout=null!==(n=p.timeout)&&void 0!==n?n:pr.DEFAULT_TIMEOUT,this.logger=null!==(s=p.logger)&&void 0!==s?s:console;const m="warn";this.logLevel=m,this.logLevel=null!==(i=null!==(o=Ki(p.logLevel,"ClientOptions.logLevel",this))&&void 0!==o?o:Ki(ur("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))&&void 0!==i?i:m,this.fetchOptions=p.fetchOptions,this.maxRetries=null!==(r=p.maxRetries)&&void 0!==r?r:2,this.fetch=null!==(a=p.fetch)&&void 0!==a?a:function(){if("undefined"!=typeof fetch)return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),this.encoder=ji,this._options=p,this.apiKey=c,this.apiVersion=u,this.clientAdapter=p.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return"https://generativelanguage.googleapis.com"!==this.baseURL}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!e.has("authorization")&&!e.has("x-goog-api-key")&&!(this.apiKey&&e.get("x-goog-api-key")||t.has("x-goog-api-key")))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=cr([e.headers]);if(!t.values.has("authorization")&&!t.values.has("x-goog-api-key"))return this.apiKey?cr([{"x-goog-api-key":this.apiKey}]):this.clientAdapter.isVertexAI()?cr([await this.clientAdapter.getAuthHeaders()]):void 0}stringifyQuery(e){return Object.entries(e).filter(([e,t])=>void 0!==t).map(([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new ai(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${wi}`}defaultIdempotencyKey(){return`stainless-node-retry-${oi()}`}makeStatusError(e,t,n,s){return li.generate(e,t,n,s)}buildURL(e,t,n){const s=!this.baseURLOverridden()&&n||this.baseURL,o=(e=>bi.test(e))(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return function(e){if(!e)return!0;for(const t in e)return!1;return!0}(i)||(t=Object.assign(Object.assign({},i),t)),"object"==typeof t&&t&&!Array.isArray(t)&&(o.search=this.stringifyQuery(t)),o.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:n}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(n=>Object.assign({method:e,path:t},n)))}request(e,t=null){return new rr(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){var s,o,i;const r=await e,a=null!==(s=r.maxRetries)&&void 0!==s?s:this.maxRetries;null==t&&(t=a),await this.prepareOptions(r);const{req:l,url:c,timeout:u}=await this.buildRequest(r,{retryCount:a-t});await this.prepareRequest(l,{url:c,options:r});const d="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),p=void 0===n?"":`, retryOf: ${n}`,m=Date.now();if(tr(this).debug(`[${d}] sending request`,nr({retryOfRequestLogID:n,method:r.method,url:c,options:r,headers:l.headers})),null===(o=r.signal)||void 0===o?void 0:o.aborted)throw new ci;const h=new AbortController,f=await this.fetchWithTimeout(c,l,u,h).catch(ri),g=Date.now();if(f instanceof globalThis.Error){const e=`retrying, ${t} attempts remaining`;if(null===(i=r.signal)||void 0===i?void 0:i.aborted)throw new ci;const s=ii(f)||/timed? ?out/i.test(String(f)+("cause"in f?String(f.cause):""));if(t)return tr(this).info(`[${d}] connection ${s?"timed out":"failed"} - ${e}`),tr(this).debug(`[${d}] connection ${s?"timed out":"failed"} (${e})`,nr({retryOfRequestLogID:n,url:c,durationMs:g-m,message:f.message})),this.retryRequest(r,t,null!=n?n:d);if(tr(this).info(`[${d}] connection ${s?"timed out":"failed"} - error; no more retries left`),tr(this).debug(`[${d}] connection ${s?"timed out":"failed"} (error; no more retries left)`,nr({retryOfRequestLogID:n,url:c,durationMs:g-m,message:f.message})),s)throw new di;throw new ui({cause:f})}const v=`[${d}${p}] ${l.method} ${c} ${f.ok?"succeeded":"failed"} with status ${f.status} in ${g-m}ms`;if(!f.ok){const e=await this.shouldRetry(f);if(t&&e){const e=`retrying, ${t} attempts remaining`;return await async function(e){var t,n;if(null===e||"object"!=typeof e)return;if(e[Symbol.asyncIterator])return void(await(null===(n=(t=e[Symbol.asyncIterator]()).return)||void 0===n?void 0:n.call(t)));const s=e.getReader(),o=s.cancel();s.releaseLock(),await o}(f.body),tr(this).info(`${v} - ${e}`),tr(this).debug(`[${d}] response error (${e})`,nr({retryOfRequestLogID:n,url:f.url,status:f.status,headers:f.headers,durationMs:g-m})),this.retryRequest(r,t,null!=n?n:d,f.headers)}const s=e?"error; no more retries left":"error; not retryable";tr(this).info(`${v} - ${s}`);const o=await f.text().catch(e=>ri(e).message),i=(e=>{try{return JSON.parse(e)}catch(t){return}})(o),a=i?void 0:o;throw tr(this).debug(`[${d}] response error (${s})`,nr({retryOfRequestLogID:n,url:f.url,status:f.status,headers:f.headers,message:a,durationMs:Date.now()-m})),this.makeStatusError(f.status,i,a,f.headers)}return tr(this).info(v),tr(this).debug(`[${d}] response start`,nr({retryOfRequestLogID:n,url:f.url,status:f.status,headers:f.headers,durationMs:g-m})),{response:f,options:r,controller:h,requestLogID:d,retryOfRequestLogID:n,startTime:m}}async fetchWithTimeout(e,t,n,s){const o=t||{},{signal:i,method:r}=o,a=eo(o,["signal","method"]);i&&i.addEventListener("abort",()=>s.abort());const l=setTimeout(()=>s.abort(),n),c=globalThis.ReadableStream&&a.body instanceof globalThis.ReadableStream||"object"==typeof a.body&&null!==a.body&&Symbol.asyncIterator in a.body,u=Object.assign(Object.assign(Object.assign({signal:s.signal},c?{duplex:"half"}:{}),{method:"GET"}),a);r&&(u.method=r.toUpperCase());try{return await this.fetch.call(void 0,e,u)}finally{clearTimeout(l)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||e.status>=500)}async retryRequest(e,t,n,s){var o;let i;const r=null==s?void 0:s.get("retry-after-ms");if(r){const e=parseFloat(r);Number.isNaN(e)||(i=e)}const a=null==s?void 0:s.get("retry-after");if(a&&!i){const e=parseFloat(a);i=Number.isNaN(e)?Date.parse(a)-Date.now():1e3*e}if(!(i&&0<=i&&i<6e4)){const n=null!==(o=e.maxRetries)&&void 0!==o?o:this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(t,n)}var l;return await(l=i,new Promise(e=>setTimeout(e,l))),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){const n=t-e;return Math.min(.5*Math.pow(2,n),8)*(1-.25*Math.random())*1e3}async buildRequest(e,{retryCount:t=0}={}){var n,s,o;const i=Object.assign({},e),{method:r,path:a,query:l,defaultBaseURL:c}=i,u=this.buildURL(a,l,c);"timeout"in i&&((e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new ai(`${e} must be an integer`);if(t<0)throw new ai(`${e} must be a positive integer`)})("timeout",i.timeout),i.timeout=null!==(n=i.timeout)&&void 0!==n?n:this.timeout;const{bodyHeaders:d,body:p}=this.buildBody({options:i}),m=await this.buildHeaders({options:e,method:r,bodyHeaders:d,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:r,headers:m},i.signal&&{signal:i.signal}),globalThis.ReadableStream&&p instanceof globalThis.ReadableStream&&{duplex:"half"}),p&&{body:p}),null!==(s=this.fetchOptions)&&void 0!==s?s:{}),null!==(o=i.fetchOptions)&&void 0!==o?o:{}),url:u,timeout:i.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:n,retryCount:s}){let o={};this.idempotencyHeader&&"get"!==t&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const i=await this.authHeaders(e);let r=cr([o,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),null!=Ai?Ai:Ai=Ni()),this._options.defaultHeaders,n,e.headers,i]);return this.validateHeaders(r),r.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const n=cr([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||"string"==typeof e&&n.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:"object"==typeof e&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&"function"==typeof e.next)?{bodyHeaders:void 0,body:Ci(e)}:this.encoder({body:e,headers:n})}}pr.DEFAULT_TIMEOUT=6e4;class mr extends pr{constructor(){super(...arguments),this.interactions=new Fi(this)}}function hr(e,t){const n={},s=Te(e,["sdkHttpResponse"]);null!=s&&Ae(n,["sdkHttpResponse"],s);const o=Te(e,["name"]);null!=o&&Ae(n,["name"],o);const i=Te(e,["state"]);null!=i&&Ae(n,["state"],Ds(i));const r=Te(e,["createTime"]);null!=r&&Ae(n,["createTime"],r);const a=Te(e,["tuningTask","startTime"]);null!=a&&Ae(n,["startTime"],a);const l=Te(e,["tuningTask","completeTime"]);null!=l&&Ae(n,["endTime"],l);const c=Te(e,["updateTime"]);null!=c&&Ae(n,["updateTime"],c);const u=Te(e,["description"]);null!=u&&Ae(n,["description"],u);const d=Te(e,["baseModel"]);null!=d&&Ae(n,["baseModel"],d);const p=Te(e,["_self"]);return null!=p&&Ae(n,["tunedModel"],function(e){const t={},n=Te(e,["name"]);null!=n&&Ae(t,["model"],n);const s=Te(e,["name"]);return null!=s&&Ae(t,["endpoint"],s),t}(p)),n}function fr(e,t){const n={},s=Te(e,["sdkHttpResponse"]);null!=s&&Ae(n,["sdkHttpResponse"],s);const o=Te(e,["name"]);null!=o&&Ae(n,["name"],o);const i=Te(e,["state"]);null!=i&&Ae(n,["state"],Ds(i));const r=Te(e,["createTime"]);null!=r&&Ae(n,["createTime"],r);const a=Te(e,["startTime"]);null!=a&&Ae(n,["startTime"],a);const l=Te(e,["endTime"]);null!=l&&Ae(n,["endTime"],l);const c=Te(e,["updateTime"]);null!=c&&Ae(n,["updateTime"],c);const u=Te(e,["error"]);null!=u&&Ae(n,["error"],u);const d=Te(e,["description"]);null!=d&&Ae(n,["description"],d);const p=Te(e,["baseModel"]);null!=p&&Ae(n,["baseModel"],p);const m=Te(e,["tunedModel"]);null!=m&&Ae(n,["tunedModel"],m);const h=Te(e,["preTunedModel"]);null!=h&&Ae(n,["preTunedModel"],h);const f=Te(e,["supervisedTuningSpec"]);null!=f&&Ae(n,["supervisedTuningSpec"],f);const g=Te(e,["preferenceOptimizationSpec"]);null!=g&&Ae(n,["preferenceOptimizationSpec"],g);const v=Te(e,["tuningDataStats"]);null!=v&&Ae(n,["tuningDataStats"],v);const x=Te(e,["encryptionSpec"]);null!=x&&Ae(n,["encryptionSpec"],x);const y=Te(e,["partnerModelTuningSpec"]);null!=y&&Ae(n,["partnerModelTuningSpec"],y);const b=Te(e,["customBaseModel"]);null!=b&&Ae(n,["customBaseModel"],b);const E=Te(e,["experiment"]);null!=E&&Ae(n,["experiment"],E);const _=Te(e,["labels"]);null!=_&&Ae(n,["labels"],_);const w=Te(e,["outputUri"]);null!=w&&Ae(n,["outputUri"],w);const N=Te(e,["pipelineJob"]);null!=N&&Ae(n,["pipelineJob"],N);const S=Te(e,["serviceAccount"]);null!=S&&Ae(n,["serviceAccount"],S);const I=Te(e,["tunedModelDisplayName"]);null!=I&&Ae(n,["tunedModelDisplayName"],I);const A=Te(e,["veoTuningSpec"]);return null!=A&&Ae(n,["veoTuningSpec"],A),n}function gr(e,t){const n={},s=Te(e,["gcsUri"]);null!=s&&Ae(n,["validationDatasetUri"],s);const o=Te(e,["vertexDatasetResource"]);return null!=o&&Ae(n,["validationDatasetUri"],o),n}dr=mr,mr.GeminiNextGenAPIClient=dr,mr.GeminiNextGenAPIClientError=ai,mr.APIError=li,mr.APIConnectionError=ui,mr.APIConnectionTimeoutError=di,mr.APIUserAbortError=ci,mr.NotFoundError=fi,mr.ConflictError=gi,mr.RateLimitError=xi,mr.BadRequestError=pi,mr.AuthenticationError=mi,mr.InternalServerError=yi,mr.PermissionDeniedError=hi,mr.UnprocessableEntityError=vi,mr.toFile=async function(e,t,n){if(Ri(),(e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&Di(e))(e=await e))return e instanceof File?e:Pi([await e.arrayBuffer()],e.name);if((e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob)(e)){const s=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),Pi(await Mi(s),t,n)}const s=await Mi(e);if(t||(t=function(e){return("object"==typeof e&&null!==e&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}(e)),!(null==n?void 0:n.type)){const e=s.find(e=>"object"==typeof e&&"type"in e&&e.type);"string"==typeof e&&(n=Object.assign(Object.assign({},n),{type:e}))}return Pi(s,t,n)},mr.Interactions=Fi;class vr extends Se{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new Ks(kn.PAGED_ITEM_TUNING_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.get=async e=>await this.getInternal(e),this.tune=async e=>{var t;if(this.apiClient.isVertexAI()){if(e.baseModel.startsWith("projects/")){const n={tunedModelName:e.baseModel};(null===(t=e.config)||void 0===t?void 0:t.preTunedModelCheckpointId)&&(n.checkpointId=e.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},e),{preTunedModel:n});return s.baseModel=void 0,await this.tuneInternal(s)}{const t=Object.assign({},e);return await this.tuneInternal(t)}}{const t=Object.assign({},e),n=await this.tuneMldevInternal(t);let s="";return void 0!==n.metadata&&void 0!==n.metadata.tunedModel?s=n.metadata.tunedModel:void 0!==n.name&&n.name.includes("/operations/")&&(s=n.name.split("/operations/")[0]),{name:s,state:Nt.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e){const t={},n=Te(e,["name"]);return null!=n&&Ae(t,["_url","name"],n),t}(e);return r=Ie("{name}",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>fr(e))}{const t=function(e){const t={},n=Te(e,["name"]);return null!=n&&Ae(t,["_url","name"],n),t}(e);return r=Ie("{name}",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>hr(e))}}async listInternal(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e){const t={},n=Te(e,["config"]);return null!=n&&function(e,t){const n=Te(e,["pageSize"]);void 0!==t&&null!=n&&Ae(t,["_query","pageSize"],n);const s=Te(e,["pageToken"]);void 0!==t&&null!=s&&Ae(t,["_query","pageToken"],s);const o=Te(e,["filter"]);void 0!==t&&null!=o&&Ae(t,["_query","filter"],o)}(n,t),t}(e);return r=Ie("tuningJobs",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["nextPageToken"]);null!=s&&Ae(t,["nextPageToken"],s);const o=Te(e,["tuningJobs"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>fr(e))),Ae(t,["tuningJobs"],e)}return t}(e),n=new Qn;return Object.assign(n,t),n})}{const t=function(e){const t={},n=Te(e,["config"]);return null!=n&&function(e,t){const n=Te(e,["pageSize"]);void 0!==t&&null!=n&&Ae(t,["_query","pageSize"],n);const s=Te(e,["pageToken"]);void 0!==t&&null!=s&&Ae(t,["_query","pageToken"],s);const o=Te(e,["filter"]);void 0!==t&&null!=o&&Ae(t,["_query","filter"],o)}(n,t),t}(e);return r=Ie("tunedModels",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["nextPageToken"]);null!=s&&Ae(t,["nextPageToken"],s);const o=Te(e,["tunedModels"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>hr(e))),Ae(t,["tuningJobs"],e)}return t}(e),n=new Qn;return Object.assign(n,t),n})}}async cancel(e){var t,n,s,o;let i,r="",a={};if(this.apiClient.isVertexAI()){const s=function(e){const t={},n=Te(e,["name"]);return null!=n&&Ae(t,["_url","name"],n),t}(e);return r=Ie("{name}:cancel",s._url),a=s._query,delete s._url,delete s._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);return null!=n&&Ae(t,["sdkHttpResponse"],n),t}(e),n=new Zn;return Object.assign(n,t),n})}{const t=function(e){const t={},n=Te(e,["name"]);return null!=n&&Ae(t,["_url","name"],n),t}(e);return r=Ie("{name}:cancel",t._url),a=t._query,delete t._url,delete t._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(s=e.config)||void 0===s?void 0:s.httpOptions,abortSignal:null===(o=e.config)||void 0===o?void 0:o.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),i.then(e=>{const t=function(e){const t={},n=Te(e,["sdkHttpResponse"]);return null!=n&&Ae(t,["sdkHttpResponse"],n),t}(e),n=new Zn;return Object.assign(n,t),n})}}async tuneInternal(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},s=Te(e,["baseModel"]);null!=s&&Ae(n,["baseModel"],s);const o=Te(e,["preTunedModel"]);null!=o&&Ae(n,["preTunedModel"],o);const i=Te(e,["trainingDataset"]);null!=i&&function(e,t,n){let s=Te(n,["config","method"]);if(void 0===s&&(s="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===s){const n=Te(e,["gcsUri"]);void 0!==t&&null!=n&&Ae(t,["supervisedTuningSpec","trainingDatasetUri"],n)}else if("PREFERENCE_TUNING"===s){const n=Te(e,["gcsUri"]);void 0!==t&&null!=n&&Ae(t,["preferenceOptimizationSpec","trainingDatasetUri"],n)}let o=Te(n,["config","method"]);if(void 0===o&&(o="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===o){const n=Te(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&Ae(t,["supervisedTuningSpec","trainingDatasetUri"],n)}else if("PREFERENCE_TUNING"===o){const n=Te(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&Ae(t,["preferenceOptimizationSpec","trainingDatasetUri"],n)}if(void 0!==Te(e,["examples"]))throw new Error("examples parameter is not supported in Vertex AI.")}(i,n,t);const r=Te(e,["config"]);return null!=r&&function(e,t,n){let s=Te(n,["config","method"]);if(void 0===s&&(s="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===s){const n=Te(e,["validationDataset"]);void 0!==t&&null!=n&&Ae(t,["supervisedTuningSpec"],gr(n))}else if("PREFERENCE_TUNING"===s){const n=Te(e,["validationDataset"]);void 0!==t&&null!=n&&Ae(t,["preferenceOptimizationSpec"],gr(n))}const o=Te(e,["tunedModelDisplayName"]);void 0!==t&&null!=o&&Ae(t,["tunedModelDisplayName"],o);const i=Te(e,["description"]);void 0!==t&&null!=i&&Ae(t,["description"],i);let r=Te(n,["config","method"]);if(void 0===r&&(r="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===r){const n=Te(e,["epochCount"]);void 0!==t&&null!=n&&Ae(t,["supervisedTuningSpec","hyperParameters","epochCount"],n)}else if("PREFERENCE_TUNING"===r){const n=Te(e,["epochCount"]);void 0!==t&&null!=n&&Ae(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],n)}let a=Te(n,["config","method"]);if(void 0===a&&(a="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===a){const n=Te(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&Ae(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],n)}else if("PREFERENCE_TUNING"===a){const n=Te(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&Ae(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],n)}let l=Te(n,["config","method"]);if(void 0===l&&(l="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===l){const n=Te(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&Ae(t,["supervisedTuningSpec","exportLastCheckpointOnly"],n)}else if("PREFERENCE_TUNING"===l){const n=Te(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&Ae(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],n)}let c=Te(n,["config","method"]);if(void 0===c&&(c="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===c){const n=Te(e,["adapterSize"]);void 0!==t&&null!=n&&Ae(t,["supervisedTuningSpec","hyperParameters","adapterSize"],n)}else if("PREFERENCE_TUNING"===c){const n=Te(e,["adapterSize"]);void 0!==t&&null!=n&&Ae(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],n)}if(void 0!==Te(e,["batchSize"]))throw new Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==Te(e,["learningRate"]))throw new Error("learningRate parameter is not supported in Vertex AI.");const u=Te(e,["labels"]);void 0!==t&&null!=u&&Ae(t,["labels"],u);const d=Te(e,["beta"]);void 0!==t&&null!=d&&Ae(t,["preferenceOptimizationSpec","hyperParameters","beta"],d)}(r,n,t),n}(e,e);return o=Ie("tuningJobs",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>fr(e))}throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=Te(e,["baseModel"]);null!=n&&Ae(t,["baseModel"],n);const s=Te(e,["preTunedModel"]);null!=s&&Ae(t,["preTunedModel"],s);const o=Te(e,["trainingDataset"]);null!=o&&function(e){const t={};if(void 0!==Te(e,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==Te(e,["vertexDatasetResource"]))throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=Te(e,["examples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),Ae(t,["examples","examples"],e)}}(o);const i=Te(e,["config"]);return null!=i&&function(e,t){if(void 0!==Te(e,["validationDataset"]))throw new Error("validationDataset parameter is not supported in Gemini API.");const n=Te(e,["tunedModelDisplayName"]);if(void 0!==t&&null!=n&&Ae(t,["displayName"],n),void 0!==Te(e,["description"]))throw new Error("description parameter is not supported in Gemini API.");const s=Te(e,["epochCount"]);void 0!==t&&null!=s&&Ae(t,["tuningTask","hyperparameters","epochCount"],s);const o=Te(e,["learningRateMultiplier"]);if(null!=o&&Ae({},["tuningTask","hyperparameters","learningRateMultiplier"],o),void 0!==Te(e,["exportLastCheckpointOnly"]))throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==Te(e,["preTunedModelCheckpointId"]))throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==Te(e,["adapterSize"]))throw new Error("adapterSize parameter is not supported in Gemini API.");const i=Te(e,["batchSize"]);void 0!==t&&null!=i&&Ae(t,["tuningTask","hyperparameters","batchSize"],i);const r=Te(e,["learningRate"]);if(void 0!==t&&null!=r&&Ae(t,["tuningTask","hyperparameters","learningRate"],r),void 0!==Te(e,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");if(void 0!==Te(e,["beta"]))throw new Error("beta parameter is not supported in Gemini API.")}(i,t),t}(e);return o=Ie("tunedModels",r._url),i=r._query,delete r._url,delete r._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>function(e){const t={},n=Te(e,["sdkHttpResponse"]);null!=n&&Ae(t,["sdkHttpResponse"],n);const s=Te(e,["name"]);null!=s&&Ae(t,["name"],s);const o=Te(e,["metadata"]);null!=o&&Ae(t,["metadata"],o);const i=Te(e,["done"]);null!=i&&Ae(t,["done"],i);const r=Te(e,["error"]);return null!=r&&Ae(t,["error"],r),t}(e))}}}class xr{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const yr="x-goog-upload-status";async function br(e,t,n){var s,o;let i=0,r=0,a=new Ln(new Response),l="upload";for(i=e.size;r<i;){const c=Math.min(8388608,i-r),u=e.slice(r,r+c);r+c>=i&&(l+=", finalize");let d=0,p=1e3;for(;d<3&&(a=await n.request({path:"",body:u,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(r),"Content-Length":String(c)}}}),!(null===(s=null==a?void 0:a.headers)||void 0===s?void 0:s[yr]));)d++,await Er(p),p*=2;if(r+=c,"active"!==(null===(o=null==a?void 0:a.headers)||void 0===o?void 0:o[yr]))break;if(i<=r)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}function Er(e){return new Promise(t=>setTimeout(t,e))}class _r{async upload(e,t,n){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e,t,n){var s;const o=await br(e,t,n),i=await(null==o?void 0:o.json());if("final"!==(null===(s=null==o?void 0:o.headers)||void 0===s?void 0:s[yr]))throw new Error("Failed to upload file: Upload status is not finalized.");return i.file}(e,t,n)}async uploadToFileSearchStore(e,t,n){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e,t,n){var s;const o=await br(e,t,n),i=await(null==o?void 0:o.json());if("final"!==(null===(s=null==o?void 0:o.headers)||void 0===s?void 0:s[yr]))throw new Error("Failed to upload file: Upload status is not finalized.");const r=je(i),a=new ps;return Object.assign(a,r),a}(e,t,n)}async stat(e){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e){return{size:e.size,type:e.type}}(e)}}class wr{create(e,t,n){return new Nr(e,t,n)}}class Nr{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.close()}}const Sr="x-goog-api-key";class Ir{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(null===e.get(Sr)){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Sr,this.apiKey)}}}const Ar=new class{get interactions(){if(void 0!==this._interactions)return this._interactions;const e=this.httpOptions;null==e||e.extraBody;const t=new mr({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:null==e?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(null==e.apiKey)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!==(t=e.vertexai)&&void 0!==t&&t,this.apiKey=e.apiKey;const n=function(e,t,n,s){var o,i;if(!(null==e?void 0:e.baseUrl)){const e={geminiUrl:void 0,vertexUrl:void 0};return t?null!==(o=e.vertexUrl)&&void 0!==o?o:n:null!==(i=e.geminiUrl)&&void 0!==i?i:s}return e.baseUrl}(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const s=new Ir(this.apiKey);this.apiClient=new Uo({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:"gl-node/web",uploader:new _r,downloader:new xr}),this.models=new Qo(this.apiClient),this.live=new Jo(this.apiClient,s,new wr),this.batches=new Xs(this.apiClient),this.chats=new ao(this.models,this.apiClient),this.caches=new Zs(this.apiClient),this.files=new uo(this.apiClient),this.operations=new Zo(this.apiClient),this.authTokens=new ti(this.apiClient),this.tunings=new vr(this.apiClient),this.fileSearchStores=new si(this.apiClient)}}({apiKey:"AIzaSyChmfD_IxQdY9ZyjcdtMD0Rk5KEARUQ-aQ"}),Tr=({user:e,isOpen:t,onToggle:n})=>{const[o,i]=s.useState(!1),r=s.useRef(null),l=void 0!==t?t:o,c=()=>{n?n():i(!o)},u=!!(e&&e.purchasedProductIds.length>0),d=u?"Bonjour, vous êtes en contact avec l’assistance SerrureMaster.\n\nJe suis là pour vous orienter dans l'utilisation de vos guides.\nPour rappel, je ne peux pas fournir d'instructions techniques détaillées ici.\n\nComment puis-je vous aider ?":"Bonjour, vous êtes en contact avec l’assistance SerrureMaster.\n\nNous proposons un accompagnement pédagogique à distance pour certaines situations de serrurerie compatibles.\n\nJe vais vous poser quelques questions pour vérifier votre situation.\n\nLa porte est-elle simplement claquée ou fermée à clé ?",[p,m]=s.useState([{role:"model",text:d,timestamp:Date.now()}]);s.useEffect(()=>{m([{role:"model",text:d,timestamp:Date.now()}])},[u]);const[h,f]=s.useState(""),[g,v]=s.useState(!1);s.useEffect(()=>{requestAnimationFrame(()=>{var e;null==(e=r.current)||e.scrollIntoView({behavior:"smooth",block:"end"})})},[p,l,g]);const x=async()=>{if(!h.trim()||g)return;const e={role:"user",text:h,timestamp:Date.now()};m(t=>[...t,e]),f(""),v(!0);const t=p.map(e=>({role:e.role,parts:[{text:e.text}]})),n=await(async(e,t,n=!1)=>{try{let s="";s=n?"\n            CONTEXTE : L'utilisateur est CLIENT (a déjà acheté).\n            TON RÔLE : Assistant Technique SerrureMaster (Support Post-Achat).\n            \n            RÈGLES STRICTES :\n            1. NE JAMAIS donner d'instructions techniques détaillées ou de méthode complète dans le chat.\n            2. Pour toute question technique, renvoyer vers les guides PDF/Vidéo de l'espace membre.\n            3. Si l'utilisateur est bloqué, lui proposer d'envoyer une photo via WhatsApp (le vrai) pour validation visuelle.\n            4. Rappeler que le service est une obligation de moyens, pas de résultat.\n            \n            MESSAGE TYPE DE CADRAGE :\n            \"L’assistance par chat ne remplace pas le guide complet et ne permet pas de transmettre des instructions techniques détaillées. Merci de vous référer à la vidéo du Module concerné.\"\n        ":'\n            CONTEXTE : L\'utilisateur est VISITEUR (Prospection).\n            TON RÔLE : Assistant Technique SerrureMaster (Filtrage & Orientation).\n            OBJECTIF : Qualifier la situation pour vérifier la compatibilité avec nos guides payants.\n\n            TON ATTENDU :\n            - Professionnel, neutre, calme.\n            - Messages courts (style WhatsApp).\n            - Zéro jargon technique.\n            - Zéro promesse de réussite.\n            - Zéro détail technique exploitable (le "comment faire" est vendu, pas donné).\n\n            SCRIPT DE CONVERSATION OBLIGATOIRE :\n\n            PHASE 1 : QUALIFICATION (Si l\'info n\'est pas déjà donnée)\n            Poser ces questions une par une ou groupées si pertinent :\n            - "La porte est-elle simplement claquée ou fermée à clé ?"\n            - "Êtes-vous le propriétaire ou avez-vous un droit d’accès légitime au logement ?"\n            - "S\'agit-il d\'une porte standard ou blindée ?"\n\n            PHASE 2 : ANALYSE & ORIENTATION (Logique stricte)\n\n            CAS A : Porte Verrouillée (Fermée à clé) OU Pas de droit d\'accès OU Situation dangereuse\n            -> RÈGLE ABSOLUE : Si l\'utilisateur mentionne "fermée à clé", "clé tournée", "verrouillée" ou "clé à l\'intérieur et verrouillée"\n            -> RÉPONSE TYPE OBLIGATOIRE (mot pour mot) :\n            "Merci pour votre précision.\n\nDans ce cas, lorsque la porte est fermée à clé, nos plans d\'action pédagogiques à distance ne sont pas adaptés.\n\nPour éviter tout risque de dommage ou de situation illégale, nous vous recommandons de faire appel à un professionnel sur place.\n\nSerrureMaster intervient uniquement sur des situations compatibles (porte claquée non verrouillée).\n\nSi vous avez une autre situation ou une question générale, je reste à votre disposition."\n\n            CAS B : Porte Claquée + Droit d\'accès confirmé\n            -> RÉPONSE TYPE (Orientation Vente) :\n            "D’après les éléments fournis, un plan d’action peut être adapté à votre situation. Les étapes complètes sont disponibles dans l’espace membre après validation de la commande."\n            (Si l\'utilisateur insiste pour avoir la technique : "L’assistance ne remplace pas un guide complet. Si vous souhaitez accéder au plan d’action, vous pouvez le retrouver directement sur le site.")\n\n            RÈGLE D\'OR : En cas de doute, recommander de ne pas agir.\n        ';let o=`\n      Tu es l'Assistant Technique SerrureMaster sur WhatsApp.\n      ${s}\n      \n      RÈGLES GLOBALES :\n      - Ne sors JAMAIS de ton rôle.\n      - Ne donne JAMAIS la solution technique (ex: "utilisez une radio", "percez ici"). C'est le produit vendu.\n      - Reste courtois mais ferme sur le cadre légal.\n    \n\nHistorique de conversation:\n`;return e.forEach(e=>{o+=`${"user"===e.role?"Utilisateur":"SerrureMaster"}: ${e.parts[0].text}\n`}),o+=`Utilisateur: ${t}\nSerrureMaster:`,(await Ar.models.generateContent({model:"gemini-3-flash-preview",contents:o})).text||"Je ne suis pas sûr de comprendre. Pouvez-vous préciser votre situation ?"}catch(s){return"Une erreur technique est survenue. Merci de réessayer plus tard."}})(t,e.text,u),s={role:"model",text:n,timestamp:Date.now()};m(e=>[...e,s]),v(!1)};return se.jsxs(se.Fragment,{children:[!l&&se.jsxs("button",{onClick:c,className:"fixed bottom-6 right-6 bg-green-600 hover:bg-green-700 text-white p-3 sm:p-4 rounded-full shadow-2xl hover:shadow-green-500/40 transition-all duration-300 z-50 flex items-center justify-center animate-bounce-subtle group",children:[se.jsx(b,{className:"h-5 w-5 sm:h-6 sm:w-6 group-hover:scale-110 transition-transform"}),se.jsx("span",{className:"ml-2 font-semibold text-xs sm:text-sm hidden sm:inline",children:"Support"})]}),l&&se.jsxs("div",{className:"fixed bottom-6 right-6 w-[calc(100%-3rem)] sm:w-96 h-[550px] max-h-[80vh] bg-white rounded-2xl shadow-2xl z-50 flex flex-col overflow-hidden border border-slate-200 animate-slideUp origin-bottom-right",children:[se.jsxs("div",{className:"bg-slate-900 p-4 flex justify-between items-center text-white shadow-md",children:[se.jsxs("div",{className:"flex items-center",children:[se.jsx("div",{className:"bg-white/10 p-1.5 rounded-full mr-3 border border-white/20 backdrop-blur-sm",children:se.jsx("img",{src:me,alt:"Bot",className:"h-6 w-6 object-contain",onError:e=>{e.currentTarget.style.display="none"}})}),se.jsxs("div",{children:[se.jsxs("h3",{className:"font-bold text-sm",children:["Support ",se.jsx("span",{className:"hidden sm:inline",children:"SerrureMaster"})]}),se.jsxs("div",{className:"flex items-center",children:[se.jsx("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mr-1.5 animate-pulse"}),se.jsx("p",{className:"text-xs text-slate-300",children:"En ligne"})]})]})]}),se.jsx("button",{onClick:c,className:"bg-white/10 p-1.5 rounded-full hover:bg-white/20 transition text-slate-300 hover:text-white",children:se.jsx(a,{className:"h-4 w-4"})})]}),se.jsxs("div",{className:"flex-1 overflow-y-auto p-4 bg-[#e5ddd5] space-y-4 scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-transparent bg-opacity-30",children:[se.jsx("div",{className:"absolute inset-0 opacity-5 pointer-events-none",style:{backgroundImage:'url("https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png")',backgroundSize:"400px"}}),p.map((e,t)=>se.jsxs("div",{className:`flex ${"user"===e.role?"justify-end":"justify-start"} relative z-10`,children:["model"===e.role&&se.jsx("div",{className:"w-6 h-6 rounded-full bg-slate-200 flex-shrink-0 mr-2 mt-auto flex items-center justify-center border border-slate-300",children:se.jsx(I,{className:"w-3 h-3 text-slate-600"})}),se.jsxs("div",{className:"max-w-[80%] p-3.5 rounded-2xl text-sm leading-relaxed whitespace-pre-line shadow-sm "+("user"===e.role?"bg-[#dcf8c6] text-slate-900 rounded-br-sm border border-green-200":"bg-white border border-slate-100 text-slate-800 rounded-bl-sm"),children:[e.text,se.jsx("div",{className:"text-[9px] text-right mt-1 "+("user"===e.role?"text-green-800/60":"text-slate-400"),children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]},t)),g&&se.jsxs("div",{className:"flex justify-start relative z-10",children:[se.jsx("div",{className:"w-6 h-6 rounded-full bg-slate-200 flex-shrink-0 mr-2 mt-auto flex items-center justify-center",children:se.jsx(I,{className:"w-3 h-3 text-slate-600"})}),se.jsxs("div",{className:"bg-white border border-slate-100 p-4 rounded-2xl rounded-bl-sm flex items-center space-x-1.5 shadow-sm",children:[se.jsx("div",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),se.jsx("div",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),se.jsx("div",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]}),se.jsx("div",{ref:r})]}),se.jsx("div",{className:"p-3 bg-[#f0f2f5] border-t border-slate-200",children:se.jsxs("div",{className:"flex items-center bg-white rounded-full px-1 py-1 border border-transparent focus-within:border-green-300 focus-within:ring-2 focus-within:ring-green-100 transition-all shadow-sm",children:[se.jsx("label",{htmlFor:"chatbot-input",className:"sr-only",children:"Écrivez votre message"}),se.jsx("input",{id:"chatbot-input",type:"text",value:h,onChange:e=>f(e.target.value),onKeyDown:e=>{"Enter"===e.key&&x()},placeholder:"Écrivez un message...",className:"flex-1 bg-transparent border-none outline-none text-sm text-slate-800 placeholder-slate-500 px-4 py-2",autoFocus:!0}),se.jsx("button",{onClick:x,disabled:g||!h.trim(),"aria-label":"Envoyer le message",className:"p-2 rounded-full transition-all duration-200 "+(h.trim()?"bg-green-600 text-white shadow-md hover:scale-105 active:scale-95":"bg-slate-200 text-slate-400 cursor-not-allowed"),children:g?se.jsx(A,{className:"h-4 w-4 animate-spin"}):se.jsx(T,{className:"h-4 w-4"})})]})})]})]})},Cr=({onAcceptAll:e,onRefuseAll:t,onSavePreferences:n,onLearnMore:o})=>{const[i,r]=s.useState(!1),[a,c]=s.useState({necessary:!0,analytics:!1,marketing:!1}),u=e=>{"necessary"!==e&&c(t=>({...t,[e]:!t[e]}))};return se.jsxs("div",{className:"fixed bottom-0 left-0 right-0 z-[100] bg-slate-900 border-t border-slate-800 shadow-[0_-10px_40px_-10px_rgba(0,0,0,0.5)] animate-[slideUp_0.5s_ease-out]",children:[se.jsxs("div",{className:"max-w-7xl mx-auto p-4 md:p-6",children:[se.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start md:items-center justify-between mb-4",children:[se.jsxs("div",{className:"flex items-start gap-4",children:[se.jsx("div",{className:"bg-slate-800 p-3 rounded-xl flex-shrink-0 border border-slate-700 hidden sm:block",children:se.jsx(l,{className:"w-8 h-8 text-orange-500"})}),se.jsxs("div",{children:[se.jsx("h3",{className:"text-white font-bold text-lg mb-1",children:"Votre vie privée nous appartient... non, on rigole."}),se.jsx("p",{className:"text-slate-300 text-sm leading-relaxed max-w-3xl",children:"Conformément au RGPD, vous avez le choix. Nous utilisons des cookies pour sécuriser votre espace membre (essentiels) et, si vous l'acceptez, pour améliorer nos guides (analytiques)."})]})]}),se.jsxs("div",{className:"hidden lg:flex gap-3 flex-shrink-0",children:[se.jsx("button",{onClick:()=>r(!i),className:"px-4 py-2.5 text-slate-300 font-medium hover:text-white underline decoration-slate-600 hover:decoration-white transition text-sm",children:"Personnaliser"}),se.jsx("button",{onClick:t,className:"px-6 py-2.5 bg-slate-800 text-white font-semibold rounded-lg hover:bg-slate-700 border border-slate-700 transition text-sm",children:"Tout refuser"}),se.jsx("button",{onClick:e,className:"px-6 py-2.5 bg-orange-600 text-white font-bold rounded-lg hover:bg-orange-500 shadow-lg hover:shadow-orange-500/25 transition text-sm",children:"Tout accepter"})]})]}),i&&se.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-6 border border-slate-700 mb-6 animate-fade-in",children:[se.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[se.jsxs("div",{className:"flex items-start gap-3 opacity-70 cursor-not-allowed",title:"Obligatoire",children:[se.jsx("div",{className:"mt-1",children:se.jsx("div",{className:"w-5 h-5 bg-orange-500 rounded flex items-center justify-center",children:se.jsx(C,{className:"w-3 h-3 text-white"})})}),se.jsxs("div",{children:[se.jsx("h4",{className:"text-white font-bold text-sm",children:"Essentiels (Obligatoire)"}),se.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Nécessaires pour l'espace membre, le panier et la sécurité des paiements."})]})]}),se.jsxs("div",{className:"flex items-start gap-3 cursor-pointer group",onClick:()=>u("analytics"),children:[se.jsx("div",{className:"mt-1 relative",children:se.jsx("div",{className:"w-5 h-5 rounded border flex items-center justify-center transition-colors "+(a.analytics?"bg-orange-500 border-orange-500":"bg-slate-900 border-slate-600"),children:a.analytics&&se.jsx(C,{className:"w-3 h-3 text-white"})})}),se.jsxs("div",{children:[se.jsx("h4",{className:"text-white font-bold text-sm group-hover:text-orange-400 transition",children:"Analytique & Performance"}),se.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Nous aide à comprendre quelles vidéos sont les plus regardées pour les améliorer."})]})]}),se.jsxs("div",{className:"flex items-start gap-3 cursor-pointer group",onClick:()=>u("marketing"),children:[se.jsx("div",{className:"mt-1 relative",children:se.jsx("div",{className:"w-5 h-5 rounded border flex items-center justify-center transition-colors "+(a.marketing?"bg-orange-500 border-orange-500":"bg-slate-900 border-slate-600"),children:a.marketing&&se.jsx(C,{className:"w-3 h-3 text-white"})})}),se.jsxs("div",{children:[se.jsx("h4",{className:"text-white font-bold text-sm group-hover:text-orange-400 transition",children:"Publicité Ciblée"}),se.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Permet de vous proposer des offres pertinentes (nous en utilisons très peu)."})]})]})]}),se.jsx("div",{className:"mt-6 flex justify-end pt-4 border-t border-slate-700",children:se.jsx("button",{onClick:()=>{n(a)},className:"px-6 py-2 bg-white text-slate-900 font-bold rounded-lg hover:bg-slate-200 transition text-sm",children:"Enregistrer mes choix"})})]}),se.jsxs("div",{className:"flex flex-col gap-3 lg:hidden mt-4",children:[se.jsx("button",{onClick:e,className:"w-full py-3 bg-orange-600 text-white font-bold rounded-lg",children:"Tout accepter"}),se.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[se.jsx("button",{onClick:t,className:"w-full py-3 bg-slate-800 text-white font-semibold rounded-lg border border-slate-700",children:"Tout refuser"}),se.jsx("button",{onClick:()=>r(!i),className:"w-full py-3 bg-transparent text-slate-300 font-medium border border-slate-700 rounded-lg",children:i?"Masquer":"Personnaliser"})]})]}),se.jsx("div",{className:"mt-4 text-center lg:text-left",children:se.jsx("button",{onClick:o,className:"text-xs text-slate-500 hover:text-slate-300 underline",children:"Lire notre politique de confidentialité complète"})})]}),se.jsx("style",{children:"\n        @keyframes slideUp {\n          from { transform: translateY(100%); }\n          to { transform: translateY(0); }\n        }\n      "})]})},Or={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_URL:"http://localhost:5173",VITE_ENV:"development",VITE_GEMINI_API_KEY:"AIzaSyChmfD_IxQdY9ZyjcdtMD0Rk5KEARUQ-aQ",VITE_STRIPE_PUBLIC_KEY:"pk_test_51SgRGbDs1RajryhDkleXazvgLLTAMPMKDgBbJrLH9DpGPo5hd4ABv6TMjz2si1i3PUIlK8lj90uxkW4a7KJtoovG00lQpqFeVe",VITE_SUPABASE_ANON_KEY:"sb_publishable_Y3eZE2ZkiJ63evQBBhzYrg_Q_LHDl4c",VITE_SUPABASE_URL:"https://zlcjwrootdtddykhjmex.supabase.co"};var jr={};const Rr=e=>{if(void 0!==import.meta&&Or)for(const t of e){const e=Or[t];if(e)return e}if(jr)for(const t of e){const e=jr[t];if(e)return e}},Pr=Y(Rr(["NEXT_PUBLIC_SUPABASE_URL","VITE_SUPABASE_URL","REACT_APP_SUPABASE_URL"])||"https://votre-projet.supabase.co",Rr(["NEXT_PUBLIC_SUPABASE_ANON_KEY","VITE_SUPABASE_ANON_KEY","REACT_APP_SUPABASE_ANON_KEY"])||"votre-cle-anon-publique"),Dr=({onLoginSuccess:e,onBack:t})=>{const[n,o]=s.useState(""),[i,r]=s.useState("idle"),[a,c]=s.useState(null);return se.jsxs("div",{className:"min-h-[calc(100vh-64px)] bg-slate-900 flex flex-col justify-center py-12 sm:px-6 lg:px-8 relative overflow-hidden",children:[se.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden z-0",children:[se.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-orange-600/10 rounded-full blur-[100px]"}),se.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-blue-600/10 rounded-full blur-[100px]"})]}),se.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md relative z-10",children:[se.jsx("div",{className:"flex justify-center mb-6",children:se.jsx("div",{className:"bg-slate-800 p-6 rounded-3xl border border-slate-700 shadow-xl",children:se.jsx("img",{src:me,alt:pe,className:"h-16 w-auto object-contain",onError:e=>{e.currentTarget.style.display="none"}})})}),se.jsx("h2",{className:"mt-2 text-center text-3xl font-extrabold text-white",children:"Connexion Sécurisée"}),se.jsx("p",{className:"mt-2 text-center text-sm text-slate-400",children:"Accédez à votre Espace Membre et à vos guides."})]}),se.jsxs("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md relative z-10",children:[se.jsx("div",{className:"bg-white/5 backdrop-blur-lg border border-slate-700 py-8 px-4 shadow-2xl rounded-xl sm:px-10",children:"idle"===i||"loading"===i?se.jsxs("form",{className:"space-y-6",onSubmit:async e=>{if(e.preventDefault(),n&&n.includes("@")){c(null),r("loading");try{const{error:e}=await Pr.auth.signInWithOtp({email:n,options:{emailRedirectTo:window.location.origin}});if(e)throw e;r("sent")}catch(t){t.message&&(t.message.includes("Failed to fetch")||t.message.includes("NetworkError")||t.message.includes("network"))?c("⚠️ Serveur inaccessible (Mode Démo). Veuillez utiliser le bouton 'Connexion Démo' ci-dessous."):c(t.message||"Impossible d'envoyer le lien. Vérifiez votre email."),r("idle")}}else c("Veuillez entrer une adresse email valide.")},children:[se.jsxs("div",{children:[se.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-300",children:"Adresse Email"})," ",se.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-300 mb-2",children:"Adresse email"})," ",se.jsxs("div",{className:"mt-2 relative rounded-md shadow-sm",children:[se.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:se.jsx(O,{className:"h-5 w-5 text-slate-500","aria-hidden":"true"})}),se.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:n,onChange:e=>o(e.target.value),className:"block w-full pl-10 bg-slate-800 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:ring-orange-500 focus:border-orange-500 sm:text-sm py-3 transition-colors",placeholder:"vous@exemple.com"})]}),a&&se.jsxs("div",{className:"mt-2 flex items-start text-sm text-red-400 bg-red-900/20 p-2 rounded border border-red-900/50 animate-pulse",children:[se.jsx(h,{className:"w-4 h-4 mr-2 flex-shrink-0 mt-0.5"}),se.jsx("span",{children:a})]})]}),se.jsx("div",{children:se.jsx("button",{type:"submit",disabled:"loading"===i,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-bold text-white bg-orange-600 hover:bg-orange-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 focus:ring-orange-500 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"loading"===i?se.jsxs(se.Fragment,{children:[se.jsx(A,{className:"animate-spin -ml-1 mr-2 h-5 w-5"}),"Connexion..."]}):se.jsxs(se.Fragment,{children:["Recevoir mon lien de connexion",se.jsx(m,{className:"ml-2 h-5 w-5"})]})})}),se.jsxs("div",{className:"relative my-4",children:[se.jsx("div",{className:"absolute inset-0 flex items-center",children:se.jsx("div",{className:"w-full border-t border-slate-700"})}),se.jsx("div",{className:"relative flex justify-center text-sm",children:se.jsx("span",{className:"px-2 bg-slate-800/0 text-slate-500 backdrop-blur",children:"Ou"})})]}),se.jsx("div",{children:se.jsxs("button",{type:"button",onClick:()=>{e("demo@serruremaster.com")},className:"w-full flex justify-center items-center py-2 px-4 border border-slate-600 rounded-lg text-sm font-medium text-slate-300 hover:bg-slate-800 hover:text-white transition-colors hover:border-orange-500/50",children:[se.jsx(j,{className:"w-4 h-4 mr-2"}),"Connexion Démo (Sans Email)"]})}),se.jsxs("div",{className:"mt-4",children:[se.jsxs("div",{className:"relative",children:[se.jsx("div",{className:"absolute inset-0 flex items-center",children:se.jsx("div",{className:"w-full border-t border-slate-600"})}),se.jsx("div",{className:"relative flex justify-center text-sm",children:se.jsx("span",{className:"px-2 bg-slate-800 text-slate-400 rounded",children:"Sécurité"})})]}),se.jsxs("div",{className:"mt-4 flex justify-center space-x-4 text-xs text-slate-500",children:[se.jsxs("div",{className:"flex items-center",children:[se.jsx(l,{className:"w-3 h-3 mr-1 text-green-500"})," Chiffrement SSL"]}),se.jsxs("div",{className:"flex items-center",children:[se.jsx(l,{className:"w-3 h-3 mr-1 text-green-500"})," Sans mot de passe"]})]})]})]}):se.jsx("div",{className:"text-center py-4",children:"sent"===i&&se.jsxs("div",{className:"animate-fade-in",children:[se.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 mb-6",children:se.jsx(O,{className:"h-8 w-8 text-green-600"})}),se.jsx("h3",{className:"text-lg leading-6 font-medium text-white mb-2",children:"Vérifiez vos emails"}),se.jsxs("p",{className:"text-sm text-slate-300 mb-6",children:["Nous avons envoyé un lien de connexion magique à ",se.jsx("strong",{children:n}),".",se.jsx("br",{}),se.jsx("br",{}),"Cliquez sur le lien dans l'email pour vous connecter instantanément à votre espace sécurisé."]}),se.jsx("button",{onClick:()=>r("idle"),className:"text-xs text-slate-500 underline",children:"Renvoyer un lien ou changer d'email"})]})})}),se.jsx("div",{className:"mt-6 text-center",children:se.jsx("button",{onClick:t,className:"text-sm text-slate-400 hover:text-white transition",children:"← Retour à l'accueil"})})]})]})},Mr=()=>se.jsx("section",{className:"py-24 bg-white",children:se.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[se.jsxs("div",{className:"text-center max-w-3xl mx-auto mb-16",children:[se.jsx("h2",{className:"text-3xl font-extrabold text-slate-900 mb-4",children:"L'expertise technique. La sécurité juridique."}),se.jsx("p",{className:"text-lg text-slate-600 leading-relaxed",children:"Accédez au savoir-faire d'un artisan serrurier pour traiter une urgence sans intervention extérieure, dans le strict respect de l'intégrité de votre matériel."})]}),se.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[se.jsxs("div",{className:"md:col-span-2 bg-slate-900 rounded-3xl p-8 relative overflow-hidden group",children:[se.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-orange-500/10 rounded-full blur-3xl -mr-16 -mt-16 transition group-hover:bg-orange-500/20"}),se.jsxs("div",{className:"relative z-10",children:[se.jsx("div",{className:"w-12 h-12 bg-orange-600 rounded-2xl flex items-center justify-center mb-6",children:se.jsx(R,{className:"w-6 h-6 text-white"})}),se.jsx("h3",{className:"text-2xl font-bold text-white mb-4",children:"Protocole Non-Destructif"}),se.jsx("p",{className:"text-slate-400 text-lg max-w-lg",children:"Priorité absolue à l'ouverture fine. Nos plans d'action vous guident vers des méthodes professionnelles douces pour tenter l'ouverture sans endommager votre serrure ni votre porte."})]})]}),se.jsxs("div",{className:"bg-orange-50 rounded-3xl p-8 border border-orange-100 relative overflow-hidden",children:[se.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-2xl flex items-center justify-center mb-6",children:se.jsx(P,{className:"w-6 h-6 text-orange-600"})}),se.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"Disponibilité Immédiate"}),se.jsx("p",{className:"text-slate-600 text-sm leading-relaxed",children:"Votre urgence n'attend pas. Accédez à votre Espace Membre sécurisé et aux supports vidéo dès la validation de la commande."})]}),se.jsxs("div",{className:"bg-slate-50 rounded-3xl p-8 border border-slate-200",children:[se.jsx("div",{className:"w-12 h-12 bg-white shadow-sm rounded-2xl flex items-center justify-center mb-6",children:se.jsx(D,{className:"w-6 h-6 text-slate-700"})}),se.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"Cadre & Conformité"}),se.jsx("p",{className:"text-slate-600 text-sm leading-relaxed",children:"Usage strictement réservé aux occupants légitimes. Nos guides intègrent systématiquement les rappels légaux et de sécurité."})]}),se.jsx("div",{className:"md:col-span-2 bg-gradient-to-br from-slate-100 to-white rounded-3xl p-8 border border-slate-200 relative overflow-hidden",children:se.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-8",children:[se.jsxs("div",{className:"flex-1",children:[se.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-2xl flex items-center justify-center mb-6",children:se.jsx(M,{className:"w-6 h-6 text-blue-600"})}),se.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-4",children:"Validation Technique Incluse"}),se.jsxs("p",{className:"text-slate-600 text-lg",children:["Un doute sur votre type de serrure ? Envoyez une photo via WhatsApp. ",se.jsx("br",{}),"Un expert confirme la compatibilité de la méthode en temps réel avant toute action."]})]}),se.jsx("div",{className:"w-full md:w-1/3",children:se.jsxs("div",{className:"space-y-3 opacity-90",children:[se.jsx("div",{className:"bg-white p-3 rounded-2xl rounded-tl-none shadow-sm border border-slate-100 text-xs text-slate-600",children:"Bonjour, ma porte n'a pas de poignée extérieure, est-ce compatible ?"}),se.jsx("div",{className:"bg-blue-600 text-white p-3 rounded-2xl rounded-tr-none shadow-md text-xs ml-auto",children:"Oui, c'est une configuration palière standard. Le module 2 du guide détaille le geste précis pour ce cas."})]})})]})})]})]})}),Ur=[{icon:U,title:"1. Diagnostic d'éligibilité",desc:"Vérifiez impérativement que votre situation (ex: porte claquée non verrouillée) est compatible avec nos protocoles d'ouverture fine."},{icon:w,title:"2. Accès au protocole",desc:"Obtenez instantanément le plan d'action vidéo et PDF. Un contenu technique conçu pour être appliqué par des non-professionnels."},{icon:k,title:"3. Application guidée",desc:"Suivez la méthodologie pas à pas. Nos supports vous indiquent les gestes précis à effectuer et les erreurs critiques à éviter."},{icon:l,title:"4. Résolution maîtrisée",desc:"Tentez l'ouverture sans dégradation. Si la méthode ne suffit pas, vous aurez évité d'aggraver la situation pour le dépanneur."}],kr=()=>se.jsx("section",{className:"py-20 bg-slate-50 border-t border-slate-200",children:se.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[se.jsxs("div",{className:"text-center mb-16",children:[se.jsx("h2",{className:"text-3xl font-bold text-slate-900",children:"Votre plan d'action en 4 étapes"}),se.jsx("p",{className:"text-slate-400 mt-4 max-w-2xl mx-auto",children:"Une démarche structurée pour intervenir calmement, avec les bons outils et la bonne méthode."})]}),se.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:Ur.map((e,t)=>se.jsxs("div",{className:"relative flex flex-col items-center text-center group",children:[se.jsxs("div",{className:"w-16 h-16 bg-white rounded-2xl shadow-sm border border-slate-200 flex items-center justify-center mb-6 z-10 relative group-hover:border-orange-500/50 group-hover:shadow-md transition-all",children:[se.jsx(e.icon,{className:"w-8 h-8 text-slate-700 group-hover:text-orange-600 transition-colors"}),se.jsx("div",{className:"absolute -top-3 -right-3 w-7 h-7 bg-slate-900 rounded-lg text-white text-sm font-bold flex items-center justify-center border-2 border-slate-50",children:t+1})]}),t!==Ur.length-1&&se.jsx("div",{className:"hidden md:block absolute top-8 left-1/2 w-full h-0.5 bg-slate-200 -z-0"}),se.jsx("h3",{className:"font-bold text-lg text-slate-900 mb-3",children:e.title}),se.jsx("p",{className:"text-sm text-slate-600 px-2 leading-relaxed",children:e.desc})]},t))})]})}),qr=[{id:"t1",name:"Sophie M.",role:"Paris 15ème",text:"J'ai économisé 450€ un dimanche soir. Le guide vidéo sur la radio est incroyable, porte ouverte en 3 minutes !",rating:5,approved:!0,date:"2023-11-01",source:"trustpilot"},{id:"t2",name:"Karim B.",role:"Lyon",text:"Sceptique au début, mais la méthode du kit de survie fonctionne. Merci pour l'honnêteté.",rating:5,approved:!0,date:"2023-11-05",source:"google"},{id:"t3",name:"Julie D.",role:"Marseille",text:"Le support WhatsApp m'a sauvé. J'étais paniquée, Thomas m'a calmée et guidée.",rating:4,approved:!0,date:"2023-10-20",source:"email"}],Lr=s.createContext(void 0),Gr=({children:e})=>{const[t,n]=s.useState(qr);return s.useEffect(()=>{(async()=>{try{const{data:e,error:t}=await Pr.from("testimonials").select("*").order("created_at",{ascending:!1});if(t)throw t;e&&e.length>0&&n(e)}catch(e){}})()},[]),se.jsx(Lr.Provider,{value:{testimonials:t,addTestimonial:async e=>{const t="temp_"+Date.now(),s={...e,id:t,date:(new Date).toISOString(),approved:!1};n(e=>[s,...e]);try{const{data:s,error:o}=await Pr.from("testimonials").insert([{name:e.name,role:e.role,text:e.text,rating:e.rating,approved:!1,source:e.source}]).select().single();if(o)throw o;s&&n(e=>e.map(e=>e.id===t?s:e))}catch(o){}},updateTestimonial:async(e,t)=>{n(n=>n.map(n=>n.id===e?{...n,...t}:n));try{await Pr.from("testimonials").update(t).eq("id",e)}catch(s){}},deleteTestimonial:async e=>{n(t=>t.filter(t=>t.id!==e));try{await Pr.from("testimonials").delete().eq("id",e)}catch(t){}},toggleApproval:async e=>{const s=t.find(t=>t.id===e);if(!s)return;const o=!s.approved;n(t=>t.map(t=>t.id===e?{...t,approved:o}:t));try{await Pr.from("testimonials").update({approved:o}).eq("id",e)}catch(i){n(t=>t.map(t=>t.id===e?{...t,approved:!o}:t))}},resetTestimonials:()=>{n(qr)}},children:e})},Fr=()=>{const e=s.useContext(Lr);if(void 0===e)throw new Error("useTestimonials must be used within a TestimonialProvider");return e},Vr=()=>{const{testimonials:e}=Fr(),t=e.filter(e=>e.approved).slice(0,3);return se.jsx("section",{className:"py-24 bg-slate-900 text-white",children:se.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[se.jsxs("div",{className:"text-center mb-16",children:[se.jsx("h2",{className:"text-3xl font-bold text-white",children:"Ils ont ouvert leur porte seuls"}),se.jsx("p",{className:"text-slate-300 mt-4",children:"Plus de 5000 clients satisfaits. Voici leurs retours."})]}),se.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:t.map(e=>se.jsxs("div",{className:"bg-slate-800 rounded-2xl p-8 relative",children:[se.jsx(q,{className:"absolute top-6 right-6 w-8 h-8 text-slate-700 opacity-50"}),se.jsx("div",{className:"flex gap-1 mb-6",children:[...Array(5)].map((t,n)=>se.jsx(L,{className:"w-4 h-4 "+(n<e.rating?"fill-orange-500 text-orange-500":"text-slate-600")},n))}),se.jsxs("p",{className:"text-slate-300 mb-6 italic min-h-[80px]",children:['"',e.text,'"']}),se.jsxs("div",{className:"flex items-center",children:[se.jsx("div",{className:"w-10 h-10 bg-slate-700 rounded-full flex items-center justify-center font-bold text-sm text-slate-300",children:e.name.charAt(0)}),se.jsxs("div",{className:"ml-3",children:[se.jsx("p",{className:"font-bold text-sm text-white",children:e.name}),se.jsx("p",{className:"text-xs text-slate-400",children:e.role})]})]})]},e.id))})]})})},Hr=[{q:"Est-ce vraiment légal d'ouvrir sa porte ?",a:"Oui, tant que vous êtes l'occupant légitime du logement (propriétaire ou locataire avec bail). Nos guides rappellent systématiquement ce cadre légal."},{q:"Et si je n'y arrive pas ?",a:"Nos méthodes fonctionnent dans 90% des cas (porte claquée simple). Si vous échouez, nous vous conseillons d'arrêter pour ne rien casser. Vous aurez économisé le temps d'attente d'un serrurier avant de l'appeler en dernier recours."},{q:"Ai-je besoin d'outils spéciaux ?",a:"Non. Les méthodes enseignées utilisent uniquement du matériel domestique courant. Aucun outil professionnel n'est requis."},{q:"Puis-je me faire rembourser ?",a:"S'agissant de produits numériques avec accès immédiat, le droit de rétractation ne s'applique pas une fois le contenu consommé, conformément à la loi. Cependant, nous étudions les réclamations au cas par cas si le guide n'a pas été téléchargé/visionné."}],Br=()=>{const[e,t]=s.useState(null);return se.jsx("section",{className:"py-20 bg-white",children:se.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[se.jsx("div",{className:"text-center mb-12",children:se.jsx("h2",{className:"text-3xl font-bold text-slate-900",children:"Questions Fréquentes"})}),se.jsx("div",{className:"space-y-4",children:Hr.map((n,s)=>se.jsxs("div",{className:"border border-slate-200 rounded-xl overflow-hidden",children:[se.jsxs("button",{className:"w-full px-6 py-4 flex justify-between items-center text-left bg-slate-50 hover:bg-slate-100 transition",onClick:()=>t(e===s?null:s),children:[se.jsx("span",{className:"font-bold text-slate-900",children:n.q}),e===s?se.jsx(G,{className:"w-5 h-5 text-slate-500"}):se.jsx(F,{className:"w-5 h-5 text-slate-500"})]}),e===s&&se.jsx("div",{className:"px-6 py-4 bg-white text-slate-600 text-sm leading-relaxed border-t border-slate-200",children:n.a})]},s))})]})})},Jr=({onOpenChat:e})=>se.jsxs("section",{className:"py-20 bg-slate-900 border-y border-slate-800 relative overflow-hidden",children:[se.jsx("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none",children:se.jsx("div",{className:"absolute top-[-20%] right-[-10%] w-[600px] h-[600px] bg-green-500/5 rounded-full blur-[100px]"})}),se.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:[se.jsxs("div",{className:"text-center max-w-3xl mx-auto mb-12",children:[se.jsxs("div",{className:"inline-flex items-center space-x-2 bg-slate-800/50 border border-slate-700 rounded-full px-4 py-1.5 mb-6",children:[se.jsxs("span",{className:"relative flex h-2 w-2",children:[se.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),se.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-green-500"})]}),se.jsx("span",{className:"text-slate-300 text-xs font-bold tracking-wider uppercase",children:"Support Connecté"})]}),se.jsx("h2",{className:"text-3xl md:text-4xl font-extrabold text-white mb-6",children:"Une question ? Deux niveaux d'assistance."}),se.jsx("p",{className:"text-lg text-slate-400 leading-relaxed",children:"Pour garantir un service pédagogique de qualité sans fausse promesse, nous distinguons l'orientation immédiate de l'expertise humaine."})]}),se.jsxs("div",{className:"grid md:grid-cols-2 gap-8 max-w-5xl mx-auto",children:[se.jsxs("div",{className:"bg-slate-800 rounded-2xl p-8 border border-slate-700 flex flex-col relative group hover:border-slate-600 transition-all",children:[se.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-10",children:se.jsx(I,{className:"w-24 h-24 text-white"})}),se.jsxs("div",{className:"mb-6",children:[se.jsx("div",{className:"w-14 h-14 bg-slate-700 rounded-xl flex items-center justify-center mb-4",children:se.jsx(I,{className:"w-7 h-7 text-white"})}),se.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Assistant Virtuel (IA)"}),se.jsx("p",{className:"text-sm text-slate-400 font-medium uppercase tracking-wide",children:"Premier contact & Éligibilité"})]}),se.jsxs("ul",{className:"space-y-4 mb-8 flex-1",children:[se.jsxs("li",{className:"flex items-start text-slate-300 text-sm",children:[se.jsx(V,{className:"w-5 h-5 text-green-500 mr-3 flex-shrink-0"}),se.jsx("span",{children:"Diagnostic de compatibilité immédiat"})]}),se.jsxs("li",{className:"flex items-start text-slate-300 text-sm",children:[se.jsx(V,{className:"w-5 h-5 text-green-500 mr-3 flex-shrink-0"}),se.jsx("span",{children:"Disponible 24h/24 et 7j/7"})]}),se.jsxs("li",{className:"flex items-start text-slate-300 text-sm",children:[se.jsx(V,{className:"w-5 h-5 text-green-500 mr-3 flex-shrink-0"}),se.jsx("span",{children:"Orientation vers le bon guide PDF/Vidéo"})]})]}),se.jsxs("button",{onClick:e,className:"w-full py-4 bg-white text-slate-900 font-bold rounded-xl hover:bg-slate-200 transition-colors flex items-center justify-center",children:["Lancer le diagnostic gratuit",se.jsx(m,{className:"w-5 h-5 ml-2"})]}),se.jsx("p",{className:"text-center text-[10px] text-slate-400 mt-3",children:"Réponse instantanée automatisée"})]}),se.jsxs("div",{className:"bg-green-900/20 rounded-2xl p-8 border border-green-500/30 flex flex-col relative group hover:border-green-500/50 transition-all",children:[se.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-10",children:se.jsx(b,{className:"w-24 h-24 text-green-500"})}),se.jsxs("div",{className:"mb-6",children:[se.jsx("div",{className:"w-14 h-14 bg-green-900/30 rounded-xl flex items-center justify-center mb-4 border border-green-500/30",children:se.jsx(b,{className:"w-7 h-7 text-green-500"})}),se.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Expert SerrureMaster"}),se.jsx("p",{className:"text-sm text-green-400 font-medium uppercase tracking-wide",children:"Validation Visuelle Humaine"})]}),se.jsxs("ul",{className:"space-y-4 mb-8 flex-1",children:[se.jsxs("li",{className:"flex items-start text-slate-300 text-sm",children:[se.jsx(V,{className:"w-5 h-5 text-green-500 mr-3 flex-shrink-0"}),se.jsx("span",{children:"Analyse de votre serrure sur photo"})]}),se.jsxs("li",{className:"flex items-start text-slate-300 text-sm",children:[se.jsx(V,{className:"w-5 h-5 text-green-500 mr-3 flex-shrink-0"}),se.jsx("span",{children:"Confirmation technique avant achat"})]}),se.jsxs("li",{className:"flex items-start text-slate-300 text-sm",children:[se.jsx(H,{className:"w-5 h-5 text-orange-500 mr-3 flex-shrink-0"}),se.jsx("span",{children:"Délai de réponse variable (heures ouvrées)"})]})]}),se.jsxs("a",{href:"https://wa.me/33757570389",target:"_blank",rel:"noreferrer",className:"w-full py-4 bg-[#25D366] hover:bg-[#20bd5a] text-white font-bold rounded-xl transition-colors flex items-center justify-center shadow-lg shadow-green-900/20",children:[se.jsx(b,{className:"w-5 h-5 mr-2"}),"Contacter le Support Pro"]}),se.jsx("p",{className:"text-center text-[10px] text-slate-400 mt-3",children:"WhatsApp Business Officiel"})]})]}),se.jsxs("div",{className:"max-w-4xl mx-auto mt-12 bg-slate-800/50 rounded-lg p-4 border border-slate-700 flex items-start gap-4",children:[se.jsx(B,{className:"w-6 h-6 text-slate-400 flex-shrink-0 mt-0.5"}),se.jsxs("div",{className:"text-xs text-slate-400 leading-relaxed",children:[se.jsx("strong",{className:"text-slate-300 block mb-1",children:"Cadre d'intervention et Responsabilité :"}),"L'assistance WhatsApp (IA ou Humaine) a pour unique vocation de qualifier votre situation et de vous orienter vers le produit adapté.",se.jsxs("span",{className:"text-orange-400",children:[" ","Aucune instruction technique détaillée d'ouverture ne sera transmise par message."]}),"Ce canal ne constitue pas un service de dépannage à distance ni une garantie de résultat. En cas d'urgence vitale ou de blocage complexe, faites appel à un professionnel sur place."]})]})]})]}),$r=s.createContext(void 0),Yr=({children:e})=>{const[t,n]=s.useState(he),[o,i]=s.useState(ge);return s.useEffect(()=>{(async()=>{try{const{data:e,error:t}=await Pr.from("products").select("*");if(t)throw t;if(e&&e.length>0){const t=e.map(e=>({id:e.id,title:e.title,description:e.description||"",price:e.price,originalPrice:e.original_price,image:e.image,stripePriceId:e.stripe_price_id,type:e.type||"bundle",features:e.features||[],compatibility:e.compatibility,currentResource:null}));n(t)}}catch(e){}})()},[]),se.jsx($r.Provider,{value:{products:t,courses:o,updateProductImage:async(e,t)=>{n(n=>n.map(n=>n.id===e?{...n,image:t}:n));try{await Pr.from("products").update({image:t}).eq("id",e)}catch(s){}},updateProductDetails:async(e,t)=>{n(n=>n.map(n=>n.id===e?{...n,...t}:n));try{await Pr.from("products").update(t).eq("id",e)}catch(s){}},resetProducts:async()=>{},uploadProductResource:async(e,t)=>{await new Promise(e=>setTimeout(e,1500));const s={id:"res_"+Date.now(),productId:e,fileName:t.name,filePath:`secure-pdfs/${e}/${t.name}`,fileSize:(t.size/1024/1024).toFixed(2)+" MB",status:"draft",version:1,lastUpdated:(new Date).toISOString()};n(t=>t.map(t=>t.id===e?{...t,currentResource:s}:t))},updateResourceStatus:(e,t)=>{n(n=>n.map(n=>n.id===e&&n.currentResource?{...n,currentResource:{...n.currentResource,status:t}}:n))},addModule:(e,t)=>{i(n=>{const s=n[e]||{productId:e,modules:[]},o={id:`mod_${Date.now()}`,title:t,status:"draft",lessons:[]};return{...n,[e]:{...s,modules:[...s.modules,o]}}})},addLesson:(e,t,n)=>{i(s=>{const o=s[e];if(!o)return s;const i={...n,id:`les_${Date.now()}`,status:"draft"};return{...s,[e]:{...o,modules:o.modules.map(e=>e.id===t?{...e,lessons:[...e.lessons,i]}:e)}}})},updateLessonStatus:(e,t,n,s)=>{i(o=>{const i=o[e];return i?{...o,[e]:{...i,modules:i.modules.map(e=>e.id===t?{...e,lessons:e.lessons.map(e=>e.id===n?{...e,status:s}:e)}:e)}}:o})},updateLessonDetails:(e,t,n,s)=>{i(o=>{const i=o[e];return i?{...o,[e]:{...i,modules:i.modules.map(e=>e.id===t?{...e,lessons:e.lessons.map(e=>e.id===n?{...e,...s}:e)}:e)}}:o})}},children:e})},zr=()=>{const e=s.useContext($r);if(void 0===e)throw new Error("useProducts must be used within a ProductProvider");return e},Wr=s.lazy(()=>ae(()=>import("./Dashboard-iSINUHXR.js"),__vite__mapDeps([0,1,2,3])).then(e=>({default:e.Dashboard}))),Kr=s.lazy(()=>ae(()=>import("./AdminDashboard-Dr2LDh0G.js"),__vite__mapDeps([4,1,2,3])).then(e=>({default:e.AdminDashboard}))),Xr=s.lazy(()=>ae(()=>import("./CoursePlayer-DAV4gM3I.js"),__vite__mapDeps([5,1,2,3])).then(e=>({default:e.CoursePlayer}))),Qr=s.lazy(()=>ae(()=>import("./CGV-De75CsUk.js"),__vite__mapDeps([6,2,1,3])).then(e=>({default:e.CGV}))),Zr=s.lazy(()=>ae(()=>import("./PrivacyPolicy-BiaX0o0c.js"),__vite__mapDeps([7,2,1,3])).then(e=>({default:e.PrivacyPolicy}))),ea=s.lazy(()=>ae(()=>import("./CookiesPolicy-xwpSOWSh.js"),__vite__mapDeps([8,2,1,3])).then(e=>({default:e.CookiesPolicy}))),ta=()=>se.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50",children:se.jsxs("div",{className:"text-center",children:[se.jsx(A,{className:"w-12 h-12 animate-spin text-orange-500 mx-auto mb-4"}),se.jsx("p",{className:"text-slate-600",children:"Chargement..."})]})}),na=({children:e,pageKey:t})=>se.jsx("div",{className:"animate-fade-in w-full min-h-screen",children:e},t),sa=()=>{const[e,t]=s.useState("home"),[n,o]=s.useState(null),[i,r]=s.useState(null),[a,c]=s.useState(!1),[u,d]=s.useState(null),[p,m]=s.useState(!1),[h,f]=s.useState(null),[g,v]=s.useState(!1),{items:b,clearCart:E,toggleCart:w}=ue(),{products:N}=zr();s.useEffect(()=>{let t=pe;switch(e){case"dashboard":t=`Espace Membre | ${pe}`;break;case"login":t=`Connexion | ${pe}`;break;case"course":t=`Formation | ${pe}`;break;case"about":t=`Notre Expertise | ${pe}`;break;case"home":t=`${pe} : Ouvrez votre porte sans serrurier`;break;default:t=`${e.charAt(0).toUpperCase()+e.slice(1)} | ${pe}`}document.title=t,window.scrollTo(0,0)},[e]);const S=e=>{r(e),setTimeout(()=>r(null),5e3)},I=async(e,t)=>{try{const{data:n,error:s}=await Pr.from("profiles").select("*").eq("id",e).single();s&&s.code;const{data:i,error:r}=await Pr.from("user_products").select("product_id").eq("user_id",e),a=i?i.map(e=>e.product_id):[];if(n){const e={id:n.id,email:n.email||t,name:n.full_name||t.split("@")[0],purchasedProductIds:a,role:n.role,status:n.status,joinedAt:n.created_at};o(e)}else{const n={id:e,email:t,name:t.split("@")[0],purchasedProductIds:a,role:"user",status:"active"};o(n)}}catch(n){o({id:e,email:t,name:t.split("@")[0],purchasedProductIds:[],role:"user",status:"active"})}};s.useEffect(()=>{const e=localStorage.getItem("serrure_master_consent");e?d(JSON.parse(e)):setTimeout(()=>c(!0),1500),(async()=>{var e;try{const{data:{session:t},error:n}=await Pr.auth.getSession();if(n)throw n;(null==(e=null==t?void 0:t.user)?void 0:e.email)&&await I(t.user.id,t.user.email)}catch(t){}})();const{data:{subscription:s}}=Pr.auth.onAuthStateChange((e,t)=>{t?!n&&(null==t?void 0:t.user)&&I(t.user.id,t.user.email):o(null)}),i=new URLSearchParams(window.location.search);return"success"===i.get("status")&&(S("✅ Paiement validé ! Bienvenue dans votre espace."),E(),n||o({id:fe,email:"client@test.com",name:"Nouveau Client",purchasedProductIds:["p1_door_slammed"],role:"user",status:"active"}),t("dashboard"),window.history.replaceState({},"","/")),"cancel"===i.get("status")&&(S("⚠️ Paiement annulé. Votre panier est conservé."),w(),window.history.replaceState({},"","/")),()=>s.unsubscribe()},[E,w]);const T=e=>{"demo@serruremaster.com"===e||e.includes("test")?(o({id:fe,email:e,name:"Utilisateur Démo",purchasedProductIds:["p1_door_slammed","p4_security_pack"],role:e.includes("admin")?"admin":"user",status:"active"}),t(e.includes("admin")?"admin":"dashboard"),S("👋 Bienvenue sur la démo !")):S("📧 Lien de connexion envoyé !")},C=async()=>{try{await Pr.auth.signOut()}catch(e){}o(null),t("home"),S("Vous avez été déconnecté.")},O=e=>{d(e),localStorage.setItem("serrure_master_consent",JSON.stringify(e)),c(!1)},j=()=>{localStorage.removeItem("serrure_master_consent"),d(null),c(!0),S("Préférences cookies réinitialisées.")};return se.jsxs(ye,{user:n,onNavigate:t,currentPage:e,onLogout:C,onLoginClick:()=>t("login"),onCheckout:async()=>{if(0!==b.length){if(!n)return w(),S("Veuillez vous connecter pour sécuriser votre achat."),void t("login");m(!0);try{await(async(e,t)=>{try{if(t.filter(e=>!e.stripePriceId).length>0)throw new Error("Certains produits n'ont pas de Price ID Stripe configuré");const n={userId:e,items:t.map(e=>({priceId:e.stripePriceId,quantity:e.quantity})),successUrl:`${window.location.origin}/dashboard?status=success`,cancelUrl:`${window.location.origin}/?status=cancel`},{data:s,error:o}=await Pr.functions.invoke("stripe-checkout",{body:n});if(o)throw o;if(!(null==s?void 0:s.url))throw new Error("Pas d'URL de redirection retournée par Stripe");window.location.href=s.url}catch(n){throw n}})(n.id,b)}catch(e){setTimeout(()=>{m(!1),window.confirm("Mode Démo : Supabase/Stripe non connectés.\nVoulez-vous simuler un paiement RÉUSSI ?")?window.location.href="/?status=success":S("Paiement annulé (Simulation).")},1e3)}}},children:[i&&se.jsxs("div",{className:"fixed top-24 right-4 z-[160] bg-slate-800 text-white px-6 py-4 rounded-lg shadow-2xl border border-slate-700 animate-fade-in-down flex items-center",children:[se.jsx("div",{className:"mr-3",children:i.includes("✅")?se.jsx(l,{className:"text-green-500"}):se.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"})}),se.jsx("div",{children:i}),se.jsx("button",{onClick:()=>r(null),className:"ml-4 text-slate-500 hover:text-white",children:"✕"})]}),p&&se.jsxs("div",{className:"fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-[200] flex flex-col items-center justify-center text-white",children:[se.jsx(A,{className:"w-12 h-12 animate-spin text-orange-500 mb-4"}),se.jsx("h3",{className:"text-xl font-bold",children:"Redirection vers le paiement sécurisé..."}),se.jsx("p",{className:"text-slate-400 mt-2 text-sm",children:"Veuillez patienter"})]}),se.jsx(na,{pageKey:e,children:(()=>{switch(e){case"dashboard":return n?"admin"===n.role?se.jsx(s.Suspense,{fallback:se.jsx(ta,{}),children:se.jsx(Kr,{currentUser:n,onLogout:C})}):se.jsx(s.Suspense,{fallback:se.jsx(ta,{}),children:se.jsx(Wr,{user:n,onNavigateToCourse:e=>{f(e),t("course")}})}):se.jsx(Dr,{onLoginSuccess:T,onBack:()=>t("home")});case"course":return n&&h?se.jsx(s.Suspense,{fallback:se.jsx(ta,{}),children:se.jsx(Xr,{user:n,productId:h,onBack:()=>t("dashboard")})}):se.jsx(s.Suspense,{fallback:se.jsx(ta,{}),children:se.jsx(Wr,{user:n})});case"admin":return n&&"admin"===n.role?se.jsx(s.Suspense,{fallback:se.jsx(ta,{}),children:se.jsx(Kr,{currentUser:n,onLogout:C})}):se.jsx(Dr,{onLoginSuccess:T,onBack:()=>t("home")});case"login":return se.jsx(Dr,{onLoginSuccess:T,onBack:()=>t("home")});case"cgv":return se.jsx(s.Suspense,{fallback:se.jsx(ta,{}),children:se.jsx(Qr,{onBack:()=>t("home")})});case"privacy":return se.jsx(s.Suspense,{fallback:se.jsx(ta,{}),children:se.jsx(Zr,{onBack:()=>t("home")})});case"cookies":return se.jsx(s.Suspense,{fallback:se.jsx(ta,{}),children:se.jsx(ea,{onBack:()=>t("home"),onReset:j})});case"about":return se.jsx("div",{className:"pt-20 pb-20 bg-slate-50 min-h-screen font-sans",children:se.jsxs("div",{className:"max-w-3xl mx-auto px-6",children:[se.jsxs("div",{className:"text-center mb-16",children:[se.jsx("div",{className:"w-16 h-16 bg-white rounded-2xl shadow-sm border border-slate-200 flex items-center justify-center mx-auto mb-6",children:se.jsx($,{className:"w-8 h-8 text-slate-700"})}),se.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-slate-900 mb-6 tracking-tight",children:["Une expertise professionnelle, ",se.jsx("br",{}),"transmise à distance"]}),se.jsx("div",{className:"text-lg text-slate-600 leading-relaxed max-w-2xl mx-auto",children:se.jsx("p",{children:"Ce service repose sur une expérience professionnelle de terrain et sur une approche pédagogique structurée. Les plans d’action proposés sont conçus pour expliquer, guider et accompagner, dans un cadre strictement légal et non destructif."})})]}),se.jsxs("div",{className:"space-y-10",children:[se.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-sm border border-slate-200",children:[se.jsx("h3",{className:"font-bold text-slate-900 text-lg mb-4",children:"Chaque contenu est pensé pour :"}),se.jsx("ul",{className:"space-y-3",children:["Comprendre la mécanique concernée","Identifier si la situation est compatible","Éviter les erreurs courantes","Préserver l’intégrité de la porte et de la serrure"].map((e,t)=>se.jsxs("li",{className:"flex items-start text-slate-700",children:[se.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-orange-500 mt-2.5 mr-3 flex-shrink-0"}),se.jsx("span",{className:"leading-relaxed",children:e})]},t))})]}),se.jsxs("div",{children:[se.jsxs("h2",{className:"text-xl font-bold text-slate-900 mb-4 flex items-center",children:[se.jsx(l,{className:"w-6 h-6 text-orange-600 mr-2"}),"Une approche responsable et encadrée"]}),se.jsxs("div",{className:"bg-slate-100/50 p-6 rounded-2xl border border-slate-200",children:[se.jsx("p",{className:"text-slate-700 font-medium mb-3",children:"Les méthodes présentées :"}),se.jsxs("ul",{className:"space-y-2 mb-6 text-slate-600",children:[se.jsxs("li",{className:"flex items-center",children:[se.jsx(y,{className:"w-4 h-4 text-slate-400 mr-2"})," Ne constituent pas un dépannage physique"]}),se.jsxs("li",{className:"flex items-center",children:[se.jsx(y,{className:"w-4 h-4 text-slate-400 mr-2"})," Ne garantissent pas un résultat"]}),se.jsxs("li",{className:"flex items-center",children:[se.jsx(x,{className:"w-4 h-4 text-green-500 mr-2"})," Ne s’appliquent que dans des situations autorisées"]})]}),se.jsx("p",{className:"text-sm text-slate-500 border-t border-slate-200 pt-4 italic",children:'"Avant toute action, l’utilisateur est invité à analyser sa situation, à respecter les conditions de compatibilité, et à interrompre immédiatement en cas de doute."'})]})]}),se.jsxs("div",{children:[se.jsxs("h2",{className:"text-xl font-bold text-slate-900 mb-4 flex items-center",children:[se.jsx($,{className:"w-6 h-6 text-blue-600 mr-2"}),"Des contenus pédagogiques, pas des interventions"]}),se.jsxs("div",{className:"text-slate-600 leading-relaxed space-y-4",children:[se.jsx("p",{children:"Les guides fournis (PDF et vidéos) ont une vocation :"}),se.jsx("div",{className:"flex flex-wrap gap-3",children:["Éducative","Préventive","Informative"].map(e=>se.jsx("span",{className:"px-4 py-1.5 bg-white text-slate-700 rounded-full text-sm font-bold border border-slate-200 shadow-sm",children:e},e))}),se.jsx("p",{className:"pt-2",children:"Ils permettent de prendre une décision éclairée, que ce soit pour agir soi-même lorsque c’est possible, ou pour comprendre quand une intervention extérieure est nécessaire."})]})]}),se.jsx("div",{className:"bg-slate-900 rounded-2xl p-8 text-center md:text-left md:flex md:items-center md:justify-between shadow-xl shadow-slate-900/10",children:se.jsxs("div",{className:"mb-6 md:mb-0 md:mr-6",children:[se.jsxs("div",{className:"flex items-center justify-center md:justify-start mb-2",children:[se.jsx(_,{className:"w-5 h-5 text-green-400 mr-2"}),se.jsx("h2",{className:"text-lg font-bold text-white",children:"Sécurité, légalité et transparence"})]}),se.jsxs("p",{className:"text-slate-400 text-sm leading-relaxed max-w-xl",children:["L’accès aux contenus est sécurisé. Les supports sont protégés et réservés à un usage personnel."," ",se.jsx("span",{className:"text-slate-200",children:"Aucune information n’est destinée à contourner un dispositif de sécurité ou à faciliter une utilisation illégale."})]})]})})]}),se.jsx("div",{className:"mt-16 text-center",children:se.jsx("button",{onClick:()=>t("home"),className:"inline-flex items-center text-slate-900 font-bold border-2 border-slate-200 px-8 py-3 rounded-xl hover:bg-slate-900 hover:text-white hover:border-slate-900 transition duration-300",children:"Retour au catalogue"})})]})});default:return se.jsxs(se.Fragment,{children:[se.jsx(_e,{onCtaClick:()=>{requestAnimationFrame(()=>{const e=document.getElementById("products-section");null==e||e.scrollIntoView({behavior:"smooth",block:"start"})})}}),se.jsx("div",{className:"bg-slate-900 border-y border-slate-800 py-6",children:se.jsxs("div",{className:"max-w-7xl mx-auto px-4 flex flex-wrap justify-center gap-8 md:gap-16 text-slate-400 text-sm font-medium uppercase tracking-widest",children:[se.jsxs("div",{className:"flex items-center",children:[se.jsx(l,{className:"w-5 h-5 mr-2 text-slate-600"})," 100% Légal"]}),se.jsxs("div",{className:"flex items-center",children:[se.jsx(J,{className:"w-5 h-5 mr-2 text-slate-600"})," +5000 Clients aidés"]}),se.jsxs("div",{className:"flex items-center",children:[se.jsx(P,{className:"w-5 h-5 mr-2 text-slate-600"})," Accès Immédiat"]})]})}),se.jsx("div",{id:"products-section",className:"py-20 bg-slate-50",children:se.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[se.jsxs("div",{className:"text-center mb-16",children:[se.jsx("h2",{className:"text-3xl md:text-4xl font-extrabold text-slate-900",children:"Choisissez votre solution"}),se.jsx("p",{className:"mt-4 text-lg text-slate-500 max-w-2xl mx-auto",children:"Identifiez votre problème. Nous avons le plan d'action correspondant."})]}),se.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:N.map(e=>se.jsx(we,{product:e,isOwned:null==n?void 0:n.purchasedProductIds.includes(e.id)},e.id))})]})}),se.jsx(Mr,{}),se.jsx(Jr,{onOpenChat:()=>v(!0)}),se.jsx(kr,{}),se.jsx(Vr,{}),se.jsx(Br,{})]})}})()}),se.jsx(Tr,{user:n,isOpen:g,onToggle:()=>v(!g)}),a&&se.jsx(Cr,{onAcceptAll:()=>O({necessary:!0,analytics:!0,marketing:!0}),onRefuseAll:()=>O({necessary:!0,analytics:!1,marketing:!1}),onSavePreferences:O,onLearnMore:()=>t("privacy")})]})},oa=()=>se.jsx(Ee,{children:se.jsx(Yr,{children:se.jsx(Gr,{children:se.jsx(ce,{children:se.jsx(sa,{})})})})});"undefined"!=typeof window&&void 0!==window.chrome&&(null==(n=null==(t=null==(e=window.chrome)?void 0:e.runtime)?void 0:t.onMessage)||n.addListener((e,t,n)=>(n({received:!0}),!1)));const ia=document.getElementById("root");if(!ia)throw new Error("Could not find root element to mount to");oe.createRoot(ia).render(se.jsx(i.StrictMode,{children:se.jsx(oa,{})}));export{pe as A,me as L,fe as M,he as P,zr as a,se as j,Fr as u};
