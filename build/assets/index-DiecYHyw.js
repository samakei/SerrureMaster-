import{r as e,a as t,R as n}from"./react-vendor-C11u62No.js";import{S as o,X as i,a as s,T as r,b as l,P as a,c as u,A as c,C as d,U as p,L as h,M as f,d as m,e as g,f as y,g as v,h as E,F as _,i as I,j as b,B as A,k as T,l as S,m as O,n as C,o as w,W as N,Z as R,p as x,q as P,r as D,s as M,Q as U,t as j,u as k,v as q,w as L,x as G,y as H,z as F,D as V}from"./icons-D4y1Z8Z8.js";import{c as B}from"./supabase-DzS9I7wL.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var J={exports:{}},Y={},$=e,W=Symbol.for("react.element"),K=Symbol.for("react.fragment"),z=Object.prototype.hasOwnProperty,X=$.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Q={key:!0,ref:!0,__self:!0,__source:!0};function Z(e,t,n){var o,i={},s=null,r=null;for(o in void 0!==n&&(s=""+n),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(r=t.ref),t)z.call(t,o)&&!Q.hasOwnProperty(o)&&(i[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===i[o]&&(i[o]=t[o]);return{$$typeof:W,type:e,key:s,ref:r,props:i,_owner:X.current}}Y.Fragment=K,Y.jsx=Z,Y.jsxs=Z,J.exports=Y;var ee=J.exports,te={},ne=t;te.createRoot=ne.createRoot,te.hydrateRoot=ne.hydrateRoot;const oe=e.createContext(void 0);var ie=(e=>(e.PDF="PDF",e.VIDEO="VIDEO",e.BUNDLE="BUNDLE",e))(ie||{});const se="SerrureMaster",re="/logo.png",le=[{id:"p1_door_slammed",title:"Urgence : Porte Claquée",description:"Un plan structuré pour analyser une porte claquée, comprendre les techniques professionnelles d’ouverture fine et éviter les erreurs irréversibles. Économisez jusqu’à 400€ de dépannage en tentant l’intervention dans le cadre légal et technique approprié.",price:100,originalPrice:500,features:["Vidéo HD : technique professionnelle sans perçage","PDF Diagnostic : vérifier si la porte est réellement claquée","Guide pratique : gestes autorisés / gestes interdits","Assistance WhatsApp incluse (validation ou STOP immédiat)"],compatibility:{valid:["Porte claquée (non verrouillée)","Porte blindée claquée sans verrouillage"],invalid:["Porte fermée à clé (verrouillée)"]},type:ie.BUNDLE,image:"/images/p1.jpg",stripePriceId:"price_1PqXyZA2eZvKYlo2kR9uWq5a",currentResource:{id:"res_p1_v1",productId:"p1_door_slammed",fileName:"Guide_Ouverture_Radio_Pro_v1.pdf",filePath:"secure-pdfs/p1/guide.pdf",fileSize:"2.4 MB",status:"published",version:1,lastUpdated:"2023-11-15T10:00:00Z"}},{id:"p2_key_broken",title:"Clé Cassée dans le Barillet",description:"Formation vidéo pour comprendre comment tenter une extraction sécurisée du fragment cassé, sans aggraver le blocage. Identifiez quand intervenir et quand arrêter pour préserver votre cylindre. Assistance WhatsApp pour validation visuelle.",price:100,originalPrice:500,features:["Vidéo HD : protocole d’extraction sécurisé","Guide PDF : cas autorisés / cas interdits","Section “STOP” : quand ne surtout pas insister","Assistance WhatsApp incluse (validation sur photo)"],compatibility:{valid:["Clé cassée visible ou accessible"],invalid:["Cylindre bloqué ou endommagé","Tentative déjà forcée"]},type:ie.BUNDLE,image:"/images/p2.jpg",stripePriceId:"price_1PqXzQB2eZvKYlo2mL8vTq4b",currentResource:{id:"res_p2_v1_draft",productId:"p2_key_broken",fileName:"Guide_Extraction_Key_DRAFT.pdf",filePath:"secure-pdfs/p2/draft.pdf",fileSize:"1.8 MB",status:"draft",version:.9,lastUpdated:"2023-12-20T14:30:00Z"}},{id:"p3_cylinder_replace",title:"Remplacer son Cylindre",description:"Tutoriel technique pour changer un cylindre standard sans erreur de mesure ni main-d’œuvre excessive. Comprendre les dimensions critiques, les outils nécessaires et les pièges à éviter. Idéal après emménagement ou mise à niveau de sécurité.",price:100,originalPrice:500,features:["Tutoriel vidéo : démontage sécurisé","PDF mesures exactes (intérieur / extérieur)","Checklist outils nécessaires (basiques)","Assistance WhatsApp en cas de doute"],compatibility:{valid:["Cylindre standard"],invalid:["Serrure spécifique ou système complexe"]},type:ie.VIDEO,image:"/images/p3.jpg",stripePriceId:"price_1PqY1RC2eZvKYlo2nN7wUr3c",currentResource:null},{id:"p4_security_pack",title:"Changer sa Serrure Complète",description:"Formation complète pour remplacer une serrure entière sans main-d’œuvre professionnelle. Maîtrisez les mesures précises, le démontage sécurisé et les critères de sélection certifiés. Gain immédiat en autonomie et budget.",price:100,originalPrice:500,features:["Mesure précise avant achat","Démontage & remontage pas à pas (Vidéo)","Guide d’achat : critères A2P (sans marque imposée)","Assistance WhatsApp incluse"],compatibility:{valid:["Remplacement simple"],invalid:["Travaux lourds ou structurels"]},type:ie.BUNDLE,image:"/images/p4.jpg",stripePriceId:"price_1PqY2SD2eZvKYlo2oP6xVs2d",currentResource:{id:"res_p4_v2",productId:"p4_security_pack",fileName:"Tuto_Remplacement_Serrure_v2.pdf",filePath:"secure-pdfs/p4/guide.pdf",fileSize:"3.1 MB",status:"published",version:2,lastUpdated:"2023-10-05T09:00:00Z"}},{id:"p5_audit_security",title:"Audit Sécurité & Renforcement",description:"Méthodologie professionnelle pour évaluer vos vulnérabilités et prioriser les renforcements efficaces sans travaux lourds. Obtenez un plan d’action personnalisé avec budget maîtrisé et assistance technique pour validation à distance.",price:100,originalPrice:500,features:["Audit guidé (photos + questionnaire)","Plan d’action priorisé (24h / 7j / 30j)","Budget maîtrisé & erreurs à éviter","Assistance WhatsApp de validation"],compatibility:{valid:["Logement ou local standard"],invalid:["Travaux de blindage structurel"]},type:ie.BUNDLE,image:"/images/p5.jpg",stripePriceId:"price_1PqY3TE2eZvKYlo2qR5yWt1e",currentResource:null},{id:"p6_survival_kit",title:"Pack : Kit de Prévention",description:"Sélection professionnelle du matériel indispensable pour gérer les situations courantes sans stress. Liste vérifiée, liens d’achat directs, aucun gadget inutile. Économie immédiate garantie.",price:29,originalPrice:145,features:["Liens d’achat directs (qualité pro)","Matériel réellement utile (pas de gadgets)","Économie immédiate"],type:ie.BUNDLE,image:"/images/p6.jpg",stripePriceId:"price_1PqY4UF2eZvKYlo2rS4zXu0f",currentResource:{id:"res_p6_kit",productId:"p6_survival_kit",fileName:"Liste_Materiel_Pro.pdf",filePath:"secure-pdfs/p6/list.pdf",fileSize:"0.5 MB",status:"published",version:1,lastUpdated:"2023-09-01T12:00:00Z"}}],ae="user_123_abc",ue=e.createContext(void 0);n.memo(({onCtaClick:t})=>{const{heroImage:n}=(()=>{const t=e.useContext(ue);if(void 0===t)throw new Error("useSettings must be used within a SettingsProvider");return t})(),o=e.useMemo(()=>le[0].image,[]);return ee.jsxs("div",{className:"relative bg-slate-950 overflow-hidden pt-10 pb-20 lg:pt-20 lg:pb-28",children:[ee.jsxs("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-full h-full z-0 pointer-events-none",children:[ee.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[500px] h-[500px] bg-orange-600/10 rounded-full blur-[120px] mix-blend-screen animate-pulse-slow"}),ee.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[600px] h-[600px] bg-indigo-600/20 rounded-full blur-[120px] mix-blend-screen"}),n&&ee.jsx("img",{src:n,className:"absolute inset-0 w-full h-full object-cover opacity-10 mix-blend-overlay",alt:"Background Texture"})]}),ee.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:ee.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 lg:gap-20 items-center",children:[ee.jsxs("div",{className:"text-left space-y-8 animate-fade-in-up",children:[ee.jsxs("div",{className:"inline-flex items-center space-x-2 bg-slate-900/80 border border-slate-700 rounded-full px-4 py-1.5 backdrop-blur-md",children:[ee.jsx(s,{className:"w-4 h-4 text-orange-500"}),ee.jsx("span",{className:"text-slate-300 text-xs font-bold tracking-wider uppercase",children:"Protocole Certifié • Non Destructif"})]}),ee.jsxs("h1",{className:"text-3xl sm:text-4xl lg:text-6xl font-extrabold text-white leading-[1.1] tracking-tight",children:["Porte claquée ? ",ee.jsx("br",{}),"La méthode officielle pour ",ee.jsx("br",{className:"hidden sm:block"}),ee.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-amber-200",children:"agir sans tout casser."})]}),ee.jsxs("p",{className:"text-base sm:text-lg text-slate-400 max-w-xl leading-relaxed",children:["Avant d'appeler un dépanneur, accédez au ",ee.jsx("strong",{children:"plan d'action vidéo"})," utilisé par les professionnels. Une solution légale et guidée pas à pas pour tenter l'ouverture vous-même."]}),ee.jsxs("div",{className:"bg-slate-900/60 border border-slate-800 rounded-xl overflow-hidden grid sm:grid-cols-2 text-sm shadow-xl",children:[ee.jsxs("div",{className:"p-5 border-b sm:border-b-0 sm:border-r border-slate-800 bg-green-900/20",children:[ee.jsxs("p",{className:"text-green-400 font-bold text-xs uppercase mb-3 flex items-center",children:[ee.jsx(m,{className:"w-4 h-4 mr-2"}),"Situation Compatible"]}),ee.jsxs("ul",{className:"space-y-2 text-slate-300",children:[ee.jsxs("li",{className:"flex items-start",children:[ee.jsx("span",{className:"mr-2 text-green-500",children:"•"})," Porte claquée (Clé oubliée à l'intérieur)"]}),ee.jsxs("li",{className:"flex items-start",children:[ee.jsx("span",{className:"mr-2 text-green-500",children:"•"})," Porte blindée claquée (non verrouillée)"]}),ee.jsxs("li",{className:"flex items-start",children:[ee.jsx("span",{className:"mr-2 text-green-500",children:"•"})," Clé cassée (morceau visible)"]})]})]}),ee.jsxs("div",{className:"p-5 bg-red-900/10",children:[ee.jsxs("p",{className:"text-red-400 font-bold text-xs uppercase mb-3 flex items-center",children:[ee.jsx(g,{className:"w-4 h-4 mr-2"}),"Strictement Impossible"]}),ee.jsxs("ul",{className:"space-y-2 text-slate-400",children:[ee.jsxs("li",{className:"flex items-start",children:[ee.jsx("span",{className:"mr-2 text-red-500",children:"•"})," Porte fermée à clé (Verrouillée)"]}),ee.jsxs("li",{className:"flex items-start",children:[ee.jsx("span",{className:"mr-2 text-red-500",children:"•"})," Serrure bloquée / vandalisée"]}),ee.jsxs("li",{className:"flex items-start",children:[ee.jsx("span",{className:"mr-2 text-red-500",children:"•"})," Perte de clé totale (si fermé à clé)"]})]})]})]}),ee.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-2",children:[ee.jsxs("button",{onClick:t,className:"group relative px-8 py-4 bg-orange-600 hover:bg-orange-500 text-white font-bold rounded-xl shadow-lg shadow-orange-900/40 transition-all hover:scale-[1.02] flex items-center justify-center overflow-hidden",children:[ee.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:animate-shimmer"}),ee.jsxs("div",{className:"flex flex-col items-start text-left",children:[ee.jsx("span",{className:"text-sm",children:"Obtenir le Protocole Vidéo"}),ee.jsx("span",{className:"text-[10px] font-normal opacity-90",children:"Accès immédiat sécurisé"})]}),ee.jsx(c,{className:"ml-4 w-5 h-5 group-hover:translate-x-1 transition-transform"})]}),ee.jsxs("div",{className:"flex items-center justify-center gap-3 px-6 py-4 rounded-xl border border-slate-700 bg-slate-800/50 backdrop-blur-sm text-slate-300",children:[ee.jsx(y,{className:"w-5 h-5 text-green-500"}),ee.jsxs("div",{className:"flex flex-col",children:[ee.jsx("span",{className:"text-sm font-bold text-white",children:"Un doute ?"}),ee.jsx("span",{className:"text-[10px] text-slate-300",children:"Diagnostic IA Gratuit"})]})]})]}),ee.jsxs("div",{className:"flex items-start gap-2 opacity-60 max-w-lg",children:[ee.jsx(v,{className:"w-3 h-3 text-slate-400 mt-0.5 flex-shrink-0"}),ee.jsxs("p",{className:"text-[10px] text-slate-400 leading-tight",children:[ee.jsx("strong",{children:"Cadre légal :"})," Service pédagogique avec obligation de moyens. Ne constitue pas une garantie d'ouverture. L'utilisateur certifie être l'occupant légitime du logement."]})]})]}),ee.jsxs("div",{className:"relative hidden lg:block perspective-1000 group",children:[ee.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[350px] h-[650px] bg-gradient-to-tr from-orange-600/30 to-blue-600/30 rounded-full blur-[60px] animate-pulse-slow"}),ee.jsx("div",{className:"relative w-[300px] mx-auto transform rotate-y-12 rotate-z-2 group-hover:rotate-y-0 group-hover:rotate-z-0 transition-all duration-700 ease-out z-10",children:ee.jsxs("div",{className:"relative h-[620px] rounded-[3rem] bg-slate-900 border-[6px] border-slate-800 shadow-2xl overflow-hidden ring-1 ring-white/10",children:[ee.jsxs("div",{className:"absolute inset-0 bg-slate-950 flex flex-col",children:[ee.jsxs("div",{className:"h-14 w-full flex justify-between items-end px-6 pb-2 text-white/80 text-[10px] font-medium z-20",children:[ee.jsx("span",{children:"09:41"}),ee.jsxs("div",{className:"flex gap-1.5",children:[ee.jsx("div",{className:"h-2.5 w-2.5 bg-white/20 rounded-full"}),ee.jsx("div",{className:"h-2.5 w-2.5 bg-white/20 rounded-full"}),ee.jsx("div",{className:"h-2.5 w-4 bg-white/80 rounded-sm"})]})]}),ee.jsxs("div",{className:"px-6 py-4 border-b border-slate-800/50 flex justify-between items-center z-20 bg-slate-950/80 backdrop-blur",children:[ee.jsxs("div",{className:"flex items-center gap-2",children:[ee.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-orange-500 to-pink-600 flex items-center justify-center shadow-lg shadow-orange-500/20",children:ee.jsx(E,{className:"w-4 h-4 text-white"})}),ee.jsx("span",{className:"font-bold text-white text-sm tracking-tight",children:"SerrureMaster"})]}),ee.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-800 border border-slate-700"})]}),ee.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[ee.jsxs("div",{className:"relative h-64 bg-slate-900 m-4 rounded-2xl overflow-hidden border border-slate-800 group-hover:border-orange-500/30 transition-colors",children:[ee.jsx("img",{src:o,className:"absolute inset-0 w-full h-full object-cover opacity-40 mix-blend-overlay",alt:"Secure Content",fetchpriority:"high"}),ee.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900 via-slate-900/50 to-transparent"}),ee.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-center p-4",children:[ee.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-900/80 backdrop-blur border border-orange-500/50 flex items-center justify-center mb-3 shadow-[0_0_15px_rgba(249,115,22,0.3)] animate-pulse",children:ee.jsx(E,{className:"w-5 h-5 text-orange-500"})}),ee.jsx("h3",{className:"text-white font-bold text-lg mb-1",children:"Guide : Porte Claquée"}),ee.jsx("p",{className:"text-orange-400 text-xs font-mono tracking-wider uppercase",children:"Contenu Sécurisé"})]}),ee.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-slate-800",children:ee.jsx("div",{className:"h-full w-1/3 bg-orange-500"})})]}),ee.jsxs("div",{className:"px-4 space-y-3",children:[ee.jsxs("div",{className:"h-16 rounded-xl bg-slate-900 border border-slate-800 flex items-center px-4 gap-3 opacity-60",children:[ee.jsx("div",{className:"w-8 h-8 rounded bg-slate-800 flex items-center justify-center",children:ee.jsx(_,{className:"w-4 h-4 text-slate-500"})}),ee.jsxs("div",{className:"flex-1",children:[ee.jsx("div",{className:"h-2 w-24 bg-slate-700 rounded mb-1.5"}),ee.jsx("div",{className:"h-1.5 w-16 bg-slate-800 rounded"})]}),ee.jsx(E,{className:"w-3 h-3 text-slate-600"})]}),ee.jsxs("div",{className:"h-16 rounded-xl bg-slate-900 border border-slate-800 flex items-center px-4 gap-3 opacity-40",children:[ee.jsx("div",{className:"w-8 h-8 rounded bg-slate-800 flex items-center justify-center",children:ee.jsx(I,{className:"w-4 h-4 text-slate-500"})}),ee.jsxs("div",{className:"flex-1",children:[ee.jsx("div",{className:"h-2 w-20 bg-slate-700 rounded mb-1.5"}),ee.jsx("div",{className:"h-1.5 w-12 bg-slate-800 rounded"})]}),ee.jsx(E,{className:"w-3 h-3 text-slate-600"})]})]}),ee.jsx("div",{className:"absolute bottom-8 left-4 right-4",children:ee.jsx("div",{className:"w-full py-3 bg-gradient-to-r from-orange-600 to-orange-500 rounded-xl text-center text-white text-xs font-bold shadow-lg shadow-orange-900/40 opacity-90",children:"Débloquer le Plan d'Action"})})]})]}),ee.jsx("div",{className:"absolute inset-0 pointer-events-none bg-gradient-to-tr from-transparent via-white/5 to-transparent rounded-[2.5rem] z-30"})]})}),ee.jsx("div",{className:"absolute top-[20%] -right-6 z-40 bg-slate-800/90 backdrop-blur border border-slate-700 p-3 rounded-xl shadow-xl animate-float delay-0",children:ee.jsxs("div",{className:"flex items-center gap-3",children:[ee.jsx("div",{className:"bg-green-500/20 p-2 rounded-full text-green-500 border border-green-500/30",children:ee.jsx(s,{className:"w-5 h-5"})}),ee.jsxs("div",{children:[ee.jsx("p",{className:"text-white text-xs font-bold",children:"Légal & Éthique"}),ee.jsx("p",{className:"text-[10px] text-slate-400",children:"Sans effraction"})]})]})}),ee.jsx("div",{className:"absolute bottom-[25%] -left-8 z-40 bg-slate-800/90 backdrop-blur border border-slate-700 p-3 rounded-xl shadow-xl animate-float delay-2000",children:ee.jsxs("div",{className:"flex items-center gap-3",children:[ee.jsx("div",{className:"bg-blue-500/20 p-2 rounded-full text-blue-400 border border-blue-500/30",children:ee.jsx(E,{className:"w-5 h-5"})}),ee.jsxs("div",{children:[ee.jsx("p",{className:"text-white text-xs font-bold",children:"Méthode Pro"}),ee.jsx("p",{className:"text-[10px] text-slate-400",children:"Accès immédiat"})]})]})})]})]})}),ee.jsx("style",{children:"\n        .perspective-1000 { perspective: 1000px; }\n        @keyframes blob {\n          0% { transform: translate(0px, 0px) scale(1); }\n          33% { transform: translate(30px, -50px) scale(1.1); }\n          66% { transform: translate(-20px, 20px) scale(0.9); }\n          100% { transform: translate(0px, 0px) scale(1); }\n        }\n        .animate-blob { animation: blob 7s infinite; }\n        .animate-shimmer { animation: shimmer 2s infinite; }\n        @keyframes shimmer { 100% { transform: translateX(100%); } }\n        @keyframes float { \n          0%, 100% { transform: translateY(0); } \n          50% { transform: translateY(-10px); } \n        }\n        .animate-float { animation: float 5s ease-in-out infinite; }\n        .rotate-y-12 { transform: rotateY(-12deg); }\n        .rotate-z-2 { transform: rotateZ(2deg); }\n      "})]})}).displayName="Hero";n.memo(({product:t,isOwned:n})=>{const{addToCart:o,items:i}=(()=>{const t=e.useContext(oe);if(void 0===t)throw new Error("useCart must be used within a CartProvider");return t})(),s=e.useMemo(()=>i.some(e=>e.id===t.id),[i,t.id]);if(!t)return null;const r=e.useMemo(()=>t.image||"/images/p1.jpg",[t.image]),l=e.useMemo(()=>t.description||"Description non disponible",[t.description]),a=e.useCallback(()=>{o(t)},[o,t]);return ee.jsxs("div",{className:"bg-white border-2 border-slate-200 rounded-2xl p-4 shadow-lg hover:shadow-2xl hover:shadow-orange-500/30 hover:border-orange-500 hover:-translate-y-3 hover:rotate-1 transition-all duration-300 flex flex-col h-full relative overflow-hidden group cursor-pointer",children:[ee.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-400/0 to-purple-400/0 group-hover:from-orange-400/20 group-hover:to-purple-400/10 transition-all duration-300 pointer-events-none rounded-2xl"}),ee.jsxs("div",{className:"h-32 sm:h-40 -mx-4 -mt-4 mb-4 overflow-hidden relative bg-gradient-to-br from-orange-50 to-purple-50 rounded-t-2xl group-hover:shadow-lg transition-all duration-300",children:[ee.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-white/80 via-transparent to-transparent z-10"}),ee.jsx("img",{src:r,alt:t.title||"Produit",decoding:"async",onError:e=>{e.target.src="/images/p1.jpg"},className:"w-full h-full object-cover grayscale-0 group-hover:grayscale-0 brightness-100 group-hover:brightness-110 saturate-100 group-hover:saturate-125 group-hover:scale-110 group-hover:rotate-2 transition-all duration-500 ease-out"})]}),ee.jsxs("div",{className:"flex-1 flex flex-col z-10",children:[ee.jsx("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-2 group-hover:text-orange-600 group-hover:translate-x-1 transition-all duration-200 line-clamp-2 min-h-[3rem] flex items-center leading-tight",children:t.title}),ee.jsx("p",{className:"text-slate-600 mb-3 text-xs sm:text-sm leading-relaxed line-clamp-3 min-h-[3.5rem]",children:l}),t.compatibility?ee.jsx("div",{className:"mb-3 bg-gradient-to-br from-slate-50 to-slate-100/50 p-3 rounded-xl border border-slate-200 flex-1 shadow-sm group-hover:border-orange-200 transition-colors duration-300",children:ee.jsxs("ul",{className:"text-xs sm:text-sm text-slate-700 space-y-1.5",children:[t.compatibility.valid.slice(0,2).map((e,t)=>ee.jsxs("li",{className:"flex gap-2 items-start",children:[ee.jsx(m,{className:"text-green-500 w-4 h-4 mt-0.5 flex-shrink-0"}),ee.jsx("span",{className:"text-slate-800 line-clamp-1",children:e})]},`v-${t}`)),t.compatibility.invalid.slice(0,1).map((e,t)=>ee.jsxs("li",{className:"flex gap-2 items-start opacity-60",children:[ee.jsx(g,{className:"text-red-400 w-4 h-4 mt-0.5 flex-shrink-0"}),ee.jsx("span",{className:"text-slate-400 line-clamp-1",children:e})]},`i-${t}`))]})}):ee.jsx("div",{className:"mb-3 flex-1 bg-slate-50 rounded-xl border border-slate-200 opacity-0"}),ee.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-2.5 text-[11px] font-semibold text-slate-700 mb-3 border border-green-200 flex items-center justify-between shadow-sm group-hover:scale-105 group-hover:shadow-md transition-all duration-200",children:ee.jsxs("span",{className:"flex items-center gap-2",children:[ee.jsx(y,{className:"text-green-600 w-4 h-4 group-hover:animate-pulse"}),"Assistance Pro incluse"]})}),ee.jsxs("div",{className:"flex items-center justify-between mt-auto pt-3 border-t-2 border-slate-100 group-hover:border-orange-200 transition-colors duration-300",children:[ee.jsxs("div",{className:"flex flex-col group-hover:scale-105 transition-transform duration-200",children:[ee.jsxs("span",{className:"text-slate-900 text-2xl sm:text-3xl font-black tracking-tight",children:[t.price," €"]}),t.originalPrice&&ee.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[ee.jsxs("span",{className:"text-slate-400 line-through text-xs font-medium",children:[t.originalPrice," €"]}),ee.jsxs("span",{className:"bg-green-100 text-green-700 text-[10px] font-bold px-1.5 py-0.5 rounded-full animate-pulse",children:["-",Math.round((t.originalPrice-t.price)/t.originalPrice*100),"%"]})]})]}),ee.jsx("button",{onClick:a,disabled:n||s,className:"px-3 sm:px-4 py-2 sm:py-2.5 rounded-lg font-bold text-xs sm:text-sm transition-all shadow-lg transform active:scale-90 flex items-center group-hover:scale-110 "+(n?"bg-gradient-to-r from-green-50 to-emerald-50 text-green-700 border-2 border-green-300 cursor-default shadow-green-200":s?"bg-gradient-to-r from-slate-100 to-slate-200 text-slate-700 border-2 border-slate-300 cursor-default shadow-slate-300":"bg-gradient-to-r from-orange-500 to-orange-600 text-white hover:from-orange-600 hover:to-orange-700 shadow-orange-500/50 hover:shadow-orange-500/80 border-2 border-orange-400 hover:rotate-3"),children:n?ee.jsxs(ee.Fragment,{children:[ee.jsx(b,{className:"w-4 h-4 mr-2"})," Acquis"]}):s?ee.jsxs(ee.Fragment,{children:[ee.jsx(m,{className:"w-4 h-4 mr-2"})," Au panier"]}):"Ajouter au panier"})]})]})]})}).displayName="ProductCard";var ce={};class de{}function pe(e,t){return e.replace(/\{([^}]+)\}/g,(e,n)=>{if(Object.prototype.hasOwnProperty.call(t,n)){const e=t[n];return null!=e?String(e):""}throw new Error(`Key '${n}' not found in valueMap.`)})}function he(e,t,n){for(let s=0;s<t.length-1;s++){const o=t[s];if(o.endsWith("[]")){const i=o.slice(0,-2);if(!(i in e)){if(!Array.isArray(n))throw new Error(`Value must be a list given an array path ${o}`);e[i]=Array.from({length:n.length},()=>({}))}if(Array.isArray(e[i])){const o=e[i];if(Array.isArray(n))for(let e=0;e<o.length;e++)he(o[e],t.slice(s+1),n[e]);else for(const e of o)he(e,t.slice(s+1),n)}return}if(o.endsWith("[0]")){const i=o.slice(0,-3);return i in e||(e[i]=[{}]),void he(e[i][0],t.slice(s+1),n)}e[o]&&"object"==typeof e[o]||(e[o]={}),e=e[o]}const o=t[t.length-1],i=e[o];if(void 0!==i){if(!n||"object"==typeof n&&0===Object.keys(n).length)return;if(n===i)return;if("object"!=typeof i||"object"!=typeof n||null===i||null===n)throw new Error(`Cannot set value for an existing key. Key: ${o}`);Object.assign(i,n)}else if("_self"!==o||"object"!=typeof n||null===n||Array.isArray(n))e[o]=n;else{const t=n;Object.assign(e,t)}}function fe(e,t,n=void 0){try{if(1===t.length&&"_self"===t[0])return e;for(let o=0;o<t.length;o++){if("object"!=typeof e||null===e)return n;const i=t[o];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in e){const i=e[s];return Array.isArray(i)?i.map(e=>fe(e,t.slice(o+1),n)):n}return n}e=e[i]}return e}catch(o){if(o instanceof TypeError)return n;throw o}}function me(e,t,n,o,i){if(o>=t.length)return;if("object"!=typeof e||null===e)return;const s=t[o];if(s.endsWith("[]")){const r=s.slice(0,-2),l=e;if(r in l&&Array.isArray(l[r]))for(const e of l[r])me(e,t,n,o+1,i)}else if("*"===s){if("object"==typeof e&&null!==e&&!Array.isArray(e)){const t=e,s=Object.keys(t).filter(e=>!e.startsWith("_")&&!i.has(e)),r={};for(const e of s)r[e]=t[e];for(const[e,i]of Object.entries(r)){const s=[];for(const t of n.slice(o))"*"===t?s.push(e):s.push(t);he(t,s,i)}for(const e of s)delete t[e]}}else s in e&&me(e[s],t,n,o+1,i)}function ge(e){if("string"!=typeof e)throw new Error("fromImageBytes must be a string");return e}function ye(e){const t={},n=fe(e,["name"]);null!=n&&he(t,["name"],n);const o=fe(e,["metadata"]);null!=o&&he(t,["metadata"],o);const i=fe(e,["done"]);null!=i&&he(t,["done"],i);const s=fe(e,["error"]);null!=s&&he(t,["error"],s);const r=fe(e,["response"]);return null!=r&&he(t,["response"],function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["parent"]);null!=o&&he(t,["parent"],o);const i=fe(e,["documentName"]);return null!=i&&he(t,["documentName"],i),t}(r)),t}var ve,Ee,_e,Ie,be,Ae,Te,Se,Oe,Ce,we,Ne,Re,xe,Pe,De,Me,Ue,je,ke,qe,Le,Ge,He,Fe,Ve,Be,Je,Ye,$e,We,Ke,ze,Xe,Qe,Ze,et,tt,nt,ot,it,st,rt,lt,at,ut,ct,dt,pt,ht,ft,mt,gt,yt,vt,Et,_t,It,bt,At,Tt,St,Ot,Ct,wt,Nt,Rt,xt,Pt,Dt,Mt,Ut,jt,kt,qt,Lt,Gt,Ht,Ft,Vt,Bt,Jt,Yt,$t,Wt,Kt,zt,Xt,Qt,Zt,en,tn,nn,on,sn,rn,ln,an,un,cn,dn,pn,hn,fn,mn,gn,yn,vn,En,_n,In,bn,An,Tn;(Ee=ve||(ve={})).OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",Ee.OUTCOME_OK="OUTCOME_OK",Ee.OUTCOME_FAILED="OUTCOME_FAILED",Ee.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED",(Ie=_e||(_e={})).LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",Ie.PYTHON="PYTHON",(Ae=be||(be={})).SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",Ae.SILENT="SILENT",Ae.WHEN_IDLE="WHEN_IDLE",Ae.INTERRUPT="INTERRUPT",(Se=Te||(Te={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",Se.STRING="STRING",Se.NUMBER="NUMBER",Se.INTEGER="INTEGER",Se.BOOLEAN="BOOLEAN",Se.ARRAY="ARRAY",Se.OBJECT="OBJECT",Se.NULL="NULL",(Ce=Oe||(Oe={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",Ce.MODE_DYNAMIC="MODE_DYNAMIC",(Ne=we||(we={})).API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",Ne.SIMPLE_SEARCH="SIMPLE_SEARCH",Ne.ELASTIC_SEARCH="ELASTIC_SEARCH",(xe=Re||(Re={})).AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",xe.NO_AUTH="NO_AUTH",xe.API_KEY_AUTH="API_KEY_AUTH",xe.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",xe.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",xe.OAUTH="OAUTH",xe.OIDC_AUTH="OIDC_AUTH",(De=Pe||(Pe={})).HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",De.HTTP_IN_QUERY="HTTP_IN_QUERY",De.HTTP_IN_HEADER="HTTP_IN_HEADER",De.HTTP_IN_PATH="HTTP_IN_PATH",De.HTTP_IN_BODY="HTTP_IN_BODY",De.HTTP_IN_COOKIE="HTTP_IN_COOKIE",(Ue=Me||(Me={})).PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",Ue.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",Ue.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",Ue.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",Ue.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",Ue.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",Ue.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH",(ke=je||(je={})).THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",ke.LOW="LOW",ke.MEDIUM="MEDIUM",ke.HIGH="HIGH",ke.MINIMAL="MINIMAL",(Le=qe||(qe={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",Le.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",Le.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",Le.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",Le.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",Le.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",Le.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",Le.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",Le.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",Le.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",Le.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK",(He=Ge||(Ge={})).HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",He.SEVERITY="SEVERITY",He.PROBABILITY="PROBABILITY",(Ve=Fe||(Fe={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",Ve.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",Ve.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",Ve.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",Ve.BLOCK_NONE="BLOCK_NONE",Ve.OFF="OFF",(Je=Be||(Be={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",Je.STOP="STOP",Je.MAX_TOKENS="MAX_TOKENS",Je.SAFETY="SAFETY",Je.RECITATION="RECITATION",Je.LANGUAGE="LANGUAGE",Je.OTHER="OTHER",Je.BLOCKLIST="BLOCKLIST",Je.PROHIBITED_CONTENT="PROHIBITED_CONTENT",Je.SPII="SPII",Je.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",Je.IMAGE_SAFETY="IMAGE_SAFETY",Je.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",Je.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",Je.NO_IMAGE="NO_IMAGE",Je.IMAGE_RECITATION="IMAGE_RECITATION",Je.IMAGE_OTHER="IMAGE_OTHER",($e=Ye||(Ye={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",$e.NEGLIGIBLE="NEGLIGIBLE",$e.LOW="LOW",$e.MEDIUM="MEDIUM",$e.HIGH="HIGH",(Ke=We||(We={})).HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",Ke.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",Ke.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",Ke.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",Ke.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH",(Xe=ze||(ze={})).URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",Xe.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",Xe.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",Xe.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",Xe.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE",(Ze=Qe||(Qe={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",Ze.SAFETY="SAFETY",Ze.OTHER="OTHER",Ze.BLOCKLIST="BLOCKLIST",Ze.PROHIBITED_CONTENT="PROHIBITED_CONTENT",Ze.IMAGE_SAFETY="IMAGE_SAFETY",Ze.MODEL_ARMOR="MODEL_ARMOR",Ze.JAILBREAK="JAILBREAK",(tt=et||(et={})).TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",tt.ON_DEMAND="ON_DEMAND",tt.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT",(ot=nt||(nt={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",ot.TEXT="TEXT",ot.IMAGE="IMAGE",ot.AUDIO="AUDIO",(st=it||(it={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",st.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",st.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",st.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(lt=rt||(rt={})).TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",lt.TUNING_MODE_FULL="TUNING_MODE_FULL",lt.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER",(ut=at||(at={})).ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",ut.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",ut.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",ut.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",ut.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",ut.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",ut.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO",(dt=ct||(ct={})).JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",dt.JOB_STATE_QUEUED="JOB_STATE_QUEUED",dt.JOB_STATE_PENDING="JOB_STATE_PENDING",dt.JOB_STATE_RUNNING="JOB_STATE_RUNNING",dt.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",dt.JOB_STATE_FAILED="JOB_STATE_FAILED",dt.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",dt.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",dt.JOB_STATE_PAUSED="JOB_STATE_PAUSED",dt.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",dt.JOB_STATE_UPDATING="JOB_STATE_UPDATING",dt.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",(ht=pt||(pt={})).TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",ht.TUNING_TASK_I2V="TUNING_TASK_I2V",ht.TUNING_TASK_T2V="TUNING_TASK_T2V",ht.TUNING_TASK_R2V="TUNING_TASK_R2V",(mt=ft||(ft={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",mt.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",mt.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",mt.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",mt.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH",(yt=gt||(gt={})).FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",yt.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",yt.BALANCED="BALANCED",yt.PRIORITIZE_COST="PRIORITIZE_COST",(Et=vt||(vt={})).UNSPECIFIED="UNSPECIFIED",Et.BLOCKING="BLOCKING",Et.NON_BLOCKING="NON_BLOCKING",(It=_t||(_t={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",It.MODE_DYNAMIC="MODE_DYNAMIC",(At=bt||(bt={})).ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",At.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER",(St=Tt||(Tt={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",St.AUTO="AUTO",St.ANY="ANY",St.NONE="NONE",St.VALIDATED="VALIDATED",(Ct=Ot||(Ot={})).BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",Ct.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",Ct.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",Ct.BLOCK_NONE="BLOCK_NONE",(Nt=wt||(wt={})).DONT_ALLOW="DONT_ALLOW",Nt.ALLOW_ADULT="ALLOW_ADULT",Nt.ALLOW_ALL="ALLOW_ALL",(xt=Rt||(Rt={})).auto="auto",xt.en="en",xt.ja="ja",xt.ko="ko",xt.hi="hi",xt.zh="zh",xt.pt="pt",xt.es="es",(Dt=Pt||(Pt={})).MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",Dt.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",Dt.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",Dt.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",Dt.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC",(Ut=Mt||(Mt={})).CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",Ut.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",Ut.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",Ut.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH",(kt=jt||(jt={})).SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",kt.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",kt.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",kt.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT",(Lt=qt||(qt={})).EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",Lt.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",Lt.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",Lt.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",Lt.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",Lt.EDIT_MODE_STYLE="EDIT_MODE_STYLE",Lt.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",Lt.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE",(Ht=Gt||(Gt={})).FOREGROUND="FOREGROUND",Ht.BACKGROUND="BACKGROUND",Ht.PROMPT="PROMPT",Ht.SEMANTIC="SEMANTIC",Ht.INTERACTIVE="INTERACTIVE",(Vt=Ft||(Ft={})).ASSET="ASSET",Vt.STYLE="STYLE",(Jt=Bt||(Bt={})).INSERT="INSERT",Jt.REMOVE="REMOVE",Jt.REMOVE_STATIC="REMOVE_STATIC",Jt.OUTPAINT="OUTPAINT",($t=Yt||(Yt={})).OPTIMIZED="OPTIMIZED",$t.LOSSLESS="LOSSLESS",(Kt=Wt||(Wt={})).SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",Kt.PREFERENCE_TUNING="PREFERENCE_TUNING",(Xt=zt||(zt={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",Xt.STATE_PENDING="STATE_PENDING",Xt.STATE_ACTIVE="STATE_ACTIVE",Xt.STATE_FAILED="STATE_FAILED",(Zt=Qt||(Qt={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",Zt.PROCESSING="PROCESSING",Zt.ACTIVE="ACTIVE",Zt.FAILED="FAILED",(tn=en||(en={})).SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",tn.UPLOADED="UPLOADED",tn.GENERATED="GENERATED",(on=nn||(nn={})).TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",on.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",on.RESPONSE_REJECTED="RESPONSE_REJECTED",on.NEED_MORE_INPUT="NEED_MORE_INPUT",(rn=sn||(sn={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",rn.TEXT="TEXT",rn.IMAGE="IMAGE",rn.VIDEO="VIDEO",rn.AUDIO="AUDIO",rn.DOCUMENT="DOCUMENT",(an=ln||(ln={})).VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",an.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",an.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS",(cn=un||(un={})).START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",cn.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",cn.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW",(pn=dn||(dn={})).END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",pn.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",pn.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW",(fn=hn||(hn={})).ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",fn.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",fn.NO_INTERRUPTION="NO_INTERRUPTION",(gn=mn||(mn={})).TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",gn.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",gn.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT",(vn=yn||(yn={})).SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",vn.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",vn.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",vn.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",vn.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",vn.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",vn.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",vn.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",vn.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",vn.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",vn.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",vn.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",vn.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR",(_n=En||(En={})).MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",_n.QUALITY="QUALITY",_n.DIVERSITY="DIVERSITY",_n.VOCALIZATION="VOCALIZATION",(bn=In||(In={})).PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",bn.PLAY="PLAY",bn.PAUSE="PAUSE",bn.STOP="STOP",bn.RESET_CONTEXT="RESET_CONTEXT";class Sn{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class On{get text(){var e,t,n,o,i,s,r,l;if(0===(null===(o=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length;let a="",u=!1;const c=[];for(const d of null!==(l=null===(r=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===r?void 0:r.parts)&&void 0!==l?l:[]){for(const[e,t]of Object.entries(d))"text"===e||"thought"===e||"thoughtSignature"===e||null===t&&void 0===t||c.push(e);if("string"==typeof d.text){if("boolean"==typeof d.thought&&d.thought)continue;u=!0,a+=d.text}}return c.length,u?a:void 0}get data(){var e,t,n,o,i,s,r,l;if(0===(null===(o=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length;let a="";const u=[];for(const c of null!==(l=null===(r=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===r?void 0:r.parts)&&void 0!==l?l:[]){for(const[e,t]of Object.entries(c))"inlineData"===e||null===t&&void 0===t||u.push(e);c.inlineData&&"string"==typeof c.inlineData.data&&(a+=atob(c.inlineData.data))}return u.length,a.length>0?btoa(a):void 0}get functionCalls(){var e,t,n,o,i,s,r,l;if(0===(null===(o=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length;const a=null===(l=null===(r=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===r?void 0:r.parts)||void 0===l?void 0:l.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);return 0!==(null==a?void 0:a.length)?a:void 0}get executableCode(){var e,t,n,o,i,s,r,l,a;if(0===(null===(o=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length;const u=null===(l=null===(r=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===r?void 0:r.parts)||void 0===l?void 0:l.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);return 0!==(null==u?void 0:u.length)?null===(a=null==u?void 0:u[0])||void 0===a?void 0:a.code:void 0}get codeExecutionResult(){var e,t,n,o,i,s,r,l,a;if(0===(null===(o=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===o?void 0:o.length))return;this.candidates&&this.candidates.length;const u=null===(l=null===(r=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===r?void 0:r.parts)||void 0===l?void 0:l.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);return 0!==(null==u?void 0:u.length)?null===(a=null==u?void 0:u[0])||void 0===a?void 0:a.output:void 0}}class Cn{}class wn{}class Nn{}class Rn{}class xn{}class Pn{}class Dn{}class Mn{}class Un{}class jn{}class kn{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new kn;let o;const i=e;return o=t?function(e){const t={},n=fe(e,["name"]);null!=n&&he(t,["name"],n);const o=fe(e,["metadata"]);null!=o&&he(t,["metadata"],o);const i=fe(e,["done"]);null!=i&&he(t,["done"],i);const s=fe(e,["error"]);null!=s&&he(t,["error"],s);const r=fe(e,["response"]);return null!=r&&he(t,["response"],function(e){const t={},n=fe(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["_self"]);return null!=n&&he(t,["video"],function(e){const t={},n=fe(e,["gcsUri"]);null!=n&&he(t,["uri"],n);const o=fe(e,["bytesBase64Encoded"]);null!=o&&he(t,["videoBytes"],ge(o));const i=fe(e,["mimeType"]);return null!=i&&he(t,["mimeType"],i),t}(n)),t}(e))),he(t,["generatedVideos"],e)}const o=fe(e,["raiMediaFilteredCount"]);null!=o&&he(t,["raiMediaFilteredCount"],o);const i=fe(e,["raiMediaFilteredReasons"]);return null!=i&&he(t,["raiMediaFilteredReasons"],i),t}(r)),t}(i):function(e){const t={},n=fe(e,["name"]);null!=n&&he(t,["name"],n);const o=fe(e,["metadata"]);null!=o&&he(t,["metadata"],o);const i=fe(e,["done"]);null!=i&&he(t,["done"],i);const s=fe(e,["error"]);null!=s&&he(t,["error"],s);const r=fe(e,["response","generateVideoResponse"]);return null!=r&&he(t,["response"],function(e){const t={},n=fe(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["video"]);return null!=n&&he(t,["video"],function(e){const t={},n=fe(e,["uri"]);null!=n&&he(t,["uri"],n);const o=fe(e,["encodedVideo"]);null!=o&&he(t,["videoBytes"],ge(o));const i=fe(e,["encoding"]);return null!=i&&he(t,["mimeType"],i),t}(n)),t}(e))),he(t,["generatedVideos"],e)}const o=fe(e,["raiMediaFilteredCount"]);null!=o&&he(t,["raiMediaFilteredCount"],o);const i=fe(e,["raiMediaFilteredReasons"]);return null!=i&&he(t,["raiMediaFilteredReasons"],i),t}(r)),t}(i),Object.assign(n,o),n}}class qn{}class Ln{}class Gn{}class Hn{}class Fn{}class Vn{}class Bn{}class Jn{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new Jn,o=function(e){const t={},n=fe(e,["name"]);null!=n&&he(t,["name"],n);const o=fe(e,["metadata"]);null!=o&&he(t,["metadata"],o);const i=fe(e,["done"]);null!=i&&he(t,["done"],i);const s=fe(e,["error"]);null!=s&&he(t,["error"],s);const r=fe(e,["response"]);return null!=r&&he(t,["response"],function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["parent"]);null!=o&&he(t,["parent"],o);const i=fe(e,["documentName"]);return null!=i&&he(t,["documentName"],i),t}(r)),t}(e);return Object.assign(n,o),n}}class Yn{}class $n{}class Wn{}class Kn{}class zn{get text(){var e,t,n;let o="",i=!1;const s=[];for(const r of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(const[e,t]of Object.entries(r))"text"!==e&&"thought"!==e&&null!==t&&s.push(e);if("string"==typeof r.text){if("boolean"==typeof r.thought&&r.thought)continue;i=!0,o+=r.text}}return s.length,i?o:void 0}get data(){var e,t,n;let o="";const i=[];for(const s of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(const[e,t]of Object.entries(s))"inlineData"!==e&&null!==t&&i.push(e);s.inlineData&&"string"==typeof s.inlineData.data&&(o+=atob(s.inlineData.data))}return i.length,o.length>0?btoa(o):void 0}}class Xn{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Qn{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new Qn,o=ye(e);return Object.assign(n,o),n}}function Zn(e,t){if(!t||"string"!=typeof t)throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}return`publishers/google/models/${t}`}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function eo(e,t){const n=Zn(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function to(e){return Array.isArray(e)?e.map(e=>no(e)):[no(e)]}function no(e){if("object"==typeof e&&null!==e)return e;throw new Error("Could not parse input as Blob. Unsupported blob type: "+typeof e)}function oo(e){const t=no(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function io(e){const t=no(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function so(e){if(null==e)throw new Error("PartUnion is required");if("object"==typeof e)return e;if("string"==typeof e)return{text:e};throw new Error("Unsupported part type: "+typeof e)}function ro(e){if(null==e||Array.isArray(e)&&0===e.length)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(e=>so(e)):[so(e)]}function lo(e){return null!=e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts)}function ao(e){return null!=e&&"object"==typeof e&&"functionCall"in e}function uo(e){return null!=e&&"object"==typeof e&&"functionResponse"in e}function co(e){if(null==e)throw new Error("ContentUnion is required");return lo(e)?e:{role:"user",parts:ro(e)}}function po(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{const t=co(e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]});if(e.isVertexAI()){const e=co(t);return e.parts&&e.parts.length>0&&void 0!==e.parts[0].text?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>co(e)):[co(t)]}function ho(e){if(null==e||Array.isArray(e)&&0===e.length)throw new Error("contents are required");if(!Array.isArray(e)){if(ao(e)||uo(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[co(e)]}const t=[],n=[],o=lo(e[0]);for(const i of e){const e=lo(i);if(e!=o)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(e)t.push(i);else{if(ao(i)||uo(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return o||t.push({role:"user",parts:ro(n)}),t}function fo(e){const t={},n=["items"],o=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=e.anyOf;null!=s&&2==s.length&&("null"===s[0].type?(t.nullable=!0,e=s[1]):"null"===s[1].type&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&function(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(e=>"null"!==e);if(1===n.length)t.type=Object.values(Te).includes(n[0].toUpperCase())?n[0].toUpperCase():Te.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const e of n)t.anyOf.push({type:Object.values(Te).includes(e.toUpperCase())?e.toUpperCase():Te.TYPE_UNSPECIFIED})}}(e.type,t);for(const[r,l]of Object.entries(e))if(null!=l)if("type"==r){if("null"===l)throw new Error("type: null can not be the only possible type for the field.");if(l instanceof Array)continue;t.type=Object.values(Te).includes(l.toUpperCase())?l.toUpperCase():Te.TYPE_UNSPECIFIED}else if(n.includes(r))t[r]=fo(l);else if(o.includes(r)){const e=[];for(const n of l)"null"!=n.type?e.push(fo(n)):t.nullable=!0;t[r]=e}else if(i.includes(r)){const e={};for(const[t,n]of Object.entries(l))e[t]=fo(n);t[r]=e}else{if("additionalProperties"===r)continue;t[r]=l}return t}function mo(e){return fo(e)}function go(e){if("object"==typeof e)return e;if("string"==typeof e)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error("Unsupported speechConfig type: "+typeof e)}function yo(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function vo(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=fo(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=fo(t.response));return e}function Eo(e){if(null==e)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function _o(e,t){if("string"!=typeof t)throw new Error("name must be a string");return function(e,t,n,o=1){const i=!t.startsWith(`${n}/`)&&t.split("/").length===o;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:i?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:i?`${n}/${t}`:t}(e,t,"cachedContents")}function Io(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function bo(e){return ge(e)}function Ao(e){var t;let n;var o;if(null!=(o=e)&&"object"==typeof o&&"name"in o&&(n=e.name),!(function(e){return null!=e&&"object"==typeof e&&"uri"in e}(e)&&(n=e.uri,void 0===n)||function(e){return null!=e&&"object"==typeof e&&"video"in e}(e)&&(n=null===(t=e.video)||void 0===t?void 0:t.uri,void 0===n))){if("string"==typeof e&&(n=e),void 0===n)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const e=n.split("files/")[1].match(/[a-z0-9]+/);if(null===e)throw new Error(`Could not extract file name from URI ${n}`);n=e[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function To(e,t){let n;return n=e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels",n}function So(e){for(const t of["models","tunedModels","publisherModels"])if(Oo(e,t))return e[t];return[]}function Oo(e,t){return null!==e&&"object"==typeof e&&t in e}function Co(e,t={}){const n=e,o={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(o.responseJsonSchema=n.outputSchema),t.behavior&&(o.behavior=t.behavior),{functionDeclarations:[o]}}function wo(e,t){let n;if("string"==typeof t)if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else{if(!t.startsWith("bq://"))throw new Error(`Unsupported string source for Vertex AI: ${t}`);n={format:"bigquery",bigqueryUri:t}}else{if(!t.startsWith("files/"))throw new Error(`Unsupported string source for Gemini API: ${t}`);n={fileName:t}}else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;const o=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(i>0||1!==o)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(o>0||1!==i)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function No(e){if("object"!=typeof e||null===e)return{};const t=e,n=t.inlinedResponses;if("object"!=typeof n||null===n)return e;const o=n.inlinedResponses;if(!Array.isArray(o)||0===o.length)return e;let i=!1;for(const s of o){if("object"!=typeof s||null===s)continue;const e=s.response;if("object"==typeof e&&null!==e&&void 0!==e.embedding){i=!0;break}}return i&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function Ro(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function xo(e){return"BATCH_STATE_UNSPECIFIED"===e?"JOB_STATE_UNSPECIFIED":"BATCH_STATE_PENDING"===e?"JOB_STATE_PENDING":"BATCH_STATE_RUNNING"===e?"JOB_STATE_RUNNING":"BATCH_STATE_SUCCEEDED"===e?"JOB_STATE_SUCCEEDED":"BATCH_STATE_FAILED"===e?"JOB_STATE_FAILED":"BATCH_STATE_CANCELLED"===e?"JOB_STATE_CANCELLED":"BATCH_STATE_EXPIRED"===e?"JOB_STATE_EXPIRED":e}function Po(e){const t={},n=fe(e,["name"]);null!=n&&he(t,["name"],n);const o=fe(e,["metadata","displayName"]);null!=o&&he(t,["displayName"],o);const i=fe(e,["metadata","state"]);null!=i&&he(t,["state"],xo(i));const s=fe(e,["metadata","createTime"]);null!=s&&he(t,["createTime"],s);const r=fe(e,["metadata","endTime"]);null!=r&&he(t,["endTime"],r);const l=fe(e,["metadata","updateTime"]);null!=l&&he(t,["updateTime"],l);const a=fe(e,["metadata","model"]);null!=a&&he(t,["model"],a);const u=fe(e,["metadata","output"]);return null!=u&&he(t,["dest"],function(e){const t={},n=fe(e,["responsesFile"]);null!=n&&he(t,["fileName"],n);const o=fe(e,["inlinedResponses","inlinedResponses"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["response"]);null!=n&&he(t,["response"],function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["candidates"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["content"]);null!=n&&he(t,["content"],n);const o=fe(e,["citationMetadata"]);null!=o&&he(t,["citationMetadata"],function(e){const t={},n=fe(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["citations"],e)}return t}(o));const i=fe(e,["tokenCount"]);null!=i&&he(t,["tokenCount"],i);const s=fe(e,["finishReason"]);null!=s&&he(t,["finishReason"],s);const r=fe(e,["avgLogprobs"]);null!=r&&he(t,["avgLogprobs"],r);const l=fe(e,["groundingMetadata"]);null!=l&&he(t,["groundingMetadata"],l);const a=fe(e,["index"]);null!=a&&he(t,["index"],a);const u=fe(e,["logprobsResult"]);null!=u&&he(t,["logprobsResult"],u);const c=fe(e,["safetyRatings"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["safetyRatings"],e)}const d=fe(e,["urlContextMetadata"]);return null!=d&&he(t,["urlContextMetadata"],d),t}(e))),he(t,["candidates"],e)}const i=fe(e,["modelVersion"]);null!=i&&he(t,["modelVersion"],i);const s=fe(e,["promptFeedback"]);null!=s&&he(t,["promptFeedback"],s);const r=fe(e,["responseId"]);null!=r&&he(t,["responseId"],r);const l=fe(e,["usageMetadata"]);return null!=l&&he(t,["usageMetadata"],l),t}(n));const o=fe(e,["error"]);return null!=o&&he(t,["error"],o),t}(e))),he(t,["inlinedResponses"],e)}const i=fe(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["inlinedEmbedContentResponses"],e)}return t}(No(u))),t}function Do(e){const t={},n=fe(e,["name"]);null!=n&&he(t,["name"],n);const o=fe(e,["displayName"]);null!=o&&he(t,["displayName"],o);const i=fe(e,["state"]);null!=i&&he(t,["state"],xo(i));const s=fe(e,["error"]);null!=s&&he(t,["error"],s);const r=fe(e,["createTime"]);null!=r&&he(t,["createTime"],r);const l=fe(e,["startTime"]);null!=l&&he(t,["startTime"],l);const a=fe(e,["endTime"]);null!=a&&he(t,["endTime"],a);const u=fe(e,["updateTime"]);null!=u&&he(t,["updateTime"],u);const c=fe(e,["model"]);null!=c&&he(t,["model"],c);const d=fe(e,["inputConfig"]);null!=d&&he(t,["src"],function(e){const t={},n=fe(e,["instancesFormat"]);null!=n&&he(t,["format"],n);const o=fe(e,["gcsSource","uris"]);null!=o&&he(t,["gcsUri"],o);const i=fe(e,["bigquerySource","inputUri"]);return null!=i&&he(t,["bigqueryUri"],i),t}(d));const p=fe(e,["outputConfig"]);null!=p&&he(t,["dest"],function(e){const t={},n=fe(e,["predictionsFormat"]);null!=n&&he(t,["format"],n);const o=fe(e,["gcsDestination","outputUriPrefix"]);null!=o&&he(t,["gcsUri"],o);const i=fe(e,["bigqueryDestination","outputUri"]);return null!=i&&he(t,["bigqueryUri"],i),t}(No(p)));const h=fe(e,["completionStats"]);return null!=h&&he(t,["completionStats"],h),t}function Mo(e){const t={},n=fe(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["mediaResolution"]);null!=n&&he(t,["mediaResolution"],n);const o=fe(e,["codeExecutionResult"]);null!=o&&he(t,["codeExecutionResult"],o);const i=fe(e,["executableCode"]);null!=i&&he(t,["executableCode"],i);const s=fe(e,["fileData"]);null!=s&&he(t,["fileData"],function(e){const t={};if(void 0!==fe(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=fe(e,["fileUri"]);null!=n&&he(t,["fileUri"],n);const o=fe(e,["mimeType"]);return null!=o&&he(t,["mimeType"],o),t}(s));const r=fe(e,["functionCall"]);null!=r&&he(t,["functionCall"],function(e){const t={},n=fe(e,["id"]);null!=n&&he(t,["id"],n);const o=fe(e,["args"]);null!=o&&he(t,["args"],o);const i=fe(e,["name"]);if(null!=i&&he(t,["name"],i),void 0!==fe(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==fe(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(r));const l=fe(e,["functionResponse"]);null!=l&&he(t,["functionResponse"],l);const a=fe(e,["inlineData"]);null!=a&&he(t,["inlineData"],function(e){const t={},n=fe(e,["data"]);if(null!=n&&he(t,["data"],n),void 0!==fe(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const o=fe(e,["mimeType"]);return null!=o&&he(t,["mimeType"],o),t}(a));const u=fe(e,["text"]);null!=u&&he(t,["text"],u);const c=fe(e,["thought"]);null!=c&&he(t,["thought"],c);const d=fe(e,["thoughtSignature"]);null!=d&&he(t,["thoughtSignature"],d);const p=fe(e,["videoMetadata"]);return null!=p&&he(t,["videoMetadata"],p),t}(e))),he(t,["parts"],e)}const o=fe(e,["role"]);return null!=o&&he(t,["role"],o),t}function Uo(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["src"]);null!=i&&he(n,["batch","inputConfig"],function(e,t){const n={};if(void 0!==fe(t,["format"]))throw new Error("format parameter is not supported in Gemini API.");if(void 0!==fe(t,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==fe(t,["bigqueryUri"]))throw new Error("bigqueryUri parameter is not supported in Gemini API.");const o=fe(t,["fileName"]);null!=o&&he(n,["fileName"],o);const i=fe(t,["inlinedRequests"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["request","model"],Zn(e,o));const i=fe(t,["contents"]);if(null!=i){let e=ho(i);Array.isArray(e)&&(e=e.map(e=>Mo(e))),he(n,["request","contents"],e)}const s=fe(t,["metadata"]);null!=s&&he(n,["metadata"],s);const r=fe(t,["config"]);return null!=r&&he(n,["request","generationConfig"],function(e,t,n){const o={},i=fe(t,["systemInstruction"]);void 0!==n&&null!=i&&he(n,["systemInstruction"],Mo(co(i)));const s=fe(t,["temperature"]);null!=s&&he(o,["temperature"],s);const r=fe(t,["topP"]);null!=r&&he(o,["topP"],r);const l=fe(t,["topK"]);null!=l&&he(o,["topK"],l);const a=fe(t,["candidateCount"]);null!=a&&he(o,["candidateCount"],a);const u=fe(t,["maxOutputTokens"]);null!=u&&he(o,["maxOutputTokens"],u);const c=fe(t,["stopSequences"]);null!=c&&he(o,["stopSequences"],c);const d=fe(t,["responseLogprobs"]);null!=d&&he(o,["responseLogprobs"],d);const p=fe(t,["logprobs"]);null!=p&&he(o,["logprobs"],p);const h=fe(t,["presencePenalty"]);null!=h&&he(o,["presencePenalty"],h);const f=fe(t,["frequencyPenalty"]);null!=f&&he(o,["frequencyPenalty"],f);const m=fe(t,["seed"]);null!=m&&he(o,["seed"],m);const g=fe(t,["responseMimeType"]);null!=g&&he(o,["responseMimeType"],g);const y=fe(t,["responseSchema"]);null!=y&&he(o,["responseSchema"],mo(y));const v=fe(t,["responseJsonSchema"]);if(null!=v&&he(o,["responseJsonSchema"],v),void 0!==fe(t,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==fe(t,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const E=fe(t,["safetySettings"]);if(void 0!==n&&null!=E){let e=E;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["category"]);if(null!=n&&he(t,["category"],n),void 0!==fe(e,["method"]))throw new Error("method parameter is not supported in Gemini API.");const o=fe(e,["threshold"]);return null!=o&&he(t,["threshold"],o),t}(e))),he(n,["safetySettings"],e)}const _=fe(t,["tools"]);if(void 0!==n&&null!=_){let e=Eo(_);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["functionDeclarations"],e)}if(void 0!==fe(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const o=fe(e,["googleSearchRetrieval"]);null!=o&&he(t,["googleSearchRetrieval"],o);const i=fe(e,["computerUse"]);null!=i&&he(t,["computerUse"],i);const s=fe(e,["fileSearch"]);null!=s&&he(t,["fileSearch"],s);const r=fe(e,["codeExecution"]);if(null!=r&&he(t,["codeExecution"],r),void 0!==fe(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=fe(e,["googleMaps"]);null!=l&&he(t,["googleMaps"],function(e){const t={};if(void 0!==fe(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=fe(e,["enableWidget"]);return null!=n&&he(t,["enableWidget"],n),t}(l));const a=fe(e,["googleSearch"]);null!=a&&he(t,["googleSearch"],function(e){const t={};if(void 0!==fe(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==fe(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=fe(e,["timeRangeFilter"]);return null!=n&&he(t,["timeRangeFilter"],n),t}(a));const u=fe(e,["urlContext"]);return null!=u&&he(t,["urlContext"],u),t}(vo(e)))),he(n,["tools"],e)}const I=fe(t,["toolConfig"]);if(void 0!==n&&null!=I&&he(n,["toolConfig"],function(e){const t={},n=fe(e,["functionCallingConfig"]);null!=n&&he(t,["functionCallingConfig"],function(e){const t={},n=fe(e,["mode"]);null!=n&&he(t,["mode"],n);const o=fe(e,["allowedFunctionNames"]);if(null!=o&&he(t,["allowedFunctionNames"],o),void 0!==fe(e,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(n));const o=fe(e,["retrievalConfig"]);return null!=o&&he(t,["retrievalConfig"],o),t}(I)),void 0!==fe(t,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const b=fe(t,["cachedContent"]);void 0!==n&&null!=b&&he(n,["cachedContent"],_o(e,b));const A=fe(t,["responseModalities"]);null!=A&&he(o,["responseModalities"],A);const T=fe(t,["mediaResolution"]);null!=T&&he(o,["mediaResolution"],T);const S=fe(t,["speechConfig"]);if(null!=S&&he(o,["speechConfig"],go(S)),void 0!==fe(t,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const O=fe(t,["thinkingConfig"]);null!=O&&he(o,["thinkingConfig"],O);const C=fe(t,["imageConfig"]);null!=C&&he(o,["imageConfig"],function(e){const t={},n=fe(e,["aspectRatio"]);null!=n&&he(t,["aspectRatio"],n);const o=fe(e,["imageSize"]);if(null!=o&&he(t,["imageSize"],o),void 0!==fe(e,["outputMimeType"]))throw new Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==fe(e,["outputCompressionQuality"]))throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(C));const w=fe(t,["enableEnhancedCivicAnswers"]);return null!=w&&he(o,["enableEnhancedCivicAnswers"],w),o}(e,r,fe(n,["request"],{}))),n}(e,t))),he(n,["requests","requests"],t)}return n}(e,wo(e,i)));const s=fe(t,["config"]);return null!=s&&function(e,t){const n=fe(e,["displayName"]);if(void 0!==t&&null!=n&&he(t,["batch","displayName"],n),void 0!==fe(e,["dest"]))throw new Error("dest parameter is not supported in Gemini API.")}(s,n),n}function jo(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["model"],Zn(e,o));const i=fe(t,["src"]);null!=i&&he(n,["inputConfig"],function(e){const t={},n=fe(e,["format"]);null!=n&&he(t,["instancesFormat"],n);const o=fe(e,["gcsUri"]);null!=o&&he(t,["gcsSource","uris"],o);const i=fe(e,["bigqueryUri"]);if(null!=i&&he(t,["bigquerySource","inputUri"],i),void 0!==fe(e,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==fe(e,["inlinedRequests"]))throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}(wo(e,i)));const s=fe(t,["config"]);return null!=s&&function(e,t){const n=fe(e,["displayName"]);void 0!==t&&null!=n&&he(t,["displayName"],n);const o=fe(e,["dest"]);void 0!==t&&null!=o&&he(t,["outputConfig"],function(e){const t={},n=fe(e,["format"]);null!=n&&he(t,["predictionsFormat"],n);const o=fe(e,["gcsUri"]);null!=o&&he(t,["gcsDestination","outputUriPrefix"],o);const i=fe(e,["bigqueryUri"]);if(null!=i&&he(t,["bigqueryDestination","outputUri"],i),void 0!==fe(e,["fileName"]))throw new Error("fileName parameter is not supported in Vertex AI.");if(void 0!==fe(e,["inlinedResponses"]))throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==fe(e,["inlinedEmbedContentResponses"]))throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}(function(e){if("string"!=typeof e)return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}(o)))}(s,n),n}(Tn=An||(An={})).PAGED_ITEM_BATCH_JOBS="batchJobs",Tn.PAGED_ITEM_MODELS="models",Tn.PAGED_ITEM_TUNING_JOBS="tuningJobs",Tn.PAGED_ITEM_FILES="files",Tn.PAGED_ITEM_CACHED_CONTENTS="cachedContents",Tn.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",Tn.PAGED_ITEM_DOCUMENTS="documents";class ko{constructor(e,t,n,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,o)}init(e,t,n){var o,i;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=null==t?void 0:t.sdkHttpResponse,this.idxInternal=0;let s={config:{}};s=n&&0!==Object.keys(n).length?"object"==typeof n?Object.assign({},n):n:{config:{}},s.config&&(s.config.pageToken=t.nextPageToken),this.paramsInternal=s,this.pageInternalSize=null!==(i=null===(o=s.config)||void 0===o?void 0:o.pageSize)&&void 0!==i?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength){if(!this.hasNextPage())return{value:void 0,done:!0};await this.nextPage()}const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return void 0!==(null===(e=this.params.config)||void 0===e?void 0:e.pageToken)}}class qo extends de{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new ko(An.PAGED_ITEM_BATCH_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.create=async e=>(this.apiClient.isVertexAI()&&(e.config=this.formatDestination(e.src,e.config)),this.createInternal(e)),this.createEmbeddings=async e=>{if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(e)}}createInlinedGenerateContentRequest(e){const t=Uo(this.apiClient,e),n=pe("{model}:batchGenerateContent",t._url),o=t.batch.inputConfig.requests,i=o.requests,s=[];for(const r of i){const e=Object.assign({},r);if(e.systemInstruction){const t=e.systemInstruction;delete e.systemInstruction;const n=e.request;n.systemInstruction=t,e.request=n}s.push(e)}return o.requests=s,delete t.config,delete t._url,delete t._query,{path:n,body:t}}getGcsUri(e){return"string"==typeof e?e.startsWith("gs://")?e:void 0:!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0?e.gcsUri[0]:void 0}getBigqueryUri(e){return"string"==typeof e?e.startsWith("bq://")?e:void 0:Array.isArray(e)?void 0:e.bigqueryUri}formatDestination(e,t){const n=t?Object.assign({},t):{},o=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${o}`),void 0===n.dest){const t=this.getGcsUri(e),i=this.getBigqueryUri(e);if(t)t.endsWith(".jsonl")?n.dest=`${t.slice(0,-6)}/dest`:n.dest=`${t}_dest_${o}`;else{if(!i)throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.");n.dest=`${i}_dest_${o}`}}return n}async createInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=jo(this.apiClient,e);return r=pe("batchPredictionJobs",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>Do(e))}{const t=Uo(this.apiClient,e);return r=pe("{model}:batchGenerateContent",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>Po(e))}}async createEmbeddingsInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["src"]);null!=i&&he(n,["batch","inputConfig"],function(e,t){const n={},o=fe(t,["fileName"]);null!=o&&he(n,["file_name"],o);const i=fe(t,["inlinedRequests"]);return null!=i&&he(n,["requests"],function(e,t){const n={},o=fe(t,["contents"]);if(null!=o){let t=po(e,o);Array.isArray(t)&&(t=t.map(e=>e)),he(n,["requests[]","request","content"],t)}const i=fe(t,["config"]);return null!=i&&(he(n,["_self"],function(e,t){const n=fe(e,["taskType"]);void 0!==t&&null!=n&&he(t,["requests[]","taskType"],n);const o=fe(e,["title"]);void 0!==t&&null!=o&&he(t,["requests[]","title"],o);const i=fe(e,["outputDimensionality"]);if(void 0!==t&&null!=i&&he(t,["requests[]","outputDimensionality"],i),void 0!==fe(e,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==fe(e,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.");return{}}(i,n)),function(e){for(const[t,n]of Object.entries({"requests[].*":"requests[].request.*"})){const o=t.split("."),i=n.split("."),s=new Set;let r=-1;for(let e=0;e<o.length;e++)if("*"===o[e]){r=e;break}if(-1!==r&&i.length>r)for(let e=r;e<i.length;e++){const t=i[e];"*"===t||t.endsWith("[]")||t.endsWith("[0]")||s.add(t)}me(e,o,i,0,s)}}(n)),n}(e,i)),n}(e,i));const s=fe(t,["config"]);return null!=s&&function(e,t){const n=fe(e,["displayName"]);void 0!==t&&null!=n&&he(t,["batch","displayName"],n)}(s,n),n}(this.apiClient,e);return i=pe("{model}:asyncBatchEmbedContent",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>Po(e))}}async get(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=fe(t,["name"]);return null!=o&&he(n,["_url","name"],Ro(e,o)),n}(this.apiClient,e);return r=pe("batchPredictionJobs/{name}",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>Do(e))}{const t=function(e,t){const n={},o=fe(t,["name"]);return null!=o&&he(n,["_url","name"],Ro(e,o)),n}(this.apiClient,e);return r=pe("batches/{name}",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>Po(e))}}async cancel(e){var t,n,o,i;let s="",r={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=fe(t,["name"]);return null!=o&&he(n,["_url","name"],Ro(e,o)),n}(this.apiClient,e);s=pe("batchPredictionJobs/{name}:cancel",o._url),r=o._query,delete o._url,delete o._query,await this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}else{const t=function(e,t){const n={},o=fe(t,["name"]);return null!=o&&he(n,["_url","name"],Ro(e,o)),n}(this.apiClient,e);s=pe("batches/{name}:cancel",t._url),r=t._query,delete t._url,delete t._query,await this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal})}}async listInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e){const t={},n=fe(e,["config"]);return null!=n&&function(e,t){const n=fe(e,["pageSize"]);void 0!==t&&null!=n&&he(t,["_query","pageSize"],n);const o=fe(e,["pageToken"]);void 0!==t&&null!=o&&he(t,["_query","pageToken"],o);const i=fe(e,["filter"]);void 0!==t&&null!=i&&he(t,["_query","filter"],i)}(n,t),t}(e);return r=pe("batchPredictionJobs",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["nextPageToken"]);null!=o&&he(t,["nextPageToken"],o);const i=fe(e,["batchPredictionJobs"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>Do(e))),he(t,["batchJobs"],e)}return t}(e),n=new Kn;return Object.assign(n,t),n})}{const t=function(e){const t={},n=fe(e,["config"]);return null!=n&&function(e,t){const n=fe(e,["pageSize"]);void 0!==t&&null!=n&&he(t,["_query","pageSize"],n);const o=fe(e,["pageToken"]);if(void 0!==t&&null!=o&&he(t,["_query","pageToken"],o),void 0!==fe(e,["filter"]))throw new Error("filter parameter is not supported in Gemini API.")}(n,t),t}(e);return r=pe("batches",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["nextPageToken"]);null!=o&&he(t,["nextPageToken"],o);const i=fe(e,["operations"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>Po(e))),he(t,["batchJobs"],e)}return t}(e),n=new Kn;return Object.assign(n,t),n})}}async delete(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=fe(t,["name"]);return null!=o&&he(n,["_url","name"],Ro(e,o)),n}(this.apiClient,e);return r=pe("batchPredictionJobs/{name}",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["name"]);null!=o&&he(t,["name"],o);const i=fe(e,["done"]);null!=i&&he(t,["done"],i);const s=fe(e,["error"]);return null!=s&&he(t,["error"],s),t}(e))}{const t=function(e,t){const n={},o=fe(t,["name"]);return null!=o&&he(n,["_url","name"],Ro(e,o)),n}(this.apiClient,e);return r=pe("batches/{name}",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["name"]);null!=o&&he(t,["name"],o);const i=fe(e,["done"]);null!=i&&he(t,["done"],i);const s=fe(e,["error"]);return null!=s&&he(t,["error"],s),t}(e))}}}function Lo(e){const t={},n=fe(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["mediaResolution"]);null!=n&&he(t,["mediaResolution"],n);const o=fe(e,["codeExecutionResult"]);null!=o&&he(t,["codeExecutionResult"],o);const i=fe(e,["executableCode"]);null!=i&&he(t,["executableCode"],i);const s=fe(e,["fileData"]);null!=s&&he(t,["fileData"],function(e){const t={};if(void 0!==fe(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=fe(e,["fileUri"]);null!=n&&he(t,["fileUri"],n);const o=fe(e,["mimeType"]);return null!=o&&he(t,["mimeType"],o),t}(s));const r=fe(e,["functionCall"]);null!=r&&he(t,["functionCall"],function(e){const t={},n=fe(e,["id"]);null!=n&&he(t,["id"],n);const o=fe(e,["args"]);null!=o&&he(t,["args"],o);const i=fe(e,["name"]);if(null!=i&&he(t,["name"],i),void 0!==fe(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==fe(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(r));const l=fe(e,["functionResponse"]);null!=l&&he(t,["functionResponse"],l);const a=fe(e,["inlineData"]);null!=a&&he(t,["inlineData"],function(e){const t={},n=fe(e,["data"]);if(null!=n&&he(t,["data"],n),void 0!==fe(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const o=fe(e,["mimeType"]);return null!=o&&he(t,["mimeType"],o),t}(a));const u=fe(e,["text"]);null!=u&&he(t,["text"],u);const c=fe(e,["thought"]);null!=c&&he(t,["thought"],c);const d=fe(e,["thoughtSignature"]);null!=d&&he(t,["thoughtSignature"],d);const p=fe(e,["videoMetadata"]);return null!=p&&he(t,["videoMetadata"],p),t}(e))),he(t,["parts"],e)}const o=fe(e,["role"]);return null!=o&&he(t,["role"],o),t}class Go extends de{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new ko(An.PAGED_ITEM_CACHED_CONTENTS,e=>this.listInternal(e),await this.listInternal(e),e)}async create(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["model"],eo(e,o));const i=fe(t,["config"]);return null!=i&&function(e,t){const n=fe(e,["ttl"]);void 0!==t&&null!=n&&he(t,["ttl"],n);const o=fe(e,["expireTime"]);void 0!==t&&null!=o&&he(t,["expireTime"],o);const i=fe(e,["displayName"]);void 0!==t&&null!=i&&he(t,["displayName"],i);const s=fe(e,["contents"]);if(void 0!==t&&null!=s){let e=ho(s);Array.isArray(e)&&(e=e.map(e=>e)),he(t,["contents"],e)}const r=fe(e,["systemInstruction"]);void 0!==t&&null!=r&&he(t,["systemInstruction"],co(r));const l=fe(e,["tools"]);if(void 0!==t&&null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==fe(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const n=fe(e,["description"]);null!=n&&he(t,["description"],n);const o=fe(e,["name"]);null!=o&&he(t,["name"],o);const i=fe(e,["parameters"]);null!=i&&he(t,["parameters"],i);const s=fe(e,["parametersJsonSchema"]);null!=s&&he(t,["parametersJsonSchema"],s);const r=fe(e,["response"]);null!=r&&he(t,["response"],r);const l=fe(e,["responseJsonSchema"]);return null!=l&&he(t,["responseJsonSchema"],l),t}(e))),he(t,["functionDeclarations"],e)}const o=fe(e,["retrieval"]);null!=o&&he(t,["retrieval"],o);const i=fe(e,["googleSearchRetrieval"]);null!=i&&he(t,["googleSearchRetrieval"],i);const s=fe(e,["computerUse"]);if(null!=s&&he(t,["computerUse"],s),void 0!==fe(e,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=fe(e,["codeExecution"]);null!=r&&he(t,["codeExecution"],r);const l=fe(e,["enterpriseWebSearch"]);null!=l&&he(t,["enterpriseWebSearch"],l);const a=fe(e,["googleMaps"]);null!=a&&he(t,["googleMaps"],a);const u=fe(e,["googleSearch"]);null!=u&&he(t,["googleSearch"],u);const c=fe(e,["urlContext"]);return null!=c&&he(t,["urlContext"],c),t}(e))),he(t,["tools"],e)}const a=fe(e,["toolConfig"]);void 0!==t&&null!=a&&he(t,["toolConfig"],a);const u=fe(e,["kmsKeyName"]);void 0!==t&&null!=u&&he(t,["encryption_spec","kmsKeyName"],u)}(i,n),n}(this.apiClient,e);return r=pe("cachedContents",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>e)}{const t=function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["model"],eo(e,o));const i=fe(t,["config"]);return null!=i&&function(e,t){const n=fe(e,["ttl"]);void 0!==t&&null!=n&&he(t,["ttl"],n);const o=fe(e,["expireTime"]);void 0!==t&&null!=o&&he(t,["expireTime"],o);const i=fe(e,["displayName"]);void 0!==t&&null!=i&&he(t,["displayName"],i);const s=fe(e,["contents"]);if(void 0!==t&&null!=s){let e=ho(s);Array.isArray(e)&&(e=e.map(e=>Lo(e))),he(t,["contents"],e)}const r=fe(e,["systemInstruction"]);void 0!==t&&null!=r&&he(t,["systemInstruction"],Lo(co(r)));const l=fe(e,["tools"]);if(void 0!==t&&null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["functionDeclarations"],e)}if(void 0!==fe(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const o=fe(e,["googleSearchRetrieval"]);null!=o&&he(t,["googleSearchRetrieval"],o);const i=fe(e,["computerUse"]);null!=i&&he(t,["computerUse"],i);const s=fe(e,["fileSearch"]);null!=s&&he(t,["fileSearch"],s);const r=fe(e,["codeExecution"]);if(null!=r&&he(t,["codeExecution"],r),void 0!==fe(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=fe(e,["googleMaps"]);null!=l&&he(t,["googleMaps"],function(e){const t={};if(void 0!==fe(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=fe(e,["enableWidget"]);return null!=n&&he(t,["enableWidget"],n),t}(l));const a=fe(e,["googleSearch"]);null!=a&&he(t,["googleSearch"],function(e){const t={};if(void 0!==fe(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==fe(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=fe(e,["timeRangeFilter"]);return null!=n&&he(t,["timeRangeFilter"],n),t}(a));const u=fe(e,["urlContext"]);return null!=u&&he(t,["urlContext"],u),t}(e))),he(t,["tools"],e)}const a=fe(e,["toolConfig"]);if(void 0!==t&&null!=a&&he(t,["toolConfig"],function(e){const t={},n=fe(e,["functionCallingConfig"]);null!=n&&he(t,["functionCallingConfig"],function(e){const t={},n=fe(e,["mode"]);null!=n&&he(t,["mode"],n);const o=fe(e,["allowedFunctionNames"]);if(null!=o&&he(t,["allowedFunctionNames"],o),void 0!==fe(e,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(n));const o=fe(e,["retrievalConfig"]);return null!=o&&he(t,["retrievalConfig"],o),t}(a)),void 0!==fe(e,["kmsKeyName"]))throw new Error("kmsKeyName parameter is not supported in Gemini API.")}(i,n),n}(this.apiClient,e);return r=pe("cachedContents",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>e)}}async get(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=fe(t,["name"]);return null!=o&&he(n,["_url","name"],_o(e,o)),n}(this.apiClient,e);return r=pe("{name}",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>e)}{const t=function(e,t){const n={},o=fe(t,["name"]);return null!=o&&he(n,["_url","name"],_o(e,o)),n}(this.apiClient,e);return r=pe("{name}",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>e)}}async delete(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=fe(t,["name"]);return null!=o&&he(n,["_url","name"],_o(e,o)),n}(this.apiClient,e);return r=pe("{name}",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);return null!=n&&he(t,["sdkHttpResponse"],n),t}(e),n=new Gn;return Object.assign(n,t),n})}{const t=function(e,t){const n={},o=fe(t,["name"]);return null!=o&&he(n,["_url","name"],_o(e,o)),n}(this.apiClient,e);return r=pe("{name}",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);return null!=n&&he(t,["sdkHttpResponse"],n),t}(e),n=new Gn;return Object.assign(n,t),n})}}async update(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=fe(t,["name"]);null!=o&&he(n,["_url","name"],_o(e,o));const i=fe(t,["config"]);return null!=i&&function(e,t){const n=fe(e,["ttl"]);void 0!==t&&null!=n&&he(t,["ttl"],n);const o=fe(e,["expireTime"]);void 0!==t&&null!=o&&he(t,["expireTime"],o)}(i,n),n}(this.apiClient,e);return r=pe("{name}",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>e)}{const t=function(e,t){const n={},o=fe(t,["name"]);null!=o&&he(n,["_url","name"],_o(e,o));const i=fe(t,["config"]);return null!=i&&function(e,t){const n=fe(e,["ttl"]);void 0!==t&&null!=n&&he(t,["ttl"],n);const o=fe(e,["expireTime"]);void 0!==t&&null!=o&&he(t,["expireTime"],o)}(i,n),n}(this.apiClient,e);return r=pe("{name}",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>e)}}async listInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e){const t={},n=fe(e,["config"]);return null!=n&&function(e,t){const n=fe(e,["pageSize"]);void 0!==t&&null!=n&&he(t,["_query","pageSize"],n);const o=fe(e,["pageToken"]);void 0!==t&&null!=o&&he(t,["_query","pageToken"],o)}(n,t),t}(e);return r=pe("cachedContents",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["nextPageToken"]);null!=o&&he(t,["nextPageToken"],o);const i=fe(e,["cachedContents"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["cachedContents"],e)}return t}(e),n=new Hn;return Object.assign(n,t),n})}{const t=function(e){const t={},n=fe(e,["config"]);return null!=n&&function(e,t){const n=fe(e,["pageSize"]);void 0!==t&&null!=n&&he(t,["_query","pageSize"],n);const o=fe(e,["pageToken"]);void 0!==t&&null!=o&&he(t,["_query","pageToken"],o)}(n,t),t}(e);return r=pe("cachedContents",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["nextPageToken"]);null!=o&&he(t,["nextPageToken"],o);const i=fe(e,["cachedContents"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["cachedContents"],e)}return t}(e),n=new Hn;return Object.assign(n,t),n})}}}function Ho(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n}function Fo(e){return this instanceof Fo?(this.v=e,this):new Fo(e)}function Vo(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,i=n.apply(e,t||[]),s=[];return o=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),r("next"),r("throw"),r("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),o[Symbol.asyncIterator]=function(){return this},o;function r(e,t){i[e]&&(o[e]=function(t){return new Promise(function(n,o){s.push([e,t,n,o])>1||l(e,t)})},t&&(o[e]=t(o[e])))}function l(e,t){try{(n=i[e](t)).value instanceof Fo?Promise.resolve(n.value.v).then(a,u):c(s[0][2],n)}catch(o){c(s[0][3],o)}var n}function a(e){l("next",e)}function u(e){l("throw",e)}function c(e,t){e(t),s.shift(),s.length&&l(s[0][0],s[0][1])}}function Bo(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise(function(o,i){!function(e,t,n,o){Promise.resolve(o).then(function(t){e({value:t,done:n})},t)}(o,i,(t=e[n](t)).done,t.value)})}}}function Jo(e){var t;if(null==e.candidates||0===e.candidates.length)return!1;const n=null===(t=e.candidates[0])||void 0===t?void 0:t.content;return void 0!==n&&Yo(n)}function Yo(e){if(void 0===e.parts||0===e.parts.length)return!1;for(const t of e.parts)if(void 0===t||0===Object.keys(t).length)return!1;return!0}function $o(e){if(void 0===e||0===e.length)return[];const t=[],n=e.length;let o=0;for(;o<n;)if("user"===e[o].role)t.push(e[o]),o++;else{const i=[];let s=!0;for(;o<n&&"model"===e[o].role;)i.push(e[o]),s&&!Yo(e[o])&&(s=!1),o++;s?t.push(...i):t.pop()}return t}"function"==typeof SuppressedError&&SuppressedError;class Wo{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new Ko(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class Ko{constructor(e,t,n,o={},i=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=o,this.history=i,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length)for(const t of e)if("user"!==t.role&&"model"!==t.role)throw new Error(`Role must be user or model, but got ${t.role}.`)}(i)}async sendMessage(e){var t;await this.sendPromise;const n=co(e.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});return this.sendPromise=(async()=>{var e,t,i;const s=await o,r=null===(t=null===(e=s.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content,l=s.automaticFunctionCallingHistory,a=this.getHistory(!0).length;let u=[];null!=l&&(u=null!==(i=l.slice(a))&&void 0!==i?i:[]);const c=r?[r]:[];this.recordHistory(n,c,u)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(e){var t;await this.sendPromise;const n=co(e.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const i=await o;return this.processStreamResponse(i,n)}getHistory(e=!1){const t=e?$o(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return Vo(this,arguments,function*(){var n,o,i,s,r,l;const a=[];try{for(var u,c=!0,d=Bo(e);!(n=(u=yield Fo(d.next())).done);c=!0){s=u.value,c=!1;const e=s;if(Jo(e)){const t=null===(l=null===(r=e.candidates)||void 0===r?void 0:r[0])||void 0===l?void 0:l.content;void 0!==t&&a.push(t)}yield yield Fo(e)}}catch(p){o={error:p}}finally{try{c||n||!(i=d.return)||(yield Fo(i.call(d)))}finally{if(o)throw o.error}}this.recordHistory(t,a)})}recordHistory(e,t,n){let o=[];t.length>0&&t.every(e=>void 0!==e.role)?o=t:o.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...$o(n)):this.history.push(e),this.history.push(...o)}}class zo extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,zo.prototype)}}class Xo extends de{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new ko(An.PAGED_ITEM_FILES,e=>this.listInternal(e),await this.listInternal(e),e)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(e=>e)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=fe(e,["config"]);return null!=n&&function(e,t){const n=fe(e,["pageSize"]);void 0!==t&&null!=n&&he(t,["_query","pageSize"],n);const o=fe(e,["pageToken"]);void 0!==t&&null!=o&&he(t,["_query","pageToken"],o)}(n,t),t}(e);return i=pe("files",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),o.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["nextPageToken"]);null!=o&&he(t,["nextPageToken"],o);const i=fe(e,["files"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["files"],e)}return t}(e),n=new Yn;return Object.assign(n,t),n})}}async createInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=fe(e,["file"]);return null!=n&&he(t,["file"],n),t}(e);return i=pe("upload/v1beta/files",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);return null!=n&&he(t,["sdkHttpResponse"],n),t}(e),n=new $n;return Object.assign(n,t),n})}}async get(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=fe(e,["name"]);return null!=n&&he(t,["_url","file"],Ao(n)),t}(e);return i=pe("files/{file}",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>e)}}async delete(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=fe(e,["name"]);return null!=n&&he(t,["_url","file"],Ao(n)),t}(e);return i=pe("files/{file}",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),o.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);return null!=n&&he(t,["sdkHttpResponse"],n),t}(e),n=new Wn;return Object.assign(n,t),n})}}}function Qo(e){const t={},n=fe(e,["data"]);if(null!=n&&he(t,["data"],n),void 0!==fe(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const o=fe(e,["mimeType"]);return null!=o&&he(t,["mimeType"],o),t}function Zo(e,t){const n=fe(e,["generationConfig"]);void 0!==t&&null!=n&&he(t,["setup","generationConfig"],n);const o=fe(e,["responseModalities"]);void 0!==t&&null!=o&&he(t,["setup","generationConfig","responseModalities"],o);const i=fe(e,["temperature"]);void 0!==t&&null!=i&&he(t,["setup","generationConfig","temperature"],i);const s=fe(e,["topP"]);void 0!==t&&null!=s&&he(t,["setup","generationConfig","topP"],s);const r=fe(e,["topK"]);void 0!==t&&null!=r&&he(t,["setup","generationConfig","topK"],r);const l=fe(e,["maxOutputTokens"]);void 0!==t&&null!=l&&he(t,["setup","generationConfig","maxOutputTokens"],l);const a=fe(e,["mediaResolution"]);void 0!==t&&null!=a&&he(t,["setup","generationConfig","mediaResolution"],a);const u=fe(e,["seed"]);void 0!==t&&null!=u&&he(t,["setup","generationConfig","seed"],u);const c=fe(e,["speechConfig"]);void 0!==t&&null!=c&&he(t,["setup","generationConfig","speechConfig"],yo(c));const d=fe(e,["thinkingConfig"]);void 0!==t&&null!=d&&he(t,["setup","generationConfig","thinkingConfig"],d);const p=fe(e,["enableAffectiveDialog"]);void 0!==t&&null!=p&&he(t,["setup","generationConfig","enableAffectiveDialog"],p);const h=fe(e,["systemInstruction"]);void 0!==t&&null!=h&&he(t,["setup","systemInstruction"],function(e){const t={},n=fe(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["mediaResolution"]);null!=n&&he(t,["mediaResolution"],n);const o=fe(e,["codeExecutionResult"]);null!=o&&he(t,["codeExecutionResult"],o);const i=fe(e,["executableCode"]);null!=i&&he(t,["executableCode"],i);const s=fe(e,["fileData"]);null!=s&&he(t,["fileData"],function(e){const t={};if(void 0!==fe(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=fe(e,["fileUri"]);null!=n&&he(t,["fileUri"],n);const o=fe(e,["mimeType"]);return null!=o&&he(t,["mimeType"],o),t}(s));const r=fe(e,["functionCall"]);null!=r&&he(t,["functionCall"],function(e){const t={},n=fe(e,["id"]);null!=n&&he(t,["id"],n);const o=fe(e,["args"]);null!=o&&he(t,["args"],o);const i=fe(e,["name"]);if(null!=i&&he(t,["name"],i),void 0!==fe(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==fe(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(r));const l=fe(e,["functionResponse"]);null!=l&&he(t,["functionResponse"],l);const a=fe(e,["inlineData"]);null!=a&&he(t,["inlineData"],Qo(a));const u=fe(e,["text"]);null!=u&&he(t,["text"],u);const c=fe(e,["thought"]);null!=c&&he(t,["thought"],c);const d=fe(e,["thoughtSignature"]);null!=d&&he(t,["thoughtSignature"],d);const p=fe(e,["videoMetadata"]);return null!=p&&he(t,["videoMetadata"],p),t}(e))),he(t,["parts"],e)}const o=fe(e,["role"]);return null!=o&&he(t,["role"],o),t}(co(h)));const f=fe(e,["tools"]);if(void 0!==t&&null!=f){let e=Eo(f);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["functionDeclarations"],e)}if(void 0!==fe(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const o=fe(e,["googleSearchRetrieval"]);null!=o&&he(t,["googleSearchRetrieval"],o);const i=fe(e,["computerUse"]);null!=i&&he(t,["computerUse"],i);const s=fe(e,["fileSearch"]);null!=s&&he(t,["fileSearch"],s);const r=fe(e,["codeExecution"]);if(null!=r&&he(t,["codeExecution"],r),void 0!==fe(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=fe(e,["googleMaps"]);null!=l&&he(t,["googleMaps"],function(e){const t={};if(void 0!==fe(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=fe(e,["enableWidget"]);return null!=n&&he(t,["enableWidget"],n),t}(l));const a=fe(e,["googleSearch"]);null!=a&&he(t,["googleSearch"],function(e){const t={};if(void 0!==fe(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==fe(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=fe(e,["timeRangeFilter"]);return null!=n&&he(t,["timeRangeFilter"],n),t}(a));const u=fe(e,["urlContext"]);return null!=u&&he(t,["urlContext"],u),t}(vo(e)))),he(t,["setup","tools"],e)}const m=fe(e,["sessionResumption"]);void 0!==t&&null!=m&&he(t,["setup","sessionResumption"],function(e){const t={},n=fe(e,["handle"]);if(null!=n&&he(t,["handle"],n),void 0!==fe(e,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return t}(m));const g=fe(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&he(t,["setup","inputAudioTranscription"],g);const y=fe(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&he(t,["setup","outputAudioTranscription"],y);const v=fe(e,["realtimeInputConfig"]);void 0!==t&&null!=v&&he(t,["setup","realtimeInputConfig"],v);const E=fe(e,["contextWindowCompression"]);void 0!==t&&null!=E&&he(t,["setup","contextWindowCompression"],E);const _=fe(e,["proactivity"]);if(void 0!==t&&null!=_&&he(t,["setup","proactivity"],_),void 0!==fe(e,["explicitVadSignal"]))throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return{}}function ei(e){const t={},n=fe(e,["media"]);if(null!=n){let e=to(n);Array.isArray(e)&&(e=e.map(e=>Qo(e))),he(t,["mediaChunks"],e)}const o=fe(e,["audio"]);null!=o&&he(t,["audio"],Qo(io(o)));const i=fe(e,["audioStreamEnd"]);null!=i&&he(t,["audioStreamEnd"],i);const s=fe(e,["video"]);null!=s&&he(t,["video"],Qo(oo(s)));const r=fe(e,["text"]);null!=r&&he(t,["text"],r);const l=fe(e,["activityStart"]);null!=l&&he(t,["activityStart"],l);const a=fe(e,["activityEnd"]);return null!=a&&he(t,["activityEnd"],a),t}function ti(e){const t={},n=fe(e,["media"]);if(null!=n){let e=to(n);Array.isArray(e)&&(e=e.map(e=>e)),he(t,["mediaChunks"],e)}const o=fe(e,["audio"]);null!=o&&he(t,["audio"],io(o));const i=fe(e,["audioStreamEnd"]);null!=i&&he(t,["audioStreamEnd"],i);const s=fe(e,["video"]);null!=s&&he(t,["video"],oo(s));const r=fe(e,["text"]);null!=r&&he(t,["text"],r);const l=fe(e,["activityStart"]);null!=l&&he(t,["activityStart"],l);const a=fe(e,["activityEnd"]);return null!=a&&he(t,["activityEnd"],a),t}function ni(e){const t={},n=fe(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["mediaResolution"]);null!=n&&he(t,["mediaResolution"],n);const o=fe(e,["codeExecutionResult"]);null!=o&&he(t,["codeExecutionResult"],o);const i=fe(e,["executableCode"]);null!=i&&he(t,["executableCode"],i);const s=fe(e,["fileData"]);null!=s&&he(t,["fileData"],function(e){const t={};if(void 0!==fe(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=fe(e,["fileUri"]);null!=n&&he(t,["fileUri"],n);const o=fe(e,["mimeType"]);return null!=o&&he(t,["mimeType"],o),t}(s));const r=fe(e,["functionCall"]);null!=r&&he(t,["functionCall"],function(e){const t={},n=fe(e,["id"]);null!=n&&he(t,["id"],n);const o=fe(e,["args"]);null!=o&&he(t,["args"],o);const i=fe(e,["name"]);if(null!=i&&he(t,["name"],i),void 0!==fe(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==fe(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(r));const l=fe(e,["functionResponse"]);null!=l&&he(t,["functionResponse"],l);const a=fe(e,["inlineData"]);null!=a&&he(t,["inlineData"],function(e){const t={},n=fe(e,["data"]);if(null!=n&&he(t,["data"],n),void 0!==fe(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const o=fe(e,["mimeType"]);return null!=o&&he(t,["mimeType"],o),t}(a));const u=fe(e,["text"]);null!=u&&he(t,["text"],u);const c=fe(e,["thought"]);null!=c&&he(t,["thought"],c);const d=fe(e,["thoughtSignature"]);null!=d&&he(t,["thoughtSignature"],d);const p=fe(e,["videoMetadata"]);return null!=p&&he(t,["videoMetadata"],p),t}(e))),he(t,["parts"],e)}const o=fe(e,["role"]);return null!=o&&he(t,["role"],o),t}function oi(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["contents"]);if(null!=i){let e=ho(i);Array.isArray(e)&&(e=e.map(e=>ni(e))),he(n,["contents"],e)}const s=fe(t,["config"]);return null!=s&&he(n,["generationConfig"],function(e,t,n){const o={},i=fe(t,["systemInstruction"]);void 0!==n&&null!=i&&he(n,["systemInstruction"],ni(co(i)));const s=fe(t,["temperature"]);null!=s&&he(o,["temperature"],s);const r=fe(t,["topP"]);null!=r&&he(o,["topP"],r);const l=fe(t,["topK"]);null!=l&&he(o,["topK"],l);const a=fe(t,["candidateCount"]);null!=a&&he(o,["candidateCount"],a);const u=fe(t,["maxOutputTokens"]);null!=u&&he(o,["maxOutputTokens"],u);const c=fe(t,["stopSequences"]);null!=c&&he(o,["stopSequences"],c);const d=fe(t,["responseLogprobs"]);null!=d&&he(o,["responseLogprobs"],d);const p=fe(t,["logprobs"]);null!=p&&he(o,["logprobs"],p);const h=fe(t,["presencePenalty"]);null!=h&&he(o,["presencePenalty"],h);const f=fe(t,["frequencyPenalty"]);null!=f&&he(o,["frequencyPenalty"],f);const m=fe(t,["seed"]);null!=m&&he(o,["seed"],m);const g=fe(t,["responseMimeType"]);null!=g&&he(o,["responseMimeType"],g);const y=fe(t,["responseSchema"]);null!=y&&he(o,["responseSchema"],mo(y));const v=fe(t,["responseJsonSchema"]);if(null!=v&&he(o,["responseJsonSchema"],v),void 0!==fe(t,["routingConfig"]))throw new Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==fe(t,["modelSelectionConfig"]))throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const E=fe(t,["safetySettings"]);if(void 0!==n&&null!=E){let e=E;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["category"]);if(null!=n&&he(t,["category"],n),void 0!==fe(e,["method"]))throw new Error("method parameter is not supported in Gemini API.");const o=fe(e,["threshold"]);return null!=o&&he(t,["threshold"],o),t}(e))),he(n,["safetySettings"],e)}const _=fe(t,["tools"]);if(void 0!==n&&null!=_){let e=Eo(_);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["functionDeclarations"],e)}if(void 0!==fe(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const o=fe(e,["googleSearchRetrieval"]);null!=o&&he(t,["googleSearchRetrieval"],o);const i=fe(e,["computerUse"]);null!=i&&he(t,["computerUse"],i);const s=fe(e,["fileSearch"]);null!=s&&he(t,["fileSearch"],s);const r=fe(e,["codeExecution"]);if(null!=r&&he(t,["codeExecution"],r),void 0!==fe(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=fe(e,["googleMaps"]);null!=l&&he(t,["googleMaps"],function(e){const t={};if(void 0!==fe(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=fe(e,["enableWidget"]);return null!=n&&he(t,["enableWidget"],n),t}(l));const a=fe(e,["googleSearch"]);null!=a&&he(t,["googleSearch"],function(e){const t={};if(void 0!==fe(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==fe(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=fe(e,["timeRangeFilter"]);return null!=n&&he(t,["timeRangeFilter"],n),t}(a));const u=fe(e,["urlContext"]);return null!=u&&he(t,["urlContext"],u),t}(vo(e)))),he(n,["tools"],e)}const I=fe(t,["toolConfig"]);if(void 0!==n&&null!=I&&he(n,["toolConfig"],function(e){const t={},n=fe(e,["functionCallingConfig"]);null!=n&&he(t,["functionCallingConfig"],function(e){const t={},n=fe(e,["mode"]);null!=n&&he(t,["mode"],n);const o=fe(e,["allowedFunctionNames"]);if(null!=o&&he(t,["allowedFunctionNames"],o),void 0!==fe(e,["streamFunctionCallArguments"]))throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}(n));const o=fe(e,["retrievalConfig"]);return null!=o&&he(t,["retrievalConfig"],o),t}(I)),void 0!==fe(t,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const b=fe(t,["cachedContent"]);void 0!==n&&null!=b&&he(n,["cachedContent"],_o(e,b));const A=fe(t,["responseModalities"]);null!=A&&he(o,["responseModalities"],A);const T=fe(t,["mediaResolution"]);null!=T&&he(o,["mediaResolution"],T);const S=fe(t,["speechConfig"]);if(null!=S&&he(o,["speechConfig"],go(S)),void 0!==fe(t,["audioTimestamp"]))throw new Error("audioTimestamp parameter is not supported in Gemini API.");const O=fe(t,["thinkingConfig"]);null!=O&&he(o,["thinkingConfig"],O);const C=fe(t,["imageConfig"]);null!=C&&he(o,["imageConfig"],function(e){const t={},n=fe(e,["aspectRatio"]);null!=n&&he(t,["aspectRatio"],n);const o=fe(e,["imageSize"]);if(null!=o&&he(t,["imageSize"],o),void 0!==fe(e,["outputMimeType"]))throw new Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==fe(e,["outputCompressionQuality"]))throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}(C));const w=fe(t,["enableEnhancedCivicAnswers"]);return null!=w&&he(o,["enableEnhancedCivicAnswers"],w),o}(e,s,n)),n}function ii(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["contents"]);if(null!=i){let e=ho(i);Array.isArray(e)&&(e=e.map(e=>e)),he(n,["contents"],e)}const s=fe(t,["config"]);return null!=s&&he(n,["generationConfig"],function(e,t,n){const o={},i=fe(t,["systemInstruction"]);void 0!==n&&null!=i&&he(n,["systemInstruction"],co(i));const s=fe(t,["temperature"]);null!=s&&he(o,["temperature"],s);const r=fe(t,["topP"]);null!=r&&he(o,["topP"],r);const l=fe(t,["topK"]);null!=l&&he(o,["topK"],l);const a=fe(t,["candidateCount"]);null!=a&&he(o,["candidateCount"],a);const u=fe(t,["maxOutputTokens"]);null!=u&&he(o,["maxOutputTokens"],u);const c=fe(t,["stopSequences"]);null!=c&&he(o,["stopSequences"],c);const d=fe(t,["responseLogprobs"]);null!=d&&he(o,["responseLogprobs"],d);const p=fe(t,["logprobs"]);null!=p&&he(o,["logprobs"],p);const h=fe(t,["presencePenalty"]);null!=h&&he(o,["presencePenalty"],h);const f=fe(t,["frequencyPenalty"]);null!=f&&he(o,["frequencyPenalty"],f);const m=fe(t,["seed"]);null!=m&&he(o,["seed"],m);const g=fe(t,["responseMimeType"]);null!=g&&he(o,["responseMimeType"],g);const y=fe(t,["responseSchema"]);null!=y&&he(o,["responseSchema"],mo(y));const v=fe(t,["responseJsonSchema"]);null!=v&&he(o,["responseJsonSchema"],v);const E=fe(t,["routingConfig"]);null!=E&&he(o,["routingConfig"],E);const _=fe(t,["modelSelectionConfig"]);null!=_&&he(o,["modelConfig"],_);const I=fe(t,["safetySettings"]);if(void 0!==n&&null!=I){let e=I;Array.isArray(e)&&(e=e.map(e=>e)),he(n,["safetySettings"],e)}const b=fe(t,["tools"]);if(void 0!==n&&null!=b){let e=Eo(b);Array.isArray(e)&&(e=e.map(e=>yi(vo(e)))),he(n,["tools"],e)}const A=fe(t,["toolConfig"]);void 0!==n&&null!=A&&he(n,["toolConfig"],A);const T=fe(t,["labels"]);void 0!==n&&null!=T&&he(n,["labels"],T);const S=fe(t,["cachedContent"]);void 0!==n&&null!=S&&he(n,["cachedContent"],_o(e,S));const O=fe(t,["responseModalities"]);null!=O&&he(o,["responseModalities"],O);const C=fe(t,["mediaResolution"]);null!=C&&he(o,["mediaResolution"],C);const w=fe(t,["speechConfig"]);null!=w&&he(o,["speechConfig"],go(w));const N=fe(t,["audioTimestamp"]);null!=N&&he(o,["audioTimestamp"],N);const R=fe(t,["thinkingConfig"]);null!=R&&he(o,["thinkingConfig"],R);const x=fe(t,["imageConfig"]);if(null!=x&&he(o,["imageConfig"],function(e){const t={},n=fe(e,["aspectRatio"]);null!=n&&he(t,["aspectRatio"],n);const o=fe(e,["imageSize"]);null!=o&&he(t,["imageSize"],o);const i=fe(e,["outputMimeType"]);null!=i&&he(t,["imageOutputOptions","mimeType"],i);const s=fe(e,["outputCompressionQuality"]);return null!=s&&he(t,["imageOutputOptions","compressionQuality"],s),t}(x)),void 0!==fe(t,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return o}(e,s,n)),n}function si(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["candidates"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["content"]);null!=n&&he(t,["content"],n);const o=fe(e,["citationMetadata"]);null!=o&&he(t,["citationMetadata"],function(e){const t={},n=fe(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["citations"],e)}return t}(o));const i=fe(e,["tokenCount"]);null!=i&&he(t,["tokenCount"],i);const s=fe(e,["finishReason"]);null!=s&&he(t,["finishReason"],s);const r=fe(e,["avgLogprobs"]);null!=r&&he(t,["avgLogprobs"],r);const l=fe(e,["groundingMetadata"]);null!=l&&he(t,["groundingMetadata"],l);const a=fe(e,["index"]);null!=a&&he(t,["index"],a);const u=fe(e,["logprobsResult"]);null!=u&&he(t,["logprobsResult"],u);const c=fe(e,["safetyRatings"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["safetyRatings"],e)}const d=fe(e,["urlContextMetadata"]);return null!=d&&he(t,["urlContextMetadata"],d),t}(e))),he(t,["candidates"],e)}const i=fe(e,["modelVersion"]);null!=i&&he(t,["modelVersion"],i);const s=fe(e,["promptFeedback"]);null!=s&&he(t,["promptFeedback"],s);const r=fe(e,["responseId"]);null!=r&&he(t,["responseId"],r);const l=fe(e,["usageMetadata"]);return null!=l&&he(t,["usageMetadata"],l),t}function ri(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["candidates"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["candidates"],e)}const i=fe(e,["createTime"]);null!=i&&he(t,["createTime"],i);const s=fe(e,["modelVersion"]);null!=s&&he(t,["modelVersion"],s);const r=fe(e,["promptFeedback"]);null!=r&&he(t,["promptFeedback"],r);const l=fe(e,["responseId"]);null!=l&&he(t,["responseId"],l);const a=fe(e,["usageMetadata"]);return null!=a&&he(t,["usageMetadata"],a),t}function li(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["prompt"]);null!=i&&he(n,["instances[0]","prompt"],i);const s=fe(t,["image"]);null!=s&&he(n,["instances[0]","image"],di(s));const r=fe(t,["video"]);null!=r&&he(n,["instances[0]","video"],vi(r));const l=fe(t,["source"]);null!=l&&function(e,t){const n=fe(e,["prompt"]);void 0!==t&&null!=n&&he(t,["instances[0]","prompt"],n);const o=fe(e,["image"]);void 0!==t&&null!=o&&he(t,["instances[0]","image"],di(o));const i=fe(e,["video"]);void 0!==t&&null!=i&&he(t,["instances[0]","video"],vi(i))}(l,n);const a=fe(t,["config"]);return null!=a&&function(e,t){const n=fe(e,["numberOfVideos"]);if(void 0!==t&&null!=n&&he(t,["parameters","sampleCount"],n),void 0!==fe(e,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==fe(e,["fps"]))throw new Error("fps parameter is not supported in Gemini API.");const o=fe(e,["durationSeconds"]);if(void 0!==t&&null!=o&&he(t,["parameters","durationSeconds"],o),void 0!==fe(e,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const i=fe(e,["aspectRatio"]);void 0!==t&&null!=i&&he(t,["parameters","aspectRatio"],i);const s=fe(e,["resolution"]);void 0!==t&&null!=s&&he(t,["parameters","resolution"],s);const r=fe(e,["personGeneration"]);if(void 0!==t&&null!=r&&he(t,["parameters","personGeneration"],r),void 0!==fe(e,["pubsubTopic"]))throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=fe(e,["negativePrompt"]);void 0!==t&&null!=l&&he(t,["parameters","negativePrompt"],l);const a=fe(e,["enhancePrompt"]);if(void 0!==t&&null!=a&&he(t,["parameters","enhancePrompt"],a),void 0!==fe(e,["generateAudio"]))throw new Error("generateAudio parameter is not supported in Gemini API.");const u=fe(e,["lastFrame"]);void 0!==t&&null!=u&&he(t,["instances[0]","lastFrame"],di(u));const c=fe(e,["referenceImages"]);if(void 0!==t&&null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["image"]);null!=n&&he(t,["image"],di(n));const o=fe(e,["referenceType"]);return null!=o&&he(t,["referenceType"],o),t}(e))),he(t,["instances[0]","referenceImages"],e)}if(void 0!==fe(e,["mask"]))throw new Error("mask parameter is not supported in Gemini API.");if(void 0!==fe(e,["compressionQuality"]))throw new Error("compressionQuality parameter is not supported in Gemini API.")}(a,n),n}function ai(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["prompt"]);null!=i&&he(n,["instances[0]","prompt"],i);const s=fe(t,["image"]);null!=s&&he(n,["instances[0]","image"],pi(s));const r=fe(t,["video"]);null!=r&&he(n,["instances[0]","video"],Ei(r));const l=fe(t,["source"]);null!=l&&function(e,t){const n=fe(e,["prompt"]);void 0!==t&&null!=n&&he(t,["instances[0]","prompt"],n);const o=fe(e,["image"]);void 0!==t&&null!=o&&he(t,["instances[0]","image"],pi(o));const i=fe(e,["video"]);void 0!==t&&null!=i&&he(t,["instances[0]","video"],Ei(i))}(l,n);const a=fe(t,["config"]);return null!=a&&function(e,t){const n=fe(e,["numberOfVideos"]);void 0!==t&&null!=n&&he(t,["parameters","sampleCount"],n);const o=fe(e,["outputGcsUri"]);void 0!==t&&null!=o&&he(t,["parameters","storageUri"],o);const i=fe(e,["fps"]);void 0!==t&&null!=i&&he(t,["parameters","fps"],i);const s=fe(e,["durationSeconds"]);void 0!==t&&null!=s&&he(t,["parameters","durationSeconds"],s);const r=fe(e,["seed"]);void 0!==t&&null!=r&&he(t,["parameters","seed"],r);const l=fe(e,["aspectRatio"]);void 0!==t&&null!=l&&he(t,["parameters","aspectRatio"],l);const a=fe(e,["resolution"]);void 0!==t&&null!=a&&he(t,["parameters","resolution"],a);const u=fe(e,["personGeneration"]);void 0!==t&&null!=u&&he(t,["parameters","personGeneration"],u);const c=fe(e,["pubsubTopic"]);void 0!==t&&null!=c&&he(t,["parameters","pubsubTopic"],c);const d=fe(e,["negativePrompt"]);void 0!==t&&null!=d&&he(t,["parameters","negativePrompt"],d);const p=fe(e,["enhancePrompt"]);void 0!==t&&null!=p&&he(t,["parameters","enhancePrompt"],p);const h=fe(e,["generateAudio"]);void 0!==t&&null!=h&&he(t,["parameters","generateAudio"],h);const f=fe(e,["lastFrame"]);void 0!==t&&null!=f&&he(t,["instances[0]","lastFrame"],pi(f));const m=fe(e,["referenceImages"]);if(void 0!==t&&null!=m){let e=m;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["image"]);null!=n&&he(t,["image"],pi(n));const o=fe(e,["referenceType"]);return null!=o&&he(t,["referenceType"],o),t}(e))),he(t,["instances[0]","referenceImages"],e)}const g=fe(e,["mask"]);void 0!==t&&null!=g&&he(t,["instances[0]","mask"],function(e){const t={},n=fe(e,["image"]);null!=n&&he(t,["_self"],pi(n));const o=fe(e,["maskMode"]);return null!=o&&he(t,["maskMode"],o),t}(g));const y=fe(e,["compressionQuality"]);void 0!==t&&null!=y&&he(t,["parameters","compressionQuality"],y)}(a,n),n}function ui(e){const t={},n=fe(e,["_self"]);null!=n&&he(t,["image"],ci(n));const o=fe(e,["raiFilteredReason"]);null!=o&&he(t,["raiFilteredReason"],o);const i=fe(e,["_self"]);null!=i&&he(t,["safetyAttributes"],gi(i));const s=fe(e,["prompt"]);return null!=s&&he(t,["enhancedPrompt"],s),t}function ci(e){const t={},n=fe(e,["gcsUri"]);null!=n&&he(t,["gcsUri"],n);const o=fe(e,["bytesBase64Encoded"]);null!=o&&he(t,["imageBytes"],bo(o));const i=fe(e,["mimeType"]);return null!=i&&he(t,["mimeType"],i),t}function di(e){const t={};if(void 0!==fe(e,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");const n=fe(e,["imageBytes"]);null!=n&&he(t,["bytesBase64Encoded"],bo(n));const o=fe(e,["mimeType"]);return null!=o&&he(t,["mimeType"],o),t}function pi(e){const t={},n=fe(e,["gcsUri"]);null!=n&&he(t,["gcsUri"],n);const o=fe(e,["imageBytes"]);null!=o&&he(t,["bytesBase64Encoded"],bo(o));const i=fe(e,["mimeType"]);return null!=i&&he(t,["mimeType"],i),t}function hi(e){const t={},n=fe(e,["name"]);null!=n&&he(t,["name"],n);const o=fe(e,["displayName"]);null!=o&&he(t,["displayName"],o);const i=fe(e,["description"]);null!=i&&he(t,["description"],i);const s=fe(e,["version"]);null!=s&&he(t,["version"],s);const r=fe(e,["_self"]);null!=r&&he(t,["tunedModelInfo"],function(e){const t={},n=fe(e,["baseModel"]);null!=n&&he(t,["baseModel"],n);const o=fe(e,["createTime"]);null!=o&&he(t,["createTime"],o);const i=fe(e,["updateTime"]);return null!=i&&he(t,["updateTime"],i),t}(r));const l=fe(e,["inputTokenLimit"]);null!=l&&he(t,["inputTokenLimit"],l);const a=fe(e,["outputTokenLimit"]);null!=a&&he(t,["outputTokenLimit"],a);const u=fe(e,["supportedGenerationMethods"]);null!=u&&he(t,["supportedActions"],u);const c=fe(e,["temperature"]);null!=c&&he(t,["temperature"],c);const d=fe(e,["maxTemperature"]);null!=d&&he(t,["maxTemperature"],d);const p=fe(e,["topP"]);null!=p&&he(t,["topP"],p);const h=fe(e,["topK"]);null!=h&&he(t,["topK"],h);const f=fe(e,["thinking"]);return null!=f&&he(t,["thinking"],f),t}function fi(e){const t={},n=fe(e,["name"]);null!=n&&he(t,["name"],n);const o=fe(e,["displayName"]);null!=o&&he(t,["displayName"],o);const i=fe(e,["description"]);null!=i&&he(t,["description"],i);const s=fe(e,["versionId"]);null!=s&&he(t,["version"],s);const r=fe(e,["deployedModels"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["endpoint"]);null!=n&&he(t,["name"],n);const o=fe(e,["deployedModelId"]);return null!=o&&he(t,["deployedModelId"],o),t}(e))),he(t,["endpoints"],e)}const l=fe(e,["labels"]);null!=l&&he(t,["labels"],l);const a=fe(e,["_self"]);null!=a&&he(t,["tunedModelInfo"],function(e){const t={},n=fe(e,["labels","google-vertex-llm-tuning-base-model-id"]);null!=n&&he(t,["baseModel"],n);const o=fe(e,["createTime"]);null!=o&&he(t,["createTime"],o);const i=fe(e,["updateTime"]);return null!=i&&he(t,["updateTime"],i),t}(a));const u=fe(e,["defaultCheckpointId"]);null!=u&&he(t,["defaultCheckpointId"],u);const c=fe(e,["checkpoints"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["checkpoints"],e)}return t}function mi(e){const t={},n=fe(e,["safetyAttributes","categories"]);null!=n&&he(t,["categories"],n);const o=fe(e,["safetyAttributes","scores"]);null!=o&&he(t,["scores"],o);const i=fe(e,["contentType"]);return null!=i&&he(t,["contentType"],i),t}function gi(e){const t={},n=fe(e,["safetyAttributes","categories"]);null!=n&&he(t,["categories"],n);const o=fe(e,["safetyAttributes","scores"]);null!=o&&he(t,["scores"],o);const i=fe(e,["contentType"]);return null!=i&&he(t,["contentType"],i),t}function yi(e){const t={},n=fe(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==fe(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const n=fe(e,["description"]);null!=n&&he(t,["description"],n);const o=fe(e,["name"]);null!=o&&he(t,["name"],o);const i=fe(e,["parameters"]);null!=i&&he(t,["parameters"],i);const s=fe(e,["parametersJsonSchema"]);null!=s&&he(t,["parametersJsonSchema"],s);const r=fe(e,["response"]);null!=r&&he(t,["response"],r);const l=fe(e,["responseJsonSchema"]);return null!=l&&he(t,["responseJsonSchema"],l),t}(e))),he(t,["functionDeclarations"],e)}const o=fe(e,["retrieval"]);null!=o&&he(t,["retrieval"],o);const i=fe(e,["googleSearchRetrieval"]);null!=i&&he(t,["googleSearchRetrieval"],i);const s=fe(e,["computerUse"]);if(null!=s&&he(t,["computerUse"],s),void 0!==fe(e,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=fe(e,["codeExecution"]);null!=r&&he(t,["codeExecution"],r);const l=fe(e,["enterpriseWebSearch"]);null!=l&&he(t,["enterpriseWebSearch"],l);const a=fe(e,["googleMaps"]);null!=a&&he(t,["googleMaps"],a);const u=fe(e,["googleSearch"]);null!=u&&he(t,["googleSearch"],u);const c=fe(e,["urlContext"]);return null!=c&&he(t,["urlContext"],c),t}function vi(e){const t={},n=fe(e,["uri"]);null!=n&&he(t,["uri"],n);const o=fe(e,["videoBytes"]);null!=o&&he(t,["encodedVideo"],bo(o));const i=fe(e,["mimeType"]);return null!=i&&he(t,["encoding"],i),t}function Ei(e){const t={},n=fe(e,["uri"]);null!=n&&he(t,["gcsUri"],n);const o=fe(e,["videoBytes"]);null!=o&&he(t,["bytesBase64Encoded"],bo(o));const i=fe(e,["mimeType"]);return null!=i&&he(t,["mimeType"],i),t}function _i(e,t){const n=fe(e,["mimeType"]);void 0!==t&&null!=n&&he(t,["mimeType"],n);const o=fe(e,["displayName"]);void 0!==t&&null!=o&&he(t,["displayName"],o);const i=fe(e,["customMetadata"]);if(void 0!==t&&null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["customMetadata"],e)}const s=fe(e,["chunkingConfig"]);return void 0!==t&&null!=s&&he(t,["chunkingConfig"],s),{}}const Ii="x-goog-api-client";class bi{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=null!==(t=this.clientOptions.apiVersion)&&void 0!==t?t:"v1beta1",o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=null!==(n=this.clientOptions.apiVersion)&&void 0!==n?n:"v1beta",o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:(this.clientOptions.project=void 0,this.clientOptions.location=void 0)}isVertexAI(){var e;return null!==(e=this.clientOptions.vertexai)&&void 0!==e&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw new Error("HTTP options are not correctly set.");const t=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&t.push(e.apiVersion),t.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol="http:"==t.protocol?"ws":"wss",t.toString()}setBaseUrl(e){if(!this.clientOptions.httpOptions)throw new Error("HTTP options are not correctly set.");this.clientOptions.httpOptions.baseUrl=e}constructUrl(e,t,n){const o=[this.getRequestUrlInternal(t)];return n&&o.push(this.getBaseResourcePath()),""!==e&&o.push(e),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||"GET"===e.httpMethod&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[s,r]of Object.entries(e.queryParams))o.searchParams.append(s,String(r));let i={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,t,o.toString(),e.abortSignal),this.unaryApiCall(o,i,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[o,i]of Object.entries(t))"object"==typeof i?n[o]=Object.assign(Object.assign({},n[o]),i):void 0!==i&&(n[o]=i);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,n);o.searchParams.has("alt")&&"sse"===o.searchParams.get("alt")||o.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,t,o.toString(),e.abortSignal),this.streamApiCall(o,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,o){if(t&&t.timeout||o){const n=new AbortController,i=n.signal;if(t.timeout&&(null==t?void 0:t.timeout)>0){const e=setTimeout(()=>n.abort(),t.timeout);e&&"function"==typeof e.unref&&e.unref()}o&&o.addEventListener("abort",()=>{n.abort()}),e.signal=i}return t&&null!==t.extraBody&&function(e,t){if(!t||0===Object.keys(t).length)return;if(e.body instanceof Blob)return;let n={};if("string"==typeof e.body&&e.body.length>0)try{const t=JSON.parse(e.body);if("object"!=typeof t||null===t||Array.isArray(t))return;n=t}catch(i){return}const o=function e(t,n){const o=Object.assign({},t);for(const i in n)if(Object.prototype.hasOwnProperty.call(n,i)){const t=n[i],s=o[i];t&&"object"==typeof t&&!Array.isArray(t)&&s&&"object"==typeof s&&!Array.isArray(s)?o[i]=e(s,t):o[i]=t}return o}(n,t);e.body=JSON.stringify(o)}(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await Ai(e),new Sn(e))).catch(e=>{throw e instanceof Error?e:new Error(JSON.stringify(e))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await Ai(e),this.processStreamResponse(e))).catch(e=>{throw e instanceof Error?e:new Error(JSON.stringify(e))})}processStreamResponse(e){return Vo(this,arguments,function*(){var t;const n=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.getReader(),o=new TextDecoder("utf-8");if(!n)throw new Error("Response body is empty");try{let t="";const s="data:",r=["\n\n","\r\r","\r\n\r\n"];for(;;){const{done:l,value:a}=yield Fo(n.read());if(l){if(t.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=o.decode(a,{stream:!0});try{const e=JSON.parse(u);if("error"in e){const t=JSON.parse(JSON.stringify(e.error)),n=t.status,o=t.code,i=`got status: ${n}. ${JSON.stringify(e)}`;if(o>=400&&o<600)throw new zo({message:i,status:o})}}catch(i){if("ApiError"===i.name)throw i}t+=u;let c=-1,d=0;for(;;){c=-1,d=0;for(const e of r){const n=t.indexOf(e);-1!==n&&(-1===c||n<c)&&(c=n,d=e.length)}if(-1===c)break;const n=t.substring(0,c);t=t.substring(c+d);const o=n.trim();if(o.startsWith(s)){const t=o.substring(s.length).trim();try{const n=new Response(t,{headers:null==e?void 0:e.headers,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText});yield yield Fo(new Sn(n))}catch(i){throw new Error(`exception parsing stream chunk ${t}. ${i}`)}}}}}finally{n.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(e=>{throw new Error(`exception ${e} sending request`)})}getDefaultHeaders(){const e={},t="google-genai-sdk/1.34.0 "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[Ii]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e,t){const n=new Headers;if(e&&e.headers){for(const[t,o]of Object.entries(e.headers))n.append(t,o);e.timeout&&e.timeout>0&&n.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}getFileName(e){var t;let n="";return"string"==typeof e&&(n=e.replace(/[/\\]+$/,""),n=null!==(t=n.split(/[/\\]/).pop())&&void 0!==t?t:""),n}async uploadFile(e,t){var n;const o={};null!=t&&(o.mimeType=t.mimeType,o.name=t.name,o.displayName=t.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const i=this.clientOptions.uploader,s=await i.stat(e);o.sizeBytes=String(s.size);const r=null!==(n=null==t?void 0:t.mimeType)&&void 0!==n?n:s.type;if(void 0===r||""===r)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=r;const l={file:o},a=this.getFileName(e),u=pe("upload/v1beta/files",l._url),c=await this.fetchUploadUrl(u,o.sizeBytes,o.mimeType,a,l,null==t?void 0:t.httpOptions);return i.upload(e,c,this)}async uploadFileToFileSearchStore(e,t,n){var o;const i=this.clientOptions.uploader,s=await i.stat(t),r=String(s.size),l=null!==(o=null==n?void 0:n.mimeType)&&void 0!==o?o:s.type;if(void 0===l||""===l)throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const a=`upload/v1beta/${e}:uploadToFileSearchStore`,u=this.getFileName(t),c={};null!=n&&_i(n,c);const d=await this.fetchUploadUrl(a,r,l,u,c,null==n?void 0:n.httpOptions);return i.uploadToFileSearchStore(t,d,this)}async downloadFile(e){const t=this.clientOptions.downloader;await t.download(e,this)}async fetchUploadUrl(e,t,n,o,i,s){var r;let l={};l=s||{apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${n}`},o?{"X-Goog-Upload-File-Name":o}:{})};const a=await this.request({path:e,body:JSON.stringify(i),httpMethod:"POST",httpOptions:l});if(!a||!(null==a?void 0:a.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=null===(r=null==a?void 0:a.headers)||void 0===r?void 0:r["x-goog-upload-url"];if(void 0===u)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function Ai(e){var t;if(void 0===e)throw new Error("response is undefined");if(!e.ok){const n=e.status;let o;o=(null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}};const i=JSON.stringify(o);if(n>=400&&n<600)throw new zo({message:i,status:n});throw new Error(i)}}function Ti(e){for(const t of e){if(Oi(t))return!0;if("object"==typeof t&&"inputSchema"in t)return!0}return!1}function Si(e){var t;const n=null!==(t=e[Ii])&&void 0!==t?t:"";e[Ii]=(n+" mcp_used/unknown").trimStart()}function Oi(e){return null!==e&&"object"==typeof e&&e instanceof wi}function Ci(e){return Vo(this,arguments,function*(e,t=100){let n,o=0;for(;o<t;){const t=yield Fo(e.listTools({cursor:n}));for(const e of t.tools)yield yield Fo(e),o++;if(!t.nextCursor)break;n=t.nextCursor}})}class wi{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new wi(e,t)}async initialize(){var e,t,n,o;if(this.mcpTools.length>0)return;const i={},s=[];for(const c of this.mcpClients)try{for(var r,l=!0,a=(t=void 0,Bo(Ci(c)));!(e=(r=await a.next()).done);l=!0){o=r.value,l=!1;const e=o;s.push(e);const t=e.name;if(i[t])throw new Error(`Duplicate function name ${t} found in MCP tools. Please ensure function names are unique.`);i[t]=c}}catch(u){t={error:u}}finally{try{l||e||!(n=a.return)||await n.call(a)}finally{if(t)throw t.error}}this.mcpTools=s,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),function(e,t={}){const n=[],o=new Set;for(const i of e){const e=i.name;if(o.has(e))throw new Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);o.add(e);const s=Co(i,t);s.functionDeclarations&&n.push(...s.functionDeclarations)}return{functionDeclarations:n}}(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const e=this.functionNameToMcpClient[n.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const i=await e.callTool({name:n.name,arguments:n.args},void 0,o);t.push({functionResponse:{name:n.name,response:i.isError?{error:i}:i}})}return t}}class Ni{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");const o=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),s=function(e){const t=new Headers;for(const[n,o]of Object.entries(e))t.append(n,o);return t}(this.apiClient.getDefaultHeaders()),r=`${o}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateMusic?key=${this.apiClient.getApiKey()}`;let l=()=>{};const a=new Promise(e=>{l=e}),u=e.callbacks,c=(this.apiClient,{onopen:function(){l({})},onmessage:e=>{!async function(e,t,n){const o=new Xn;let i;i=n.data instanceof Blob?JSON.parse(await n.data.text()):JSON.parse(n.data),Object.assign(o,i),t(o)}(0,u.onmessage,e)},onerror:null!==(t=null==u?void 0:u.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null==u?void 0:u.onclose)&&void 0!==n?n:function(e){}}),d=this.webSocketFactory.create(r,function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(s),c);d.connect(),await a;const p={setup:{model:Zn(this.apiClient,e.model)}};return d.send(JSON.stringify(p)),new Ri(d,this.apiClient)}}class Ri{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=function(e){const t={},n=fe(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["weightedPrompts"],e)}return t}(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=function(e){const t={},n=fe(e,["musicGenerationConfig"]);return null!=n&&he(t,["musicGenerationConfig"],n),t}(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(In.PLAY)}pause(){this.sendPlaybackControl(In.PAUSE)}stop(){this.sendPlaybackControl(In.STOP)}resetContext(){this.sendPlaybackControl(In.RESET_CONTEXT)}close(){this.conn.close()}}class xi{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new Ni(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,o,i,s,r;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion();let u;const c=this.apiClient.getHeaders();e.config&&e.config.tools&&Ti(e.config.tools)&&Si(c);const d=function(e){const t=new Headers;for(const[n,o]of Object.entries(e))t.append(n,o);return t}(c);if(this.apiClient.isVertexAI())u=`${l}/ws/google.cloud.aiplatform.${a}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(d,u);else{const e=this.apiClient.getApiKey();let t="BidiGenerateContent",n="key";(null==e?void 0:e.startsWith("auth_tokens/"))&&(t="BidiGenerateContentConstrained",n="access_token"),u=`${l}/ws/google.ai.generativelanguage.${a}.GenerativeService.${t}?${n}=${e}`}let p=()=>{};const h=new Promise(e=>{p=e}),f=e.callbacks,m=this.apiClient,g={onopen:function(){var e;null===(e=null==f?void 0:f.onopen)||void 0===e||e.call(f),p({})},onmessage:e=>{!async function(e,t,n){const o=new zn;let i;i=n.data instanceof Blob?await n.data.text():n.data instanceof ArrayBuffer?(new TextDecoder).decode(n.data):n.data;const s=JSON.parse(i);if(e.isVertexAI()){const e=function(e){const t={},n=fe(e,["setupComplete"]);null!=n&&he(t,["setupComplete"],n);const o=fe(e,["serverContent"]);null!=o&&he(t,["serverContent"],o);const i=fe(e,["toolCall"]);null!=i&&he(t,["toolCall"],i);const s=fe(e,["toolCallCancellation"]);null!=s&&he(t,["toolCallCancellation"],s);const r=fe(e,["usageMetadata"]);null!=r&&he(t,["usageMetadata"],function(e){const t={},n=fe(e,["promptTokenCount"]);null!=n&&he(t,["promptTokenCount"],n);const o=fe(e,["cachedContentTokenCount"]);null!=o&&he(t,["cachedContentTokenCount"],o);const i=fe(e,["candidatesTokenCount"]);null!=i&&he(t,["responseTokenCount"],i);const s=fe(e,["toolUsePromptTokenCount"]);null!=s&&he(t,["toolUsePromptTokenCount"],s);const r=fe(e,["thoughtsTokenCount"]);null!=r&&he(t,["thoughtsTokenCount"],r);const l=fe(e,["totalTokenCount"]);null!=l&&he(t,["totalTokenCount"],l);const a=fe(e,["promptTokensDetails"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["promptTokensDetails"],e)}const u=fe(e,["cacheTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["cacheTokensDetails"],e)}const c=fe(e,["candidatesTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["responseTokensDetails"],e)}const d=fe(e,["toolUsePromptTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["toolUsePromptTokensDetails"],e)}const p=fe(e,["trafficType"]);return null!=p&&he(t,["trafficType"],p),t}(r));const l=fe(e,["goAway"]);null!=l&&he(t,["goAway"],l);const a=fe(e,["sessionResumptionUpdate"]);null!=a&&he(t,["sessionResumptionUpdate"],a);const u=fe(e,["voiceActivityDetectionSignal"]);return null!=u&&he(t,["voiceActivityDetectionSignal"],u),t}(s);Object.assign(o,e)}else{const e=s;Object.assign(o,e)}t(o)}(m,f.onmessage,e)},onerror:null!==(t=null==f?void 0:f.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null==f?void 0:f.onclose)&&void 0!==n?n:function(e){}},y=this.webSocketFactory.create(u,function(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}(d),g);y.connect(),await h;let v=Zn(this.apiClient,e.model);this.apiClient.isVertexAI()&&v.startsWith("publishers/")&&(v=`projects/${this.apiClient.getProject()}/locations/${this.apiClient.getLocation()}/`+v);let E={};this.apiClient.isVertexAI()&&void 0===(null===(o=e.config)||void 0===o?void 0:o.responseModalities)&&(void 0===e.config?e.config={responseModalities:[nt.AUDIO]}:e.config.responseModalities=[nt.AUDIO]),null===(i=e.config)||void 0===i||i.generationConfig;const _=null!==(r=null===(s=e.config)||void 0===s?void 0:s.tools)&&void 0!==r?r:[],I=[];for(const A of _)if(this.isCallableTool(A)){const e=A;I.push(await e.tool())}else I.push(A);I.length>0&&(e.config.tools=I);const b={model:v,config:e.config,callbacks:e.callbacks};return E=this.apiClient.isVertexAI()?function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["setup","model"],Zn(e,o));const i=fe(t,["config"]);return null!=i&&he(n,["config"],function(e,t){const n=fe(e,["generationConfig"]);void 0!==t&&null!=n&&he(t,["setup","generationConfig"],function(e){const t={},n=fe(e,["modelSelectionConfig"]);null!=n&&he(t,["modelConfig"],n);const o=fe(e,["responseJsonSchema"]);null!=o&&he(t,["responseJsonSchema"],o);const i=fe(e,["audioTimestamp"]);null!=i&&he(t,["audioTimestamp"],i);const s=fe(e,["candidateCount"]);null!=s&&he(t,["candidateCount"],s);const r=fe(e,["enableAffectiveDialog"]);null!=r&&he(t,["enableAffectiveDialog"],r);const l=fe(e,["frequencyPenalty"]);null!=l&&he(t,["frequencyPenalty"],l);const a=fe(e,["logprobs"]);null!=a&&he(t,["logprobs"],a);const u=fe(e,["maxOutputTokens"]);null!=u&&he(t,["maxOutputTokens"],u);const c=fe(e,["mediaResolution"]);null!=c&&he(t,["mediaResolution"],c);const d=fe(e,["presencePenalty"]);null!=d&&he(t,["presencePenalty"],d);const p=fe(e,["responseLogprobs"]);null!=p&&he(t,["responseLogprobs"],p);const h=fe(e,["responseMimeType"]);null!=h&&he(t,["responseMimeType"],h);const f=fe(e,["responseModalities"]);null!=f&&he(t,["responseModalities"],f);const m=fe(e,["responseSchema"]);null!=m&&he(t,["responseSchema"],m);const g=fe(e,["routingConfig"]);null!=g&&he(t,["routingConfig"],g);const y=fe(e,["seed"]);null!=y&&he(t,["seed"],y);const v=fe(e,["speechConfig"]);null!=v&&he(t,["speechConfig"],v);const E=fe(e,["stopSequences"]);null!=E&&he(t,["stopSequences"],E);const _=fe(e,["temperature"]);null!=_&&he(t,["temperature"],_);const I=fe(e,["thinkingConfig"]);null!=I&&he(t,["thinkingConfig"],I);const b=fe(e,["topK"]);null!=b&&he(t,["topK"],b);const A=fe(e,["topP"]);if(null!=A&&he(t,["topP"],A),void 0!==fe(e,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(n));const o=fe(e,["responseModalities"]);void 0!==t&&null!=o&&he(t,["setup","generationConfig","responseModalities"],o);const i=fe(e,["temperature"]);void 0!==t&&null!=i&&he(t,["setup","generationConfig","temperature"],i);const s=fe(e,["topP"]);void 0!==t&&null!=s&&he(t,["setup","generationConfig","topP"],s);const r=fe(e,["topK"]);void 0!==t&&null!=r&&he(t,["setup","generationConfig","topK"],r);const l=fe(e,["maxOutputTokens"]);void 0!==t&&null!=l&&he(t,["setup","generationConfig","maxOutputTokens"],l);const a=fe(e,["mediaResolution"]);void 0!==t&&null!=a&&he(t,["setup","generationConfig","mediaResolution"],a);const u=fe(e,["seed"]);void 0!==t&&null!=u&&he(t,["setup","generationConfig","seed"],u);const c=fe(e,["speechConfig"]);void 0!==t&&null!=c&&he(t,["setup","generationConfig","speechConfig"],yo(c));const d=fe(e,["thinkingConfig"]);void 0!==t&&null!=d&&he(t,["setup","generationConfig","thinkingConfig"],d);const p=fe(e,["enableAffectiveDialog"]);void 0!==t&&null!=p&&he(t,["setup","generationConfig","enableAffectiveDialog"],p);const h=fe(e,["systemInstruction"]);void 0!==t&&null!=h&&he(t,["setup","systemInstruction"],co(h));const f=fe(e,["tools"]);if(void 0!==t&&null!=f){let e=Eo(f);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={};if(void 0!==fe(e,["behavior"]))throw new Error("behavior parameter is not supported in Vertex AI.");const n=fe(e,["description"]);null!=n&&he(t,["description"],n);const o=fe(e,["name"]);null!=o&&he(t,["name"],o);const i=fe(e,["parameters"]);null!=i&&he(t,["parameters"],i);const s=fe(e,["parametersJsonSchema"]);null!=s&&he(t,["parametersJsonSchema"],s);const r=fe(e,["response"]);null!=r&&he(t,["response"],r);const l=fe(e,["responseJsonSchema"]);return null!=l&&he(t,["responseJsonSchema"],l),t}(e))),he(t,["functionDeclarations"],e)}const o=fe(e,["retrieval"]);null!=o&&he(t,["retrieval"],o);const i=fe(e,["googleSearchRetrieval"]);null!=i&&he(t,["googleSearchRetrieval"],i);const s=fe(e,["computerUse"]);if(null!=s&&he(t,["computerUse"],s),void 0!==fe(e,["fileSearch"]))throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=fe(e,["codeExecution"]);null!=r&&he(t,["codeExecution"],r);const l=fe(e,["enterpriseWebSearch"]);null!=l&&he(t,["enterpriseWebSearch"],l);const a=fe(e,["googleMaps"]);null!=a&&he(t,["googleMaps"],a);const u=fe(e,["googleSearch"]);null!=u&&he(t,["googleSearch"],u);const c=fe(e,["urlContext"]);return null!=c&&he(t,["urlContext"],c),t}(vo(e)))),he(t,["setup","tools"],e)}const m=fe(e,["sessionResumption"]);void 0!==t&&null!=m&&he(t,["setup","sessionResumption"],m);const g=fe(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&he(t,["setup","inputAudioTranscription"],g);const y=fe(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&he(t,["setup","outputAudioTranscription"],y);const v=fe(e,["realtimeInputConfig"]);void 0!==t&&null!=v&&he(t,["setup","realtimeInputConfig"],v);const E=fe(e,["contextWindowCompression"]);void 0!==t&&null!=E&&he(t,["setup","contextWindowCompression"],E);const _=fe(e,["proactivity"]);void 0!==t&&null!=_&&he(t,["setup","proactivity"],_);const I=fe(e,["explicitVadSignal"]);return void 0!==t&&null!=I&&he(t,["setup","explicitVadSignal"],I),{}}(i,n)),n}(this.apiClient,b):function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["setup","model"],Zn(e,o));const i=fe(t,["config"]);return null!=i&&he(n,["config"],Zo(i,n)),n}(this.apiClient,b),delete E.config,y.send(JSON.stringify(E)),new Di(y,this.apiClient)}isCallableTool(e){return"callTool"in e&&"function"==typeof e.callTool}}const Pi={turnComplete:!0};class Di{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let o=[];try{o=ho(t.turns),e.isVertexAI()||(o=o.map(e=>ni(e)))}catch(n){throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:o,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(null==t.functionResponses)throw new Error("functionResponses is required.");if(n=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses],0===n.length)throw new Error("functionResponses is required.");for(const o of n){if("object"!=typeof o||null===o||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},Pi),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:ti(e)}:{realtimeInput:ei(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function Mi(e){var t,n,o;if(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.disable)return!0;let i=!1;for(const r of null!==(n=null==e?void 0:e.tools)&&void 0!==n?n:[])if(Ui(r)){i=!0;break}if(!i)return!0;const s=null===(o=null==e?void 0:e.automaticFunctionCalling)||void 0===o?void 0:o.maximumRemoteCalls;return!!(s&&(s<0||!Number.isInteger(s))||0==s)}function Ui(e){return"callTool"in e&&"function"==typeof e.callTool}function ji(e){var t;const n=[];return(null===(t=null==e?void 0:e.config)||void 0===t?void 0:t.tools)?(e.config.tools.forEach((e,t)=>{if(Ui(e))return;const o=e;o.functionDeclarations&&o.functionDeclarations.length>0&&n.push(t)}),n):n}function ki(e){var t;return!(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.ignoreCallHistory)}class qi extends de{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>{var t,n,o,i,s;const r=await this.processParamsMaybeAddMcpUsage(e);if(this.maybeMoveToResponseJsonSchem(e),!function(e){var t,n,o;return null!==(o=null===(n=null===(t=e.config)||void 0===t?void 0:t.tools)||void 0===n?void 0:n.some(e=>Ui(e)))&&void 0!==o&&o}(e)||Mi(e.config))return await this.generateContentInternal(r);const l=ji(e);if(l.length>0){const e=l.map(e=>`tools[${e}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${e}.`)}let a,u;const c=ho(r.contents),d=null!==(o=null===(n=null===(t=r.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==o?o:10;let p=0;for(;p<d&&(a=await this.generateContentInternal(r),a.functionCalls&&0!==a.functionCalls.length);){const t=a.candidates[0].content,n=[];for(const o of null!==(s=null===(i=e.config)||void 0===i?void 0:i.tools)&&void 0!==s?s:[])if(Ui(o)){const e=o,t=await e.callTool(a.functionCalls);n.push(...t)}p++,u={role:"user",parts:n},r.contents=ho(r.contents),r.contents.push(t),r.contents.push(u),ki(r.config)&&(c.push(t),c.push(u))}return ki(r.config)&&(a.automaticFunctionCallingHistory=c),a},this.generateContentStream=async e=>{var t,n,o,i,s;if(this.maybeMoveToResponseJsonSchem(e),Mi(e.config)){const t=await this.processParamsMaybeAddMcpUsage(e);return await this.generateContentStreamInternal(t)}const r=ji(e);if(r.length>0){const e=r.map(e=>`tools[${e}]`).join(", ");throw new Error(`Incompatible tools found at ${e}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const l=null===(o=null===(n=null===(t=null==e?void 0:e.config)||void 0===t?void 0:t.toolConfig)||void 0===n?void 0:n.functionCallingConfig)||void 0===o?void 0:o.streamFunctionCallArguments,a=null===(s=null===(i=null==e?void 0:e.config)||void 0===i?void 0:i.automaticFunctionCalling)||void 0===s?void 0:s.disable;if(l&&!a)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(e)},this.generateImages=async e=>await this.generateImagesInternal(e).then(e=>{var t;let n;const o=[];if(null==e?void 0:e.generatedImages)for(const s of e.generatedImages)s&&(null==s?void 0:s.safetyAttributes)&&"Positive Prompt"===(null===(t=null==s?void 0:s.safetyAttributes)||void 0===t?void 0:t.contentType)?n=null==s?void 0:s.safetyAttributes:o.push(s);let i;return i=n?{generatedImages:o,positivePromptSafetyAttributes:n,sdkHttpResponse:e.sdkHttpResponse}:{generatedImages:o,sdkHttpResponse:e.sdkHttpResponse},i}),this.list=async e=>{var t;const n={config:Object.assign(Object.assign({},{queryBase:!0}),null==e?void 0:e.config)};if(this.apiClient.isVertexAI()&&!n.config.queryBase){if(null===(t=n.config)||void 0===t?void 0:t.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");n.config.filter="labels.tune-type:*"}return new ko(An.PAGED_ITEM_MODELS,e=>this.listInternal(e),await this.listInternal(n),n)},this.editImage=async e=>{const t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(e=>e.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));const n={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(n)},this.generateVideos=async e=>{var t,n,o,i,s,r;if((e.prompt||e.image||e.video)&&e.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||((null===(t=e.video)||void 0===t?void 0:t.uri)&&(null===(n=e.video)||void 0===n?void 0:n.videoBytes)?e.video={uri:e.video.uri,mimeType:e.video.mimeType}:(null===(i=null===(o=e.source)||void 0===o?void 0:o.video)||void 0===i?void 0:i.uri)&&(null===(r=null===(s=e.source)||void 0===s?void 0:s.video)||void 0===r?void 0:r.videoBytes)&&(e.source.video={uri:e.source.video.uri,mimeType:e.source.video.mimeType})),await this.generateVideosInternal(e)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,n,o;const i=null===(t=e.config)||void 0===t?void 0:t.tools;if(!i)return e;const s=await Promise.all(i.map(async e=>{if(Ui(e)){const t=e;return await t.tool()}return e})),r={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};if(r.config.tools=s,e.config&&e.config.tools&&Ti(e.config.tools)){const t=null!==(o=null===(n=e.config.httpOptions)||void 0===n?void 0:n.headers)&&void 0!==o?o:{};let i=Object.assign({},t);0===Object.keys(i).length&&(i=this.apiClient.getDefaultHeaders()),Si(i),r.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:i})}return r}async initAfcToolsMap(e){var t,n,o;const i=new Map;for(const s of null!==(n=null===(t=e.config)||void 0===t?void 0:t.tools)&&void 0!==n?n:[])if(Ui(s)){const e=s,t=await e.tool();for(const n of null!==(o=t.functionDeclarations)&&void 0!==o?o:[]){if(!n.name)throw new Error("Function declaration name is required.");if(i.has(n.name))throw new Error(`Duplicate tool declaration name: ${n.name}`);i.set(n.name,e)}}return i}async processAfcStream(e){var t,n,o;const i=null!==(o=null===(n=null===(t=e.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==o?o:10;let s=!1,r=0;return function(e,t,n){return Vo(this,arguments,function*(){for(var o,l,a,u,c,d;r<i;){s&&(r++,s=!1);const g=yield Fo(e.processParamsMaybeAddMcpUsage(n)),y=yield Fo(e.generateContentStreamInternal(g)),v=[],E=[];try{for(var p,h=!0,f=(l=void 0,Bo(y));!(o=(p=yield Fo(f.next())).done);h=!0){u=p.value,h=!1;const e=u;if(yield yield Fo(e),e.candidates&&(null===(c=e.candidates[0])||void 0===c?void 0:c.content)){E.push(e.candidates[0].content);for(const n of null!==(d=e.candidates[0].content.parts)&&void 0!==d?d:[])if(r<i&&n.functionCall){if(!n.functionCall.name)throw new Error("Function call name was not returned by the model.");if(!t.has(n.functionCall.name))throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${t.keys()}, mising tool: ${n.functionCall.name}`);{const e=yield Fo(t.get(n.functionCall.name).callTool([n.functionCall]));v.push(...e)}}}}}catch(m){l={error:m}}finally{try{h||o||!(a=f.return)||(yield Fo(a.call(f)))}finally{if(l)throw l.error}}if(!(v.length>0))break;{s=!0;const e=new On;e.candidates=[{content:{role:"user",parts:v}}],yield yield Fo(e);const t=[];t.push(...E),t.push({role:"user",parts:v});const o=ho(n.contents).concat(t);n.contents=o}}})}(this,await this.initAfcToolsMap(e),e)}async generateContentInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=ii(this.apiClient,e);return r=pe("{model}:generateContent",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=ri(e),n=new On;return Object.assign(n,t),n})}{const t=oi(this.apiClient,e);return r=pe("{model}:generateContent",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=si(e),n=new On;return Object.assign(n,t),n})}}async generateContentStreamInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=ii(this.apiClient,e);return r=pe("{model}:streamGenerateContent?alt=sse",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.requestStream({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}),s.then(function(e){return Vo(this,arguments,function*(){var t,n,o,i;try{for(var s,r=!0,l=Bo(e);!(t=(s=yield Fo(l.next())).done);r=!0){i=s.value,r=!1;const e=i,t=ri(yield Fo(e.json()));t.sdkHttpResponse={headers:e.headers};const n=new On;Object.assign(n,t),yield yield Fo(n)}}catch(a){n={error:a}}finally{try{r||t||!(o=l.return)||(yield Fo(o.call(l)))}finally{if(n)throw n.error}}})})}{const t=oi(this.apiClient,e);return r=pe("{model}:streamGenerateContent?alt=sse",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.requestStream({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}),s.then(function(e){return Vo(this,arguments,function*(){var t,n,o,i;try{for(var s,r=!0,l=Bo(e);!(t=(s=yield Fo(l.next())).done);r=!0){i=s.value,r=!1;const e=i,t=si(yield Fo(e.json()));t.sdkHttpResponse={headers:e.headers};const n=new On;Object.assign(n,t),yield yield Fo(n)}}catch(a){n={error:a}}finally{try{r||t||!(o=l.return)||(yield Fo(o.call(l)))}finally{if(n)throw n.error}}})})}}async embedContent(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["contents"]);if(null!=i){let t=po(e,i);Array.isArray(t)&&(t=t.map(e=>e)),he(n,["instances[]","content"],t)}const s=fe(t,["config"]);return null!=s&&function(e,t){const n=fe(e,["taskType"]);void 0!==t&&null!=n&&he(t,["instances[]","task_type"],n);const o=fe(e,["title"]);void 0!==t&&null!=o&&he(t,["instances[]","title"],o);const i=fe(e,["outputDimensionality"]);void 0!==t&&null!=i&&he(t,["parameters","outputDimensionality"],i);const s=fe(e,["mimeType"]);void 0!==t&&null!=s&&he(t,["instances[]","mimeType"],s);const r=fe(e,["autoTruncate"]);void 0!==t&&null!=r&&he(t,["parameters","autoTruncate"],r)}(s,n),n}(this.apiClient,e);return r=pe("{model}:predict",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["predictions[]","embeddings"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["values"]);null!=n&&he(t,["values"],n);const o=fe(e,["statistics"]);return null!=o&&he(t,["statistics"],function(e){const t={},n=fe(e,["truncated"]);null!=n&&he(t,["truncated"],n);const o=fe(e,["token_count"]);return null!=o&&he(t,["tokenCount"],o),t}(o)),t}(e))),he(t,["embeddings"],e)}const i=fe(e,["metadata"]);return null!=i&&he(t,["metadata"],i),t}(e),n=new Cn;return Object.assign(n,t),n})}{const t=function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["contents"]);if(null!=i){let t=po(e,i);Array.isArray(t)&&(t=t.map(e=>e)),he(n,["requests[]","content"],t)}const s=fe(t,["config"]);null!=s&&function(e,t){const n=fe(e,["taskType"]);void 0!==t&&null!=n&&he(t,["requests[]","taskType"],n);const o=fe(e,["title"]);void 0!==t&&null!=o&&he(t,["requests[]","title"],o);const i=fe(e,["outputDimensionality"]);if(void 0!==t&&null!=i&&he(t,["requests[]","outputDimensionality"],i),void 0!==fe(e,["mimeType"]))throw new Error("mimeType parameter is not supported in Gemini API.");if(void 0!==fe(e,["autoTruncate"]))throw new Error("autoTruncate parameter is not supported in Gemini API.")}(s,n);const r=fe(t,["model"]);return void 0!==r&&he(n,["requests[]","model"],Zn(e,r)),n}(this.apiClient,e);return r=pe("{model}:batchEmbedContents",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["embeddings"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["embeddings"],e)}const i=fe(e,["metadata"]);return null!=i&&he(t,["metadata"],i),t}(e),n=new Cn;return Object.assign(n,t),n})}}async generateImagesInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["prompt"]);null!=i&&he(n,["instances[0]","prompt"],i);const s=fe(t,["config"]);return null!=s&&function(e,t){const n=fe(e,["outputGcsUri"]);void 0!==t&&null!=n&&he(t,["parameters","storageUri"],n);const o=fe(e,["negativePrompt"]);void 0!==t&&null!=o&&he(t,["parameters","negativePrompt"],o);const i=fe(e,["numberOfImages"]);void 0!==t&&null!=i&&he(t,["parameters","sampleCount"],i);const s=fe(e,["aspectRatio"]);void 0!==t&&null!=s&&he(t,["parameters","aspectRatio"],s);const r=fe(e,["guidanceScale"]);void 0!==t&&null!=r&&he(t,["parameters","guidanceScale"],r);const l=fe(e,["seed"]);void 0!==t&&null!=l&&he(t,["parameters","seed"],l);const a=fe(e,["safetyFilterLevel"]);void 0!==t&&null!=a&&he(t,["parameters","safetySetting"],a);const u=fe(e,["personGeneration"]);void 0!==t&&null!=u&&he(t,["parameters","personGeneration"],u);const c=fe(e,["includeSafetyAttributes"]);void 0!==t&&null!=c&&he(t,["parameters","includeSafetyAttributes"],c);const d=fe(e,["includeRaiReason"]);void 0!==t&&null!=d&&he(t,["parameters","includeRaiReason"],d);const p=fe(e,["language"]);void 0!==t&&null!=p&&he(t,["parameters","language"],p);const h=fe(e,["outputMimeType"]);void 0!==t&&null!=h&&he(t,["parameters","outputOptions","mimeType"],h);const f=fe(e,["outputCompressionQuality"]);void 0!==t&&null!=f&&he(t,["parameters","outputOptions","compressionQuality"],f);const m=fe(e,["addWatermark"]);void 0!==t&&null!=m&&he(t,["parameters","addWatermark"],m);const g=fe(e,["labels"]);void 0!==t&&null!=g&&he(t,["labels"],g);const y=fe(e,["imageSize"]);void 0!==t&&null!=y&&he(t,["parameters","sampleImageSize"],y);const v=fe(e,["enhancePrompt"]);void 0!==t&&null!=v&&he(t,["parameters","enhancePrompt"],v)}(s,n),n}(this.apiClient,e);return r=pe("{model}:predict",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["predictions"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>ui(e))),he(t,["generatedImages"],e)}const i=fe(e,["positivePromptSafetyAttributes"]);return null!=i&&he(t,["positivePromptSafetyAttributes"],gi(i)),t}(e),n=new wn;return Object.assign(n,t),n})}{const t=function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["prompt"]);null!=i&&he(n,["instances[0]","prompt"],i);const s=fe(t,["config"]);return null!=s&&function(e,t){if(void 0!==fe(e,["outputGcsUri"]))throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==fe(e,["negativePrompt"]))throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=fe(e,["numberOfImages"]);void 0!==t&&null!=n&&he(t,["parameters","sampleCount"],n);const o=fe(e,["aspectRatio"]);void 0!==t&&null!=o&&he(t,["parameters","aspectRatio"],o);const i=fe(e,["guidanceScale"]);if(void 0!==t&&null!=i&&he(t,["parameters","guidanceScale"],i),void 0!==fe(e,["seed"]))throw new Error("seed parameter is not supported in Gemini API.");const s=fe(e,["safetyFilterLevel"]);void 0!==t&&null!=s&&he(t,["parameters","safetySetting"],s);const r=fe(e,["personGeneration"]);void 0!==t&&null!=r&&he(t,["parameters","personGeneration"],r);const l=fe(e,["includeSafetyAttributes"]);void 0!==t&&null!=l&&he(t,["parameters","includeSafetyAttributes"],l);const a=fe(e,["includeRaiReason"]);void 0!==t&&null!=a&&he(t,["parameters","includeRaiReason"],a);const u=fe(e,["language"]);void 0!==t&&null!=u&&he(t,["parameters","language"],u);const c=fe(e,["outputMimeType"]);void 0!==t&&null!=c&&he(t,["parameters","outputOptions","mimeType"],c);const d=fe(e,["outputCompressionQuality"]);if(void 0!==t&&null!=d&&he(t,["parameters","outputOptions","compressionQuality"],d),void 0!==fe(e,["addWatermark"]))throw new Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==fe(e,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");const p=fe(e,["imageSize"]);if(void 0!==t&&null!=p&&he(t,["parameters","sampleImageSize"],p),void 0!==fe(e,["enhancePrompt"]))throw new Error("enhancePrompt parameter is not supported in Gemini API.")}(s,n),n}(this.apiClient,e);return r=pe("{model}:predict",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["predictions"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["_self"]);null!=n&&he(t,["image"],function(e){const t={},n=fe(e,["bytesBase64Encoded"]);null!=n&&he(t,["imageBytes"],bo(n));const o=fe(e,["mimeType"]);return null!=o&&he(t,["mimeType"],o),t}(n));const o=fe(e,["raiFilteredReason"]);null!=o&&he(t,["raiFilteredReason"],o);const i=fe(e,["_self"]);return null!=i&&he(t,["safetyAttributes"],mi(i)),t}(e))),he(t,["generatedImages"],e)}const i=fe(e,["positivePromptSafetyAttributes"]);return null!=i&&he(t,["positivePromptSafetyAttributes"],mi(i)),t}(e),n=new wn;return Object.assign(n,t),n})}}async editImageInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["prompt"]);null!=i&&he(n,["instances[0]","prompt"],i);const s=fe(t,["referenceImages"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["referenceImage"]);null!=n&&he(t,["referenceImage"],pi(n));const o=fe(e,["referenceId"]);null!=o&&he(t,["referenceId"],o);const i=fe(e,["referenceType"]);null!=i&&he(t,["referenceType"],i);const s=fe(e,["maskImageConfig"]);null!=s&&he(t,["maskImageConfig"],function(e){const t={},n=fe(e,["maskMode"]);null!=n&&he(t,["maskMode"],n);const o=fe(e,["segmentationClasses"]);null!=o&&he(t,["maskClasses"],o);const i=fe(e,["maskDilation"]);return null!=i&&he(t,["dilation"],i),t}(s));const r=fe(e,["controlImageConfig"]);null!=r&&he(t,["controlImageConfig"],function(e){const t={},n=fe(e,["controlType"]);null!=n&&he(t,["controlType"],n);const o=fe(e,["enableControlImageComputation"]);return null!=o&&he(t,["computeControl"],o),t}(r));const l=fe(e,["styleImageConfig"]);null!=l&&he(t,["styleImageConfig"],l);const a=fe(e,["subjectImageConfig"]);return null!=a&&he(t,["subjectImageConfig"],a),t}(e))),he(n,["instances[0]","referenceImages"],e)}const r=fe(t,["config"]);return null!=r&&function(e,t){const n=fe(e,["outputGcsUri"]);void 0!==t&&null!=n&&he(t,["parameters","storageUri"],n);const o=fe(e,["negativePrompt"]);void 0!==t&&null!=o&&he(t,["parameters","negativePrompt"],o);const i=fe(e,["numberOfImages"]);void 0!==t&&null!=i&&he(t,["parameters","sampleCount"],i);const s=fe(e,["aspectRatio"]);void 0!==t&&null!=s&&he(t,["parameters","aspectRatio"],s);const r=fe(e,["guidanceScale"]);void 0!==t&&null!=r&&he(t,["parameters","guidanceScale"],r);const l=fe(e,["seed"]);void 0!==t&&null!=l&&he(t,["parameters","seed"],l);const a=fe(e,["safetyFilterLevel"]);void 0!==t&&null!=a&&he(t,["parameters","safetySetting"],a);const u=fe(e,["personGeneration"]);void 0!==t&&null!=u&&he(t,["parameters","personGeneration"],u);const c=fe(e,["includeSafetyAttributes"]);void 0!==t&&null!=c&&he(t,["parameters","includeSafetyAttributes"],c);const d=fe(e,["includeRaiReason"]);void 0!==t&&null!=d&&he(t,["parameters","includeRaiReason"],d);const p=fe(e,["language"]);void 0!==t&&null!=p&&he(t,["parameters","language"],p);const h=fe(e,["outputMimeType"]);void 0!==t&&null!=h&&he(t,["parameters","outputOptions","mimeType"],h);const f=fe(e,["outputCompressionQuality"]);void 0!==t&&null!=f&&he(t,["parameters","outputOptions","compressionQuality"],f);const m=fe(e,["addWatermark"]);void 0!==t&&null!=m&&he(t,["parameters","addWatermark"],m);const g=fe(e,["labels"]);void 0!==t&&null!=g&&he(t,["labels"],g);const y=fe(e,["editMode"]);void 0!==t&&null!=y&&he(t,["parameters","editMode"],y);const v=fe(e,["baseSteps"]);void 0!==t&&null!=v&&he(t,["parameters","editConfig","baseSteps"],v)}(r,n),n}(this.apiClient,e);return i=pe("{model}:predict",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),o.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["predictions"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>ui(e))),he(t,["generatedImages"],e)}return t}(e),n=new Nn;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["image"]);null!=i&&he(n,["instances[0]","image"],pi(i));const s=fe(t,["upscaleFactor"]);null!=s&&he(n,["parameters","upscaleConfig","upscaleFactor"],s);const r=fe(t,["config"]);return null!=r&&function(e,t){const n=fe(e,["outputGcsUri"]);void 0!==t&&null!=n&&he(t,["parameters","storageUri"],n);const o=fe(e,["safetyFilterLevel"]);void 0!==t&&null!=o&&he(t,["parameters","safetySetting"],o);const i=fe(e,["personGeneration"]);void 0!==t&&null!=i&&he(t,["parameters","personGeneration"],i);const s=fe(e,["includeRaiReason"]);void 0!==t&&null!=s&&he(t,["parameters","includeRaiReason"],s);const r=fe(e,["outputMimeType"]);void 0!==t&&null!=r&&he(t,["parameters","outputOptions","mimeType"],r);const l=fe(e,["outputCompressionQuality"]);void 0!==t&&null!=l&&he(t,["parameters","outputOptions","compressionQuality"],l);const a=fe(e,["enhanceInputImage"]);void 0!==t&&null!=a&&he(t,["parameters","upscaleConfig","enhanceInputImage"],a);const u=fe(e,["imagePreservationFactor"]);void 0!==t&&null!=u&&he(t,["parameters","upscaleConfig","imagePreservationFactor"],u);const c=fe(e,["labels"]);void 0!==t&&null!=c&&he(t,["labels"],c);const d=fe(e,["numberOfImages"]);void 0!==t&&null!=d&&he(t,["parameters","sampleCount"],d);const p=fe(e,["mode"]);void 0!==t&&null!=p&&he(t,["parameters","mode"],p)}(r,n),n}(this.apiClient,e);return i=pe("{model}:predict",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),o.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["predictions"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>ui(e))),he(t,["generatedImages"],e)}return t}(e),n=new Rn;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["source"]);null!=i&&function(e,t){const n=fe(e,["prompt"]);void 0!==t&&null!=n&&he(t,["instances[0]","prompt"],n);const o=fe(e,["personImage"]);void 0!==t&&null!=o&&he(t,["instances[0]","personImage","image"],pi(o));const i=fe(e,["productImages"]);if(void 0!==t&&null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["productImage"]);return null!=n&&he(t,["image"],pi(n)),t}(e))),he(t,["instances[0]","productImages"],e)}}(i,n);const s=fe(t,["config"]);return null!=s&&function(e,t){const n=fe(e,["numberOfImages"]);void 0!==t&&null!=n&&he(t,["parameters","sampleCount"],n);const o=fe(e,["baseSteps"]);void 0!==t&&null!=o&&he(t,["parameters","baseSteps"],o);const i=fe(e,["outputGcsUri"]);void 0!==t&&null!=i&&he(t,["parameters","storageUri"],i);const s=fe(e,["seed"]);void 0!==t&&null!=s&&he(t,["parameters","seed"],s);const r=fe(e,["safetyFilterLevel"]);void 0!==t&&null!=r&&he(t,["parameters","safetySetting"],r);const l=fe(e,["personGeneration"]);void 0!==t&&null!=l&&he(t,["parameters","personGeneration"],l);const a=fe(e,["addWatermark"]);void 0!==t&&null!=a&&he(t,["parameters","addWatermark"],a);const u=fe(e,["outputMimeType"]);void 0!==t&&null!=u&&he(t,["parameters","outputOptions","mimeType"],u);const c=fe(e,["outputCompressionQuality"]);void 0!==t&&null!=c&&he(t,["parameters","outputOptions","compressionQuality"],c);const d=fe(e,["enhancePrompt"]);void 0!==t&&null!=d&&he(t,["parameters","enhancePrompt"],d);const p=fe(e,["labels"]);void 0!==t&&null!=p&&he(t,["labels"],p)}(s,n),n}(this.apiClient,e);return i=pe("{model}:predict",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>{const t=function(e){const t={},n=fe(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>ui(e))),he(t,["generatedImages"],e)}return t}(e),n=new xn;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["source"]);null!=i&&function(e,t){const n=fe(e,["prompt"]);void 0!==t&&null!=n&&he(t,["instances[0]","prompt"],n);const o=fe(e,["image"]);void 0!==t&&null!=o&&he(t,["instances[0]","image"],pi(o));const i=fe(e,["scribbleImage"]);void 0!==t&&null!=i&&he(t,["instances[0]","scribble"],function(e){const t={},n=fe(e,["image"]);return null!=n&&he(t,["image"],pi(n)),t}(i))}(i,n);const s=fe(t,["config"]);return null!=s&&function(e,t){const n=fe(e,["mode"]);void 0!==t&&null!=n&&he(t,["parameters","mode"],n);const o=fe(e,["maxPredictions"]);void 0!==t&&null!=o&&he(t,["parameters","maxPredictions"],o);const i=fe(e,["confidenceThreshold"]);void 0!==t&&null!=i&&he(t,["parameters","confidenceThreshold"],i);const s=fe(e,["maskDilation"]);void 0!==t&&null!=s&&he(t,["parameters","maskDilation"],s);const r=fe(e,["binaryColorThreshold"]);void 0!==t&&null!=r&&he(t,["parameters","binaryColorThreshold"],r);const l=fe(e,["labels"]);void 0!==t&&null!=l&&he(t,["labels"],l)}(s,n),n}(this.apiClient,e);return i=pe("{model}:predict",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>{const t=function(e){const t={},n=fe(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["_self"]);null!=n&&he(t,["mask"],ci(n));const o=fe(e,["labels"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["labels"],e)}return t}(e))),he(t,["generatedMasks"],e)}return t}(e),n=new Pn;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=fe(t,["model"]);return null!=o&&he(n,["_url","name"],Zn(e,o)),n}(this.apiClient,e);return r=pe("{name}",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>fi(e))}{const t=function(e,t){const n={},o=fe(t,["model"]);return null!=o&&he(n,["_url","name"],Zn(e,o)),n}(this.apiClient,e);return r=pe("{name}",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>hi(e))}}async listInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=fe(t,["config"]);return null!=o&&function(e,t,n){const o=fe(t,["pageSize"]);void 0!==n&&null!=o&&he(n,["_query","pageSize"],o);const i=fe(t,["pageToken"]);void 0!==n&&null!=i&&he(n,["_query","pageToken"],i);const s=fe(t,["filter"]);void 0!==n&&null!=s&&he(n,["_query","filter"],s);const r=fe(t,["queryBase"]);void 0!==n&&null!=r&&he(n,["_url","models_url"],To(e,r))}(e,o,n),n}(this.apiClient,e);return r=pe("{models_url}",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["nextPageToken"]);null!=o&&he(t,["nextPageToken"],o);const i=fe(e,["_self"]);if(null!=i){let e=So(i);Array.isArray(e)&&(e=e.map(e=>fi(e))),he(t,["models"],e)}return t}(e),n=new Dn;return Object.assign(n,t),n})}{const t=function(e,t){const n={},o=fe(t,["config"]);return null!=o&&function(e,t,n){const o=fe(t,["pageSize"]);void 0!==n&&null!=o&&he(n,["_query","pageSize"],o);const i=fe(t,["pageToken"]);void 0!==n&&null!=i&&he(n,["_query","pageToken"],i);const s=fe(t,["filter"]);void 0!==n&&null!=s&&he(n,["_query","filter"],s);const r=fe(t,["queryBase"]);void 0!==n&&null!=r&&he(n,["_url","models_url"],To(e,r))}(e,o,n),n}(this.apiClient,e);return r=pe("{models_url}",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["nextPageToken"]);null!=o&&he(t,["nextPageToken"],o);const i=fe(e,["_self"]);if(null!=i){let e=So(i);Array.isArray(e)&&(e=e.map(e=>hi(e))),he(t,["models"],e)}return t}(e),n=new Dn;return Object.assign(n,t),n})}}async update(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["config"]);return null!=i&&function(e,t){const n=fe(e,["displayName"]);void 0!==t&&null!=n&&he(t,["displayName"],n);const o=fe(e,["description"]);void 0!==t&&null!=o&&he(t,["description"],o);const i=fe(e,["defaultCheckpointId"]);void 0!==t&&null!=i&&he(t,["defaultCheckpointId"],i)}(i,n),n}(this.apiClient,e);return r=pe("{model}",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>fi(e))}{const t=function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","name"],Zn(e,o));const i=fe(t,["config"]);return null!=i&&function(e,t){const n=fe(e,["displayName"]);void 0!==t&&null!=n&&he(t,["displayName"],n);const o=fe(e,["description"]);void 0!==t&&null!=o&&he(t,["description"],o);const i=fe(e,["defaultCheckpointId"]);void 0!==t&&null!=i&&he(t,["defaultCheckpointId"],i)}(i,n),n}(this.apiClient,e);return r=pe("{name}",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>hi(e))}}async delete(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=fe(t,["model"]);return null!=o&&he(n,["_url","name"],Zn(e,o)),n}(this.apiClient,e);return r=pe("{name}",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);return null!=n&&he(t,["sdkHttpResponse"],n),t}(e),n=new Mn;return Object.assign(n,t),n})}{const t=function(e,t){const n={},o=fe(t,["model"]);return null!=o&&he(n,["_url","name"],Zn(e,o)),n}(this.apiClient,e);return r=pe("{name}",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);return null!=n&&he(t,["sdkHttpResponse"],n),t}(e),n=new Mn;return Object.assign(n,t),n})}}async countTokens(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["contents"]);if(null!=i){let e=ho(i);Array.isArray(e)&&(e=e.map(e=>e)),he(n,["contents"],e)}const s=fe(t,["config"]);return null!=s&&function(e,t){const n=fe(e,["systemInstruction"]);void 0!==t&&null!=n&&he(t,["systemInstruction"],co(n));const o=fe(e,["tools"]);if(void 0!==t&&null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>yi(e))),he(t,["tools"],e)}const i=fe(e,["generationConfig"]);void 0!==t&&null!=i&&he(t,["generationConfig"],function(e){const t={},n=fe(e,["modelSelectionConfig"]);null!=n&&he(t,["modelConfig"],n);const o=fe(e,["responseJsonSchema"]);null!=o&&he(t,["responseJsonSchema"],o);const i=fe(e,["audioTimestamp"]);null!=i&&he(t,["audioTimestamp"],i);const s=fe(e,["candidateCount"]);null!=s&&he(t,["candidateCount"],s);const r=fe(e,["enableAffectiveDialog"]);null!=r&&he(t,["enableAffectiveDialog"],r);const l=fe(e,["frequencyPenalty"]);null!=l&&he(t,["frequencyPenalty"],l);const a=fe(e,["logprobs"]);null!=a&&he(t,["logprobs"],a);const u=fe(e,["maxOutputTokens"]);null!=u&&he(t,["maxOutputTokens"],u);const c=fe(e,["mediaResolution"]);null!=c&&he(t,["mediaResolution"],c);const d=fe(e,["presencePenalty"]);null!=d&&he(t,["presencePenalty"],d);const p=fe(e,["responseLogprobs"]);null!=p&&he(t,["responseLogprobs"],p);const h=fe(e,["responseMimeType"]);null!=h&&he(t,["responseMimeType"],h);const f=fe(e,["responseModalities"]);null!=f&&he(t,["responseModalities"],f);const m=fe(e,["responseSchema"]);null!=m&&he(t,["responseSchema"],m);const g=fe(e,["routingConfig"]);null!=g&&he(t,["routingConfig"],g);const y=fe(e,["seed"]);null!=y&&he(t,["seed"],y);const v=fe(e,["speechConfig"]);null!=v&&he(t,["speechConfig"],v);const E=fe(e,["stopSequences"]);null!=E&&he(t,["stopSequences"],E);const _=fe(e,["temperature"]);null!=_&&he(t,["temperature"],_);const I=fe(e,["thinkingConfig"]);null!=I&&he(t,["thinkingConfig"],I);const b=fe(e,["topK"]);null!=b&&he(t,["topK"],b);const A=fe(e,["topP"]);if(null!=A&&he(t,["topP"],A),void 0!==fe(e,["enableEnhancedCivicAnswers"]))throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(i))}(s,n),n}(this.apiClient,e);return r=pe("{model}:countTokens",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["totalTokens"]);return null!=o&&he(t,["totalTokens"],o),t}(e),n=new Un;return Object.assign(n,t),n})}{const t=function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["contents"]);if(null!=i){let e=ho(i);Array.isArray(e)&&(e=e.map(e=>ni(e))),he(n,["contents"],e)}const s=fe(t,["config"]);return null!=s&&function(e){if(void 0!==fe(e,["systemInstruction"]))throw new Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==fe(e,["tools"]))throw new Error("tools parameter is not supported in Gemini API.");if(void 0!==fe(e,["generationConfig"]))throw new Error("generationConfig parameter is not supported in Gemini API.")}(s),n}(this.apiClient,e);return r=pe("{model}:countTokens",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["totalTokens"]);null!=o&&he(t,["totalTokens"],o);const i=fe(e,["cachedContentTokenCount"]);return null!=i&&he(t,["cachedContentTokenCount"],i),t}(e),n=new Un;return Object.assign(n,t),n})}}async computeTokens(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["_url","model"],Zn(e,o));const i=fe(t,["contents"]);if(null!=i){let e=ho(i);Array.isArray(e)&&(e=e.map(e=>e)),he(n,["contents"],e)}return n}(this.apiClient,e);return i=pe("{model}:computeTokens",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),o.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["tokensInfo"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["tokensInfo"],e)}return t}(e),n=new jn;return Object.assign(n,t),n})}throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=ai(this.apiClient,e);return r=pe("{model}:predictLongRunning",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=fe(e,["name"]);null!=n&&he(t,["name"],n);const o=fe(e,["metadata"]);null!=o&&he(t,["metadata"],o);const i=fe(e,["done"]);null!=i&&he(t,["done"],i);const s=fe(e,["error"]);null!=s&&he(t,["error"],s);const r=fe(e,["response"]);return null!=r&&he(t,["response"],function(e){const t={},n=fe(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["_self"]);return null!=n&&he(t,["video"],function(e){const t={},n=fe(e,["gcsUri"]);null!=n&&he(t,["uri"],n);const o=fe(e,["bytesBase64Encoded"]);null!=o&&he(t,["videoBytes"],bo(o));const i=fe(e,["mimeType"]);return null!=i&&he(t,["mimeType"],i),t}(n)),t}(e))),he(t,["generatedVideos"],e)}const o=fe(e,["raiMediaFilteredCount"]);null!=o&&he(t,["raiMediaFilteredCount"],o);const i=fe(e,["raiMediaFilteredReasons"]);return null!=i&&he(t,["raiMediaFilteredReasons"],i),t}(r)),t}(e),n=new kn;return Object.assign(n,t),n})}{const t=li(this.apiClient,e);return r=pe("{model}:predictLongRunning",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s.then(e=>{const t=function(e){const t={},n=fe(e,["name"]);null!=n&&he(t,["name"],n);const o=fe(e,["metadata"]);null!=o&&he(t,["metadata"],o);const i=fe(e,["done"]);null!=i&&he(t,["done"],i);const s=fe(e,["error"]);null!=s&&he(t,["error"],s);const r=fe(e,["response","generateVideoResponse"]);return null!=r&&he(t,["response"],function(e){const t={},n=fe(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["video"]);return null!=n&&he(t,["video"],function(e){const t={},n=fe(e,["uri"]);null!=n&&he(t,["uri"],n);const o=fe(e,["encodedVideo"]);null!=o&&he(t,["videoBytes"],bo(o));const i=fe(e,["encoding"]);return null!=i&&he(t,["mimeType"],i),t}(n)),t}(e))),he(t,["generatedVideos"],e)}const o=fe(e,["raiMediaFilteredCount"]);null!=o&&he(t,["raiMediaFilteredCount"],o);const i=fe(e,["raiMediaFilteredReasons"]);return null!=i&&he(t,["raiMediaFilteredReasons"],i),t}(r)),t}(e),n=new kn;return Object.assign(n,t),n})}}}class Li extends de{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const e=t.name.split("/operations/")[0];let o;n&&"httpOptions"in n&&(o=n.httpOptions);const i=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:e,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!0})}{const e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async get(e){const t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const e=t.name.split("/operations/")[0];let o;n&&"httpOptions"in n&&(o=n.httpOptions);const i=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:e,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!0})}{const e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e){const t={},n=fe(e,["operationName"]);return null!=n&&he(t,["_url","operationName"],n),t}(e);return r=pe("{operationName}",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),s}{const t=function(e){const t={},n=fe(e,["operationName"]);return null!=n&&he(t,["_url","operationName"],n),t}(e);return r=pe("{operationName}",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()),s}}async fetchPredictVideosOperationInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(e){const t={},n=fe(e,["operationName"]);null!=n&&he(t,["operationName"],n);const o=fe(e,["resourceName"]);return null!=o&&he(t,["_url","resourceName"],o),t}(e);return i=pe("{resourceName}:fetchPredictOperation",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o}throw new Error("This method is only supported by the Vertex AI.")}}function Gi(e,t,n){const o=fe(t,["expireTime"]);void 0!==n&&null!=o&&he(n,["expireTime"],o);const i=fe(t,["newSessionExpireTime"]);void 0!==n&&null!=i&&he(n,["newSessionExpireTime"],i);const s=fe(t,["uses"]);void 0!==n&&null!=s&&he(n,["uses"],s);const r=fe(t,["liveConnectConstraints"]);void 0!==n&&null!=r&&he(n,["bidiGenerateContentSetup"],function(e,t){const n={},o=fe(t,["model"]);null!=o&&he(n,["setup","model"],Zn(e,o));const i=fe(t,["config"]);return null!=i&&he(n,["config"],function(e,t){const n=fe(e,["generationConfig"]);void 0!==t&&null!=n&&he(t,["setup","generationConfig"],n);const o=fe(e,["responseModalities"]);void 0!==t&&null!=o&&he(t,["setup","generationConfig","responseModalities"],o);const i=fe(e,["temperature"]);void 0!==t&&null!=i&&he(t,["setup","generationConfig","temperature"],i);const s=fe(e,["topP"]);void 0!==t&&null!=s&&he(t,["setup","generationConfig","topP"],s);const r=fe(e,["topK"]);void 0!==t&&null!=r&&he(t,["setup","generationConfig","topK"],r);const l=fe(e,["maxOutputTokens"]);void 0!==t&&null!=l&&he(t,["setup","generationConfig","maxOutputTokens"],l);const a=fe(e,["mediaResolution"]);void 0!==t&&null!=a&&he(t,["setup","generationConfig","mediaResolution"],a);const u=fe(e,["seed"]);void 0!==t&&null!=u&&he(t,["setup","generationConfig","seed"],u);const c=fe(e,["speechConfig"]);void 0!==t&&null!=c&&he(t,["setup","generationConfig","speechConfig"],yo(c));const d=fe(e,["thinkingConfig"]);void 0!==t&&null!=d&&he(t,["setup","generationConfig","thinkingConfig"],d);const p=fe(e,["enableAffectiveDialog"]);void 0!==t&&null!=p&&he(t,["setup","generationConfig","enableAffectiveDialog"],p);const h=fe(e,["systemInstruction"]);void 0!==t&&null!=h&&he(t,["setup","systemInstruction"],function(e){const t={},n=fe(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["mediaResolution"]);null!=n&&he(t,["mediaResolution"],n);const o=fe(e,["codeExecutionResult"]);null!=o&&he(t,["codeExecutionResult"],o);const i=fe(e,["executableCode"]);null!=i&&he(t,["executableCode"],i);const s=fe(e,["fileData"]);null!=s&&he(t,["fileData"],function(e){const t={};if(void 0!==fe(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const n=fe(e,["fileUri"]);null!=n&&he(t,["fileUri"],n);const o=fe(e,["mimeType"]);return null!=o&&he(t,["mimeType"],o),t}(s));const r=fe(e,["functionCall"]);null!=r&&he(t,["functionCall"],function(e){const t={},n=fe(e,["id"]);null!=n&&he(t,["id"],n);const o=fe(e,["args"]);null!=o&&he(t,["args"],o);const i=fe(e,["name"]);if(null!=i&&he(t,["name"],i),void 0!==fe(e,["partialArgs"]))throw new Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==fe(e,["willContinue"]))throw new Error("willContinue parameter is not supported in Gemini API.");return t}(r));const l=fe(e,["functionResponse"]);null!=l&&he(t,["functionResponse"],l);const a=fe(e,["inlineData"]);null!=a&&he(t,["inlineData"],function(e){const t={},n=fe(e,["data"]);if(null!=n&&he(t,["data"],n),void 0!==fe(e,["displayName"]))throw new Error("displayName parameter is not supported in Gemini API.");const o=fe(e,["mimeType"]);return null!=o&&he(t,["mimeType"],o),t}(a));const u=fe(e,["text"]);null!=u&&he(t,["text"],u);const c=fe(e,["thought"]);null!=c&&he(t,["thought"],c);const d=fe(e,["thoughtSignature"]);null!=d&&he(t,["thoughtSignature"],d);const p=fe(e,["videoMetadata"]);return null!=p&&he(t,["videoMetadata"],p),t}(e))),he(t,["parts"],e)}const o=fe(e,["role"]);return null!=o&&he(t,["role"],o),t}(co(h)));const f=fe(e,["tools"]);if(void 0!==t&&null!=f){let e=Eo(f);Array.isArray(e)&&(e=e.map(e=>function(e){const t={},n=fe(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["functionDeclarations"],e)}if(void 0!==fe(e,["retrieval"]))throw new Error("retrieval parameter is not supported in Gemini API.");const o=fe(e,["googleSearchRetrieval"]);null!=o&&he(t,["googleSearchRetrieval"],o);const i=fe(e,["computerUse"]);null!=i&&he(t,["computerUse"],i);const s=fe(e,["fileSearch"]);null!=s&&he(t,["fileSearch"],s);const r=fe(e,["codeExecution"]);if(null!=r&&he(t,["codeExecution"],r),void 0!==fe(e,["enterpriseWebSearch"]))throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=fe(e,["googleMaps"]);null!=l&&he(t,["googleMaps"],function(e){const t={};if(void 0!==fe(e,["authConfig"]))throw new Error("authConfig parameter is not supported in Gemini API.");const n=fe(e,["enableWidget"]);return null!=n&&he(t,["enableWidget"],n),t}(l));const a=fe(e,["googleSearch"]);null!=a&&he(t,["googleSearch"],function(e){const t={};if(void 0!==fe(e,["excludeDomains"]))throw new Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==fe(e,["blockingConfidence"]))throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=fe(e,["timeRangeFilter"]);return null!=n&&he(t,["timeRangeFilter"],n),t}(a));const u=fe(e,["urlContext"]);return null!=u&&he(t,["urlContext"],u),t}(vo(e)))),he(t,["setup","tools"],e)}const m=fe(e,["sessionResumption"]);void 0!==t&&null!=m&&he(t,["setup","sessionResumption"],function(e){const t={},n=fe(e,["handle"]);if(null!=n&&he(t,["handle"],n),void 0!==fe(e,["transparent"]))throw new Error("transparent parameter is not supported in Gemini API.");return t}(m));const g=fe(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&he(t,["setup","inputAudioTranscription"],g);const y=fe(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&he(t,["setup","outputAudioTranscription"],y);const v=fe(e,["realtimeInputConfig"]);void 0!==t&&null!=v&&he(t,["setup","realtimeInputConfig"],v);const E=fe(e,["contextWindowCompression"]);void 0!==t&&null!=E&&he(t,["setup","contextWindowCompression"],E);const _=fe(e,["proactivity"]);if(void 0!==t&&null!=_&&he(t,["setup","proactivity"],_),void 0!==fe(e,["explicitVadSignal"]))throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return{}}(i,n)),n}(e,r));const l=fe(t,["lockAdditionalFields"]);return void 0!==n&&null!=l&&he(n,["fieldMask"],l),{}}class Hi extends de{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const r=function(e,t){const n={},o=fe(t,["config"]);return null!=o&&he(n,["config"],Gi(e,o,n)),n}(this.apiClient,e);i=pe("auth_tokens",r._url),s=r._query,delete r.config,delete r._url,delete r._query;const l=function(e,t){let n=null;const o=e.bidiGenerateContentSetup;if("object"==typeof o&&null!==o&&"setup"in o){const t=o.setup;"object"==typeof t&&null!==t?(e.bidiGenerateContentSetup=t,n=t):delete e.bidiGenerateContentSetup}else void 0!==o&&delete e.bidiGenerateContentSetup;const i=e.fieldMask;if(n){const o=function(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const o=e[n];if("object"==typeof o&&null!=o&&Object.keys(o).length>0){const e=Object.keys(o).map(e=>`${n}.${e}`);t.push(...e)}else t.push(n)}return t.join(",")}(n);if(Array.isArray(null==t?void 0:t.lockAdditionalFields)&&0===(null==t?void 0:t.lockAdditionalFields.length))o?e.fieldMask=o:delete e.fieldMask;else if((null==t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==i&&Array.isArray(i)&&i.length>0){const t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let n=[];i.length>0&&(n=i.map(e=>t.includes(e)?`generationConfig.${e}`:e));const s=[];o&&s.push(o),n.length>0&&s.push(...n),s.length>0?e.fieldMask=s.join(","):delete e.fieldMask}else delete e.fieldMask}else null!==i&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}(r,e.config);return o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>e)}}}class Fi extends de{constructor(e){super(),this.apiClient=e,this.list=async e=>new ko(An.PAGED_ITEM_DOCUMENTS,t=>this.listInternal({parent:e.parent,config:t.config}),await this.listInternal(e),e)}async get(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=fe(e,["name"]);return null!=n&&he(t,["_url","name"],n),t}(e);return i=pe("{name}",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>e)}}async delete(e){var t,n;let o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const s=function(e){const t={},n=fe(e,["name"]);null!=n&&he(t,["_url","name"],n);const o=fe(e,["config"]);return null!=o&&function(e,t){const n=fe(e,["force"]);void 0!==t&&null!=n&&he(t,["_query","force"],n)}(o,t),t}(e);o=pe("{name}",s._url),i=s._query,delete s._url,delete s._query,await this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}}async listInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=fe(e,["parent"]);null!=n&&he(t,["_url","parent"],n);const o=fe(e,["config"]);return null!=o&&function(e,t){const n=fe(e,["pageSize"]);void 0!==t&&null!=n&&he(t,["_query","pageSize"],n);const o=fe(e,["pageToken"]);void 0!==t&&null!=o&&he(t,["_query","pageToken"],o)}(o,t),t}(e);return i=pe("{parent}/documents",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["nextPageToken"]);null!=o&&he(t,["nextPageToken"],o);const i=fe(e,["documents"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["documents"],e)}return t}(e),n=new Fn;return Object.assign(n,t),n})}}}class Vi extends de{constructor(e,t=new Fi(e)){super(),this.apiClient=e,this.documents=t,this.list=async(e={})=>new ko(An.PAGED_ITEM_FILE_SEARCH_STORES,e=>this.listInternal(e),await this.listInternal(e),e)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=fe(e,["config"]);return null!=n&&function(e,t){const n=fe(e,["displayName"]);void 0!==t&&null!=n&&he(t,["displayName"],n)}(n,t),t}(e);return i=pe("fileSearchStores",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>e)}}async get(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=fe(e,["name"]);return null!=n&&he(t,["_url","name"],n),t}(e);return i=pe("{name}",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>e)}}async delete(e){var t,n;let o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const s=function(e){const t={},n=fe(e,["name"]);null!=n&&he(t,["_url","name"],n);const o=fe(e,["config"]);return null!=o&&function(e,t){const n=fe(e,["force"]);void 0!==t&&null!=n&&he(t,["_query","force"],n)}(o,t),t}(e);o=pe("{name}",s._url),i=s._query,delete s._url,delete s._query,await this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal})}}async listInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=fe(e,["config"]);return null!=n&&function(e,t){const n=fe(e,["pageSize"]);void 0!==t&&null!=n&&he(t,["_query","pageSize"],n);const o=fe(e,["pageToken"]);void 0!==t&&null!=o&&he(t,["_query","pageToken"],o)}(n,t),t}(e);return i=pe("fileSearchStores",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["nextPageToken"]);null!=o&&he(t,["nextPageToken"],o);const i=fe(e,["fileSearchStores"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["fileSearchStores"],e)}return t}(e),n=new Vn;return Object.assign(n,t),n})}}async uploadToFileSearchStoreInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=fe(e,["fileSearchStoreName"]);null!=n&&he(t,["_url","file_search_store_name"],n);const o=fe(e,["config"]);return null!=o&&_i(o,t),t}(e);return i=pe("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);return null!=n&&he(t,["sdkHttpResponse"],n),t}(e),n=new Bn;return Object.assign(n,t),n})}}async importFile(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=fe(e,["fileSearchStoreName"]);null!=n&&he(t,["_url","file_search_store_name"],n);const o=fe(e,["fileName"]);null!=o&&he(t,["fileName"],o);const i=fe(e,["config"]);return null!=i&&function(e,t){const n=fe(e,["customMetadata"]);if(void 0!==t&&null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["customMetadata"],e)}const o=fe(e,["chunkingConfig"]);void 0!==t&&null!=o&&he(t,["chunkingConfig"],o)}(i,t),t}(e);return i=pe("{file_search_store_name}:importFile",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()),o.then(e=>{const t=function(e){const t={},n=fe(e,["name"]);null!=n&&he(t,["name"],n);const o=fe(e,["metadata"]);null!=o&&he(t,["metadata"],o);const i=fe(e,["done"]);null!=i&&he(t,["done"],i);const s=fe(e,["error"]);null!=s&&he(t,["error"],s);const r=fe(e,["response"]);return null!=r&&he(t,["response"],function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["parent"]);null!=o&&he(t,["parent"],o);const i=fe(e,["documentName"]);return null!=i&&he(t,["documentName"],i),t}(r)),t}(e),n=new Jn;return Object.assign(n,t),n})}}}let Bi=function(){const{crypto:e}=globalThis;if(null==e?void 0:e.randomUUID)return Bi=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(+e^n()&15>>+e/4).toString(16))};function Ji(e){return"object"==typeof e&&null!==e&&("name"in e&&"AbortError"===e.name||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const Yi=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e){try{if("[object Error]"===Object.prototype.toString.call(e)){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch(t){}try{return new Error(JSON.stringify(e))}catch(n){}}return new Error(e)};class $i extends Error{}class Wi extends $i{constructor(e,t,n,o){super(`${Wi.makeMessage(e,t,n)}`),this.status=e,this.headers=o,this.error=t}static makeMessage(e,t,n){const o=(null==t?void 0:t.message)?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&o?`${e} ${o}`:e?`${e} status code (no body)`:o||"(no status code or body)"}static generate(e,t,n,o){if(!e||!o)return new zi({message:n,cause:Yi(t)});const i=t;return 400===e?new Qi(e,i,n,o):401===e?new Zi(e,i,n,o):403===e?new es(e,i,n,o):404===e?new ts(e,i,n,o):409===e?new ns(e,i,n,o):422===e?new os(e,i,n,o):429===e?new is(e,i,n,o):e>=500?new ss(e,i,n,o):new Wi(e,i,n,o)}}class Ki extends Wi{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class zi extends Wi{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Xi extends zi{constructor({message:e}={}){super({message:null!=e?e:"Request timed out."})}}class Qi extends Wi{}class Zi extends Wi{}class es extends Wi{}class ts extends Wi{}class ns extends Wi{}class os extends Wi{}class is extends Wi{}class ss extends Wi{}const rs=/^[a-z][a-z0-9+.-]*:/i;let ls=e=>(ls=Array.isArray,ls(e));const as=ls,us="0.0.1",cs=()=>{var e,t,n,o,i;const s="undefined"!=typeof Deno&&null!=Deno.build?"deno":"undefined"!=typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===s)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":us,"X-Stainless-OS":ps(Deno.build.os),"X-Stainless-Arch":ds(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:null!==(t=null===(e=Deno.version)||void 0===e?void 0:e.deno)&&void 0!==t?t:"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":us,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===s)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":us,"X-Stainless-OS":ps(null!==(n=globalThis.process.platform)&&void 0!==n?n:"unknown"),"X-Stainless-Arch":ds(null!==(o=globalThis.process.arch)&&void 0!==o?o:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":null!==(i=globalThis.process.version)&&void 0!==i?i:"unknown"};const r=function(){if("undefined"==typeof navigator||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const e=n.exec(navigator.userAgent);if(e)return{browser:t,version:`${e[1]||0}.${e[2]||0}.${e[3]||0}`}}return null}();return r?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":us,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${r.browser}`,"X-Stainless-Runtime-Version":r.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":us,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}},ds=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",ps=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown";let hs;function fs(...e){const t=globalThis.ReadableStream;if(void 0===t)throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function ms(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return fs({start(){},async pull(e){const{done:n,value:o}=await t.next();n?e.close():e.enqueue(o)},async cancel(){var e;await(null===(e=t.return)||void 0===e?void 0:e.call(t))}})}function gs(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();return(null==e?void 0:e.done)&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const ys=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)}),vs=()=>{var e;if("undefined"==typeof File){const{process:t}=globalThis,n="string"==typeof(null===(e=null==t?void 0:t.versions)||void 0===e?void 0:e.node)&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Es(e,t,n){return vs(),new File(e,null!=t?t:"unknown_file",n)}const _s=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer;async function Is(e){var t,n,o,i,s;let r=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)r.push(e);else if(_s(e))r.push(e instanceof Blob?e:await e.arrayBuffer());else{if(!(e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator])(e)){const t=null===(s=null==e?void 0:e.constructor)||void 0===s?void 0:s.name;throw new Error(`Unexpected data type: ${typeof e}${t?`; constructor: ${t}`:""}${function(e){if("object"!=typeof e||null===e)return"";return`; props: [${Object.getOwnPropertyNames(e).map(e=>`"${e}"`).join(", ")}]`}(e)}`)}try{for(var l,a=!0,u=Bo(e);!(t=(l=await u.next()).done);a=!0){i=l.value,a=!1;const e=i;r.push(...await Is(e))}}catch(c){n={error:c}}finally{try{a||t||!(o=u.return)||await o.call(u)}finally{if(n)throw n.error}}}return r}class bs{constructor(e){this._client=e}}function As(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}bs._key=[];const Ts=Object.freeze(Object.create(null)),Ss=((e=As)=>function(t,...n){if(1===t.length)return t[0];let o=!1;const i=[],s=t.reduce((t,s,r)=>{var l,a,u;/[?#]/.test(s)&&(o=!0);const c=n[r];let d=(o?encodeURIComponent:e)(""+c);return r!==n.length&&(null==c||"object"==typeof c&&c.toString===(null===(u=Object.getPrototypeOf(null!==(a=Object.getPrototypeOf(null!==(l=c.hasOwnProperty)&&void 0!==l?l:Ts))&&void 0!==a?a:Ts))||void 0===u?void 0:u.toString))&&(d=c+"",i.push({start:t.length+s.length,length:d.length,error:`Value of type ${Object.prototype.toString.call(c).slice(8,-1)} is not a valid path parameter`})),t+s+(r===n.length?"":d)},""),r=s.split(/[?#]/,1)[0],l=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let a;for(;null!==(a=l.exec(r));)i.push({start:a.index,length:a[0].length,error:`Value "${a[0]}" can't be safely passed as a path parameter`});if(i.sort((e,t)=>e.start-t.start),i.length>0){let e=0;const t=i.reduce((t,n)=>{const o=" ".repeat(n.start-e),i="^".repeat(n.length);return e=n.start+n.length,t+o+i},"");throw new $i(`Path parameters result in path with invalid segments:\n${i.map(e=>e.error).join("\n")}\n${s}\n${t}`)}return s})(As);class Os extends bs{create(e,t){var n;const{api_version:o=this._client.apiVersion}=e,i=Ho(e,["api_version"]);if("model"in i&&"agent_config"in i)throw new $i("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in i&&"generation_config"in i)throw new $i("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Ss`/${o}/interactions`,Object.assign(Object.assign({body:i},t),{stream:null!==(n=e.stream)&&void 0!==n&&n}))}delete(e,t={},n){const{api_version:o=this._client.apiVersion}=null!=t?t:{};return this._client.delete(Ss`/${o}/interactions/${e}`,n)}cancel(e,t={},n){const{api_version:o=this._client.apiVersion}=null!=t?t:{};return this._client.post(Ss`/${o}/interactions/${e}/cancel`,n)}get(e,t={},n){var o;const i=null!=t?t:{},{api_version:s=this._client.apiVersion}=i,r=Ho(i,["api_version"]);return this._client.get(Ss`/${s}/interactions/${e}`,Object.assign(Object.assign({query:r},n),{stream:null!==(o=null==t?void 0:t.stream)&&void 0!==o&&o}))}}Os._key=Object.freeze(["interactions"]);class Cs extends Os{}let ws,Ns;function Rs(e){let t;return(null!=ws?ws:(t=new globalThis.TextEncoder,ws=t.encode.bind(t)))(e)}function xs(e){let t;return(null!=Ns?Ns:(t=new globalThis.TextDecoder,Ns=t.decode.bind(t)))(e)}class Ps{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(null==e)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?Rs(e):e;this.buffer=function(e){let t=0;for(const i of e)t+=i.length;const n=new Uint8Array(t);let o=0;for(const i of e)n.set(i,o),o+=i.length;return n}([this.buffer,t]);const n=[];let o;for(;null!=(o=Ds(this.buffer,this.carriageReturnIndex));){if(o.carriage&&null==this.carriageReturnIndex){this.carriageReturnIndex=o.index;continue}if(null!=this.carriageReturnIndex&&(o.index!==this.carriageReturnIndex+1||o.carriage)){n.push(xs(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const e=null!==this.carriageReturnIndex?o.preceding-1:o.preceding,t=xs(this.buffer.subarray(0,e));n.push(t),this.buffer=this.buffer.subarray(o.index),this.carriageReturnIndex=null}return n}flush(){return this.buffer.length?this.decode("\n"):[]}}function Ds(e,t){for(let n=null!=t?t:0;n<e.length;n++){if(10===e[n])return{preceding:n,index:n+1,carriage:!1};if(13===e[n])return{preceding:n,index:n+1,carriage:!0}}return null}function Ms(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1])return t+2;if(13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return-1}Ps.NEWLINE_CHARS=new Set(["\n","\r"]),Ps.NEWLINE_REGEXP=/\r\n|[\n\r]/g;const Us={off:0,error:200,warn:300,info:400,debug:500},js=(e,t,n)=>{var o,i;if(e)return o=Us,i=e,Object.prototype.hasOwnProperty.call(o,i)?e:void Hs(n).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(Us))}`)};function ks(){}function qs(e,t,n){return!t||Us[e]>Us[n]?ks:t[e].bind(t)}const Ls={error:ks,warn:ks,info:ks,debug:ks};let Gs=new WeakMap;function Hs(e){var t;const n=e.logger,o=null!==(t=e.logLevel)&&void 0!==t?t:"off";if(!n)return Ls;const i=Gs.get(n);if(i&&i[0]===o)return i[1];const s={error:qs("error",n,o),warn:qs("warn",n,o),info:qs("info",n,o),debug:qs("debug",n,o)};return Gs.set(n,[o,s]),s}const Fs=e=>(e.options&&(e.options=Object.assign({},e.options),delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([e,t])=>[e,"x-goog-api-key"===e.toLowerCase()||"authorization"===e.toLowerCase()||"cookie"===e.toLowerCase()||"set-cookie"===e.toLowerCase()?"***":t]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);class Vs{constructor(e,t,n){this.iterator=e,this.controller=t,this.client=n}static fromSSEResponse(e,t,n){let o=!1;const i=n?Hs(n):console;return new Vs(function(){return Vo(this,arguments,function*(){var n,s,r,l;if(o)throw new $i("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let a=!1;try{try{for(var u,c=!0,d=Bo(function(e,t){return Vo(this,arguments,function*(){var n,o,i,s;if(!e.body){if(t.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new $i("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new $i("Attempted to iterate over a response with no body")}const r=new Bs,l=new Ps,a=gs(e.body);try{for(var u,c=!0,d=Bo(function(e){return Vo(this,arguments,function*(){var t,n,o,i;let s=new Uint8Array;try{for(var r,l=!0,a=Bo(e);!(t=(r=yield Fo(a.next())).done);l=!0){i=r.value,l=!1;const e=i;if(null==e)continue;const t=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?Rs(e):e;let n,o=new Uint8Array(s.length+t.length);for(o.set(s),o.set(t,s.length),s=o;-1!==(n=Ms(s));)yield yield Fo(s.slice(0,n)),s=s.slice(n)}}catch(u){n={error:u}}finally{try{l||t||!(o=a.return)||(yield Fo(o.call(a)))}finally{if(n)throw n.error}}s.length>0&&(yield yield Fo(s))})}(a));!(n=(u=yield Fo(d.next())).done);c=!0){s=u.value,c=!1;const e=s;for(const t of l.decode(e)){const e=r.decode(t);e&&(yield yield Fo(e))}}}catch(p){o={error:p}}finally{try{c||n||!(i=d.return)||(yield Fo(i.call(d)))}finally{if(o)throw o.error}}for(const e of l.flush()){const t=r.decode(e);t&&(yield yield Fo(t))}})}(e,t));!(n=(u=yield Fo(d.next())).done);c=!0){l=u.value,c=!1;const e=l;if(!a)if(e.data.startsWith("[DONE]"))a=!0;else try{yield yield Fo(JSON.parse(e.data))}catch(p){throw i.error("Could not parse message into JSON:",e.data),i.error("From chunk:",e.raw),p}}}catch(h){s={error:h}}finally{try{c||n||!(r=d.return)||(yield Fo(r.call(d)))}finally{if(s)throw s.error}}a=!0}catch(p){if(Ji(p))return yield Fo(void 0);throw p}finally{a||t.abort()}})},t,n)}static fromReadableStream(e,t,n){let o=!1;return new Vs(function(){return Vo(this,arguments,function*(){var n,i,s,r;if(o)throw new $i("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let l=!1;try{try{for(var a,u=!0,c=Bo(function(){return Vo(this,arguments,function*(){var t,n,o,i;const s=new Ps,r=gs(e);try{for(var l,a=!0,u=Bo(r);!(t=(l=yield Fo(u.next())).done);a=!0){i=l.value,a=!1;const e=i;for(const t of s.decode(e))yield yield Fo(t)}}catch(c){n={error:c}}finally{try{a||t||!(o=u.return)||(yield Fo(o.call(u)))}finally{if(n)throw n.error}}for(const e of s.flush())yield yield Fo(e)})}());!(n=(a=yield Fo(c.next())).done);u=!0){r=a.value,u=!1;const e=r;l||e&&(yield yield Fo(JSON.parse(e)))}}catch(d){i={error:d}}finally{try{u||n||!(s=c.return)||(yield Fo(s.call(c)))}finally{if(i)throw i.error}}l=!0}catch(p){if(Ji(p))return yield Fo(void 0);throw p}finally{l||t.abort()}})},t,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),o=o=>({next:()=>{if(0===o.length){const o=n.next();e.push(o),t.push(o)}return o.shift()}});return[new Vs(()=>o(e),this.controller,this.client),new Vs(()=>o(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return fs({async start(){t=e[Symbol.asyncIterator]()},async pull(e){try{const{value:n,done:o}=await t.next();if(o)return e.close();const i=Rs(JSON.stringify(n)+"\n");e.enqueue(i)}catch(n){e.error(n)}},async cancel(){var e;await(null===(e=t.return)||void 0===e?void 0:e.call(t))}})}}class Bs{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,o]=function(e){const t=e.indexOf(":");return-1!==t?[e.substring(0,t),":",e.substring(t+1)]:[e,"",""]}(e);return o.startsWith(" ")&&(o=o.substring(1)),"event"===t?this.event=o:"data"===t&&this.data.push(o),null}}async function Js(e,t){const{response:n,requestLogID:o,retryOfRequestLogID:i,startTime:s}=t,r=await(async()=>{var o;if(t.options.stream)return Hs(e).debug("response",n.status,n.url,n.headers,n.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(n,t.controller,e):Vs.fromSSEResponse(n,t.controller,e);if(204===n.status)return null;if(t.options.__binaryResponse)return n;const i=n.headers.get("content-type"),s=null===(o=null==i?void 0:i.split(";")[0])||void 0===o?void 0:o.trim();return(null==s?void 0:s.includes("application/json"))||(null==s?void 0:s.endsWith("+json"))?await n.json():await n.text()})();return Hs(e).debug(`[${o}] response parsed`,Fs({retryOfRequestLogID:i,url:n.url,status:n.status,body:r,durationMs:Date.now()-s})),r}class Ys extends Promise{constructor(e,t,n=Js){super(e=>{e(null)}),this.responsePromise=t,this.parseResponse=n,this.client=e}_thenUnwrap(e){return new Ys(this.client,this.responsePromise,async(t,n)=>e(await this.parseResponse(t,n),n))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}const $s=Symbol("brand.privateNullableHeaders");function*Ws(e){if(!e)return;if($s in e){const{values:t,nulls:n}=e;yield*t.entries();for(const e of n)yield[e,null];return}let t,n=!1;e instanceof Headers?t=e.entries():as(e)?t=e:(n=!0,t=Object.entries(null!=e?e:{}));for(let o of t){const e=o[0];if("string"!=typeof e)throw new TypeError("expected header name to be a string");const t=as(o[1])?o[1]:[o[1]];let i=!1;for(const o of t)void 0!==o&&(n&&!i&&(i=!0,yield[e,null]),yield[e,o])}}const Ks=e=>{const t=new Headers,n=new Set;for(const o of e){const e=new Set;for(const[i,s]of Ws(o)){const o=i.toLowerCase();e.has(o)||(t.delete(i),e.add(o)),null===s?(t.delete(i),n.add(o)):(t.append(i,s),n.delete(o))}}return{[$s]:!0,values:t,nulls:n}},zs=e=>{var t,n,o,i,s,r;return void 0!==globalThis.process?null!==(o=null===(n=null===(t=ce)||void 0===t?void 0:t[e])||void 0===n?void 0:n.trim())&&void 0!==o?o:void 0:void 0!==globalThis.Deno?null===(r=null===(s=null===(i=globalThis.Deno.env)||void 0===i?void 0:i.get)||void 0===s?void 0:s.call(i,e))||void 0===r?void 0:r.trim():void 0};var Xs;class Qs{constructor(e){var t,n,o,i,s,r,l,{baseURL:a=zs("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:u=(null!==(t=zs("GEMINI_API_KEY"))&&void 0!==t?t:null),apiVersion:c="v1beta"}=e,d=Ho(e,["baseURL","apiKey","apiVersion"]);const p=Object.assign(Object.assign({apiKey:u,apiVersion:c},d),{baseURL:a||"https://generativelanguage.googleapis.com"});this.baseURL=p.baseURL,this.timeout=null!==(n=p.timeout)&&void 0!==n?n:Qs.DEFAULT_TIMEOUT,this.logger=null!==(o=p.logger)&&void 0!==o?o:console;const h="warn";this.logLevel=h,this.logLevel=null!==(s=null!==(i=js(p.logLevel,"ClientOptions.logLevel",this))&&void 0!==i?i:js(zs("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))&&void 0!==s?s:h,this.fetchOptions=p.fetchOptions,this.maxRetries=null!==(r=p.maxRetries)&&void 0!==r?r:2,this.fetch=null!==(l=p.fetch)&&void 0!==l?l:function(){if("undefined"!=typeof fetch)return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),this.encoder=ys,this._options=p,this.apiKey=u,this.apiVersion=c,this.clientAdapter=p.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return"https://generativelanguage.googleapis.com"!==this.baseURL}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!e.has("authorization")&&!e.has("x-goog-api-key")&&!(this.apiKey&&e.get("x-goog-api-key")||t.has("x-goog-api-key")))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=Ks([e.headers]);if(!t.values.has("authorization")&&!t.values.has("x-goog-api-key"))return this.apiKey?Ks([{"x-goog-api-key":this.apiKey}]):this.clientAdapter.isVertexAI()?Ks([await this.clientAdapter.getAuthHeaders()]):void 0}stringifyQuery(e){return Object.entries(e).filter(([e,t])=>void 0!==t).map(([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new $i(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${us}`}defaultIdempotencyKey(){return`stainless-node-retry-${Bi()}`}makeStatusError(e,t,n,o){return Wi.generate(e,t,n,o)}buildURL(e,t,n){const o=!this.baseURLOverridden()&&n||this.baseURL,i=(e=>rs.test(e))(e)?new URL(e):new URL(o+(o.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return function(e){if(!e)return!0;for(const t in e)return!1;return!0}(s)||(t=Object.assign(Object.assign({},s),t)),"object"==typeof t&&t&&!Array.isArray(t)&&(i.search=this.stringifyQuery(t)),i.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:n}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(n=>Object.assign({method:e,path:t},n)))}request(e,t=null){return new Ys(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){var o,i,s;const r=await e,l=null!==(o=r.maxRetries)&&void 0!==o?o:this.maxRetries;null==t&&(t=l),await this.prepareOptions(r);const{req:a,url:u,timeout:c}=await this.buildRequest(r,{retryCount:l-t});await this.prepareRequest(a,{url:u,options:r});const d="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),p=void 0===n?"":`, retryOf: ${n}`,h=Date.now();if(Hs(this).debug(`[${d}] sending request`,Fs({retryOfRequestLogID:n,method:r.method,url:u,options:r,headers:a.headers})),null===(i=r.signal)||void 0===i?void 0:i.aborted)throw new Ki;const f=new AbortController,m=await this.fetchWithTimeout(u,a,c,f).catch(Yi),g=Date.now();if(m instanceof globalThis.Error){const e=`retrying, ${t} attempts remaining`;if(null===(s=r.signal)||void 0===s?void 0:s.aborted)throw new Ki;const o=Ji(m)||/timed? ?out/i.test(String(m)+("cause"in m?String(m.cause):""));if(t)return Hs(this).info(`[${d}] connection ${o?"timed out":"failed"} - ${e}`),Hs(this).debug(`[${d}] connection ${o?"timed out":"failed"} (${e})`,Fs({retryOfRequestLogID:n,url:u,durationMs:g-h,message:m.message})),this.retryRequest(r,t,null!=n?n:d);if(Hs(this).info(`[${d}] connection ${o?"timed out":"failed"} - error; no more retries left`),Hs(this).debug(`[${d}] connection ${o?"timed out":"failed"} (error; no more retries left)`,Fs({retryOfRequestLogID:n,url:u,durationMs:g-h,message:m.message})),o)throw new Xi;throw new zi({cause:m})}const y=`[${d}${p}] ${a.method} ${u} ${m.ok?"succeeded":"failed"} with status ${m.status} in ${g-h}ms`;if(!m.ok){const e=await this.shouldRetry(m);if(t&&e){const e=`retrying, ${t} attempts remaining`;return await async function(e){var t,n;if(null===e||"object"!=typeof e)return;if(e[Symbol.asyncIterator])return void(await(null===(n=(t=e[Symbol.asyncIterator]()).return)||void 0===n?void 0:n.call(t)));const o=e.getReader(),i=o.cancel();o.releaseLock(),await i}(m.body),Hs(this).info(`${y} - ${e}`),Hs(this).debug(`[${d}] response error (${e})`,Fs({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,durationMs:g-h})),this.retryRequest(r,t,null!=n?n:d,m.headers)}const o=e?"error; no more retries left":"error; not retryable";Hs(this).info(`${y} - ${o}`);const i=await m.text().catch(e=>Yi(e).message),s=(e=>{try{return JSON.parse(e)}catch(t){return}})(i),l=s?void 0:i;throw Hs(this).debug(`[${d}] response error (${o})`,Fs({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,message:l,durationMs:Date.now()-h})),this.makeStatusError(m.status,s,l,m.headers)}return Hs(this).info(y),Hs(this).debug(`[${d}] response start`,Fs({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,durationMs:g-h})),{response:m,options:r,controller:f,requestLogID:d,retryOfRequestLogID:n,startTime:h}}async fetchWithTimeout(e,t,n,o){const i=t||{},{signal:s,method:r}=i,l=Ho(i,["signal","method"]);s&&s.addEventListener("abort",()=>o.abort());const a=setTimeout(()=>o.abort(),n),u=globalThis.ReadableStream&&l.body instanceof globalThis.ReadableStream||"object"==typeof l.body&&null!==l.body&&Symbol.asyncIterator in l.body,c=Object.assign(Object.assign(Object.assign({signal:o.signal},u?{duplex:"half"}:{}),{method:"GET"}),l);r&&(c.method=r.toUpperCase());try{return await this.fetch.call(void 0,e,c)}finally{clearTimeout(a)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||e.status>=500)}async retryRequest(e,t,n,o){var i;let s;const r=null==o?void 0:o.get("retry-after-ms");if(r){const e=parseFloat(r);Number.isNaN(e)||(s=e)}const l=null==o?void 0:o.get("retry-after");if(l&&!s){const e=parseFloat(l);s=Number.isNaN(e)?Date.parse(l)-Date.now():1e3*e}if(!(s&&0<=s&&s<6e4)){const n=null!==(i=e.maxRetries)&&void 0!==i?i:this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,n)}var a;return await(a=s,new Promise(e=>setTimeout(e,a))),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){const n=t-e;return Math.min(.5*Math.pow(2,n),8)*(1-.25*Math.random())*1e3}async buildRequest(e,{retryCount:t=0}={}){var n,o,i;const s=Object.assign({},e),{method:r,path:l,query:a,defaultBaseURL:u}=s,c=this.buildURL(l,a,u);"timeout"in s&&((e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new $i(`${e} must be an integer`);if(t<0)throw new $i(`${e} must be a positive integer`)})("timeout",s.timeout),s.timeout=null!==(n=s.timeout)&&void 0!==n?n:this.timeout;const{bodyHeaders:d,body:p}=this.buildBody({options:s}),h=await this.buildHeaders({options:e,method:r,bodyHeaders:d,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:r,headers:h},s.signal&&{signal:s.signal}),globalThis.ReadableStream&&p instanceof globalThis.ReadableStream&&{duplex:"half"}),p&&{body:p}),null!==(o=this.fetchOptions)&&void 0!==o?o:{}),null!==(i=s.fetchOptions)&&void 0!==i?i:{}),url:c,timeout:s.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:n,retryCount:o}){let i={};this.idempotencyHeader&&"get"!==t&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const s=await this.authHeaders(e);let r=Ks([i,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),null!=hs?hs:hs=cs()),this._options.defaultHeaders,n,e.headers,s]);return this.validateHeaders(r),r.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const n=Ks([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||"string"==typeof e&&n.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:"object"==typeof e&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&"function"==typeof e.next)?{bodyHeaders:void 0,body:ms(e)}:this.encoder({body:e,headers:n})}}Qs.DEFAULT_TIMEOUT=6e4;class Zs extends Qs{constructor(){super(...arguments),this.interactions=new Cs(this)}}function er(e,t){const n={},o=fe(e,["sdkHttpResponse"]);null!=o&&he(n,["sdkHttpResponse"],o);const i=fe(e,["name"]);null!=i&&he(n,["name"],i);const s=fe(e,["state"]);null!=s&&he(n,["state"],Io(s));const r=fe(e,["createTime"]);null!=r&&he(n,["createTime"],r);const l=fe(e,["tuningTask","startTime"]);null!=l&&he(n,["startTime"],l);const a=fe(e,["tuningTask","completeTime"]);null!=a&&he(n,["endTime"],a);const u=fe(e,["updateTime"]);null!=u&&he(n,["updateTime"],u);const c=fe(e,["description"]);null!=c&&he(n,["description"],c);const d=fe(e,["baseModel"]);null!=d&&he(n,["baseModel"],d);const p=fe(e,["_self"]);return null!=p&&he(n,["tunedModel"],function(e){const t={},n=fe(e,["name"]);null!=n&&he(t,["model"],n);const o=fe(e,["name"]);return null!=o&&he(t,["endpoint"],o),t}(p)),n}function tr(e,t){const n={},o=fe(e,["sdkHttpResponse"]);null!=o&&he(n,["sdkHttpResponse"],o);const i=fe(e,["name"]);null!=i&&he(n,["name"],i);const s=fe(e,["state"]);null!=s&&he(n,["state"],Io(s));const r=fe(e,["createTime"]);null!=r&&he(n,["createTime"],r);const l=fe(e,["startTime"]);null!=l&&he(n,["startTime"],l);const a=fe(e,["endTime"]);null!=a&&he(n,["endTime"],a);const u=fe(e,["updateTime"]);null!=u&&he(n,["updateTime"],u);const c=fe(e,["error"]);null!=c&&he(n,["error"],c);const d=fe(e,["description"]);null!=d&&he(n,["description"],d);const p=fe(e,["baseModel"]);null!=p&&he(n,["baseModel"],p);const h=fe(e,["tunedModel"]);null!=h&&he(n,["tunedModel"],h);const f=fe(e,["preTunedModel"]);null!=f&&he(n,["preTunedModel"],f);const m=fe(e,["supervisedTuningSpec"]);null!=m&&he(n,["supervisedTuningSpec"],m);const g=fe(e,["preferenceOptimizationSpec"]);null!=g&&he(n,["preferenceOptimizationSpec"],g);const y=fe(e,["tuningDataStats"]);null!=y&&he(n,["tuningDataStats"],y);const v=fe(e,["encryptionSpec"]);null!=v&&he(n,["encryptionSpec"],v);const E=fe(e,["partnerModelTuningSpec"]);null!=E&&he(n,["partnerModelTuningSpec"],E);const _=fe(e,["customBaseModel"]);null!=_&&he(n,["customBaseModel"],_);const I=fe(e,["experiment"]);null!=I&&he(n,["experiment"],I);const b=fe(e,["labels"]);null!=b&&he(n,["labels"],b);const A=fe(e,["outputUri"]);null!=A&&he(n,["outputUri"],A);const T=fe(e,["pipelineJob"]);null!=T&&he(n,["pipelineJob"],T);const S=fe(e,["serviceAccount"]);null!=S&&he(n,["serviceAccount"],S);const O=fe(e,["tunedModelDisplayName"]);null!=O&&he(n,["tunedModelDisplayName"],O);const C=fe(e,["veoTuningSpec"]);return null!=C&&he(n,["veoTuningSpec"],C),n}function nr(e,t){const n={},o=fe(e,["gcsUri"]);null!=o&&he(n,["validationDatasetUri"],o);const i=fe(e,["vertexDatasetResource"]);return null!=i&&he(n,["validationDatasetUri"],i),n}Xs=Zs,Zs.GeminiNextGenAPIClient=Xs,Zs.GeminiNextGenAPIClientError=$i,Zs.APIError=Wi,Zs.APIConnectionError=zi,Zs.APIConnectionTimeoutError=Xi,Zs.APIUserAbortError=Ki,Zs.NotFoundError=ts,Zs.ConflictError=ns,Zs.RateLimitError=is,Zs.BadRequestError=Qi,Zs.AuthenticationError=Zi,Zs.InternalServerError=ss,Zs.PermissionDeniedError=es,Zs.UnprocessableEntityError=os,Zs.toFile=async function(e,t,n){if(vs(),(e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&_s(e))(e=await e))return e instanceof File?e:Es([await e.arrayBuffer()],e.name);if((e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob)(e)){const o=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),Es(await Is(o),t,n)}const o=await Is(e);if(t||(t=function(e){return("object"==typeof e&&null!==e&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}(e)),!(null==n?void 0:n.type)){const e=o.find(e=>"object"==typeof e&&"type"in e&&e.type);"string"==typeof e&&(n=Object.assign(Object.assign({},n),{type:e}))}return Es(o,t,n)},Zs.Interactions=Cs;class or extends de{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new ko(An.PAGED_ITEM_TUNING_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.get=async e=>await this.getInternal(e),this.tune=async e=>{var t;if(this.apiClient.isVertexAI()){if(e.baseModel.startsWith("projects/")){const n={tunedModelName:e.baseModel};(null===(t=e.config)||void 0===t?void 0:t.preTunedModelCheckpointId)&&(n.checkpointId=e.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},e),{preTunedModel:n});return o.baseModel=void 0,await this.tuneInternal(o)}{const t=Object.assign({},e);return await this.tuneInternal(t)}}{const t=Object.assign({},e),n=await this.tuneMldevInternal(t);let o="";return void 0!==n.metadata&&void 0!==n.metadata.tunedModel?o=n.metadata.tunedModel:void 0!==n.name&&n.name.includes("/operations/")&&(o=n.name.split("/operations/")[0]),{name:o,state:ct.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e){const t={},n=fe(e,["name"]);return null!=n&&he(t,["_url","name"],n),t}(e);return r=pe("{name}",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>tr(e))}{const t=function(e){const t={},n=fe(e,["name"]);return null!=n&&he(t,["_url","name"],n),t}(e);return r=pe("{name}",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>er(e))}}async listInternal(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e){const t={},n=fe(e,["config"]);return null!=n&&function(e,t){const n=fe(e,["pageSize"]);void 0!==t&&null!=n&&he(t,["_query","pageSize"],n);const o=fe(e,["pageToken"]);void 0!==t&&null!=o&&he(t,["_query","pageToken"],o);const i=fe(e,["filter"]);void 0!==t&&null!=i&&he(t,["_query","filter"],i)}(n,t),t}(e);return r=pe("tuningJobs",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["nextPageToken"]);null!=o&&he(t,["nextPageToken"],o);const i=fe(e,["tuningJobs"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>tr(e))),he(t,["tuningJobs"],e)}return t}(e),n=new qn;return Object.assign(n,t),n})}{const t=function(e){const t={},n=fe(e,["config"]);return null!=n&&function(e,t){const n=fe(e,["pageSize"]);void 0!==t&&null!=n&&he(t,["_query","pageSize"],n);const o=fe(e,["pageToken"]);void 0!==t&&null!=o&&he(t,["_query","pageToken"],o);const i=fe(e,["filter"]);void 0!==t&&null!=i&&he(t,["_query","filter"],i)}(n,t),t}(e);return r=pe("tunedModels",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["nextPageToken"]);null!=o&&he(t,["nextPageToken"],o);const i=fe(e,["tunedModels"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>er(e))),he(t,["tuningJobs"],e)}return t}(e),n=new qn;return Object.assign(n,t),n})}}async cancel(e){var t,n,o,i;let s,r="",l={};if(this.apiClient.isVertexAI()){const o=function(e){const t={},n=fe(e,["name"]);return null!=n&&he(t,["_url","name"],n),t}(e);return r=pe("{name}:cancel",o._url),l=o._query,delete o._url,delete o._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);return null!=n&&he(t,["sdkHttpResponse"],n),t}(e),n=new Ln;return Object.assign(n,t),n})}{const t=function(e){const t={},n=fe(e,["name"]);return null!=n&&he(t,["_url","name"],n),t}(e);return r=pe("{name}:cancel",t._url),l=t._query,delete t._url,delete t._query,s=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(o=e.config)||void 0===o?void 0:o.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),s.then(e=>{const t=function(e){const t={},n=fe(e,["sdkHttpResponse"]);return null!=n&&he(t,["sdkHttpResponse"],n),t}(e),n=new Ln;return Object.assign(n,t),n})}}async tuneInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI()){const r=function(e,t){const n={},o=fe(e,["baseModel"]);null!=o&&he(n,["baseModel"],o);const i=fe(e,["preTunedModel"]);null!=i&&he(n,["preTunedModel"],i);const s=fe(e,["trainingDataset"]);null!=s&&function(e,t,n){let o=fe(n,["config","method"]);if(void 0===o&&(o="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===o){const n=fe(e,["gcsUri"]);void 0!==t&&null!=n&&he(t,["supervisedTuningSpec","trainingDatasetUri"],n)}else if("PREFERENCE_TUNING"===o){const n=fe(e,["gcsUri"]);void 0!==t&&null!=n&&he(t,["preferenceOptimizationSpec","trainingDatasetUri"],n)}let i=fe(n,["config","method"]);if(void 0===i&&(i="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===i){const n=fe(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&he(t,["supervisedTuningSpec","trainingDatasetUri"],n)}else if("PREFERENCE_TUNING"===i){const n=fe(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&he(t,["preferenceOptimizationSpec","trainingDatasetUri"],n)}if(void 0!==fe(e,["examples"]))throw new Error("examples parameter is not supported in Vertex AI.")}(s,n,t);const r=fe(e,["config"]);return null!=r&&function(e,t,n){let o=fe(n,["config","method"]);if(void 0===o&&(o="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===o){const n=fe(e,["validationDataset"]);void 0!==t&&null!=n&&he(t,["supervisedTuningSpec"],nr(n))}else if("PREFERENCE_TUNING"===o){const n=fe(e,["validationDataset"]);void 0!==t&&null!=n&&he(t,["preferenceOptimizationSpec"],nr(n))}const i=fe(e,["tunedModelDisplayName"]);void 0!==t&&null!=i&&he(t,["tunedModelDisplayName"],i);const s=fe(e,["description"]);void 0!==t&&null!=s&&he(t,["description"],s);let r=fe(n,["config","method"]);if(void 0===r&&(r="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===r){const n=fe(e,["epochCount"]);void 0!==t&&null!=n&&he(t,["supervisedTuningSpec","hyperParameters","epochCount"],n)}else if("PREFERENCE_TUNING"===r){const n=fe(e,["epochCount"]);void 0!==t&&null!=n&&he(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],n)}let l=fe(n,["config","method"]);if(void 0===l&&(l="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===l){const n=fe(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&he(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],n)}else if("PREFERENCE_TUNING"===l){const n=fe(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&he(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],n)}let a=fe(n,["config","method"]);if(void 0===a&&(a="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===a){const n=fe(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&he(t,["supervisedTuningSpec","exportLastCheckpointOnly"],n)}else if("PREFERENCE_TUNING"===a){const n=fe(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&he(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],n)}let u=fe(n,["config","method"]);if(void 0===u&&(u="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===u){const n=fe(e,["adapterSize"]);void 0!==t&&null!=n&&he(t,["supervisedTuningSpec","hyperParameters","adapterSize"],n)}else if("PREFERENCE_TUNING"===u){const n=fe(e,["adapterSize"]);void 0!==t&&null!=n&&he(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],n)}if(void 0!==fe(e,["batchSize"]))throw new Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==fe(e,["learningRate"]))throw new Error("learningRate parameter is not supported in Vertex AI.");const c=fe(e,["labels"]);void 0!==t&&null!=c&&he(t,["labels"],c);const d=fe(e,["beta"]);void 0!==t&&null!=d&&he(t,["preferenceOptimizationSpec","hyperParameters","beta"],d)}(r,n,t),n}(e,e);return i=pe("tuningJobs",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),o.then(e=>tr(e))}throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const r=function(e){const t={},n=fe(e,["baseModel"]);null!=n&&he(t,["baseModel"],n);const o=fe(e,["preTunedModel"]);null!=o&&he(t,["preTunedModel"],o);const i=fe(e,["trainingDataset"]);null!=i&&function(e){const t={};if(void 0!==fe(e,["gcsUri"]))throw new Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==fe(e,["vertexDatasetResource"]))throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=fe(e,["examples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),he(t,["examples","examples"],e)}}(i);const s=fe(e,["config"]);return null!=s&&function(e,t){if(void 0!==fe(e,["validationDataset"]))throw new Error("validationDataset parameter is not supported in Gemini API.");const n=fe(e,["tunedModelDisplayName"]);if(void 0!==t&&null!=n&&he(t,["displayName"],n),void 0!==fe(e,["description"]))throw new Error("description parameter is not supported in Gemini API.");const o=fe(e,["epochCount"]);void 0!==t&&null!=o&&he(t,["tuningTask","hyperparameters","epochCount"],o);const i=fe(e,["learningRateMultiplier"]);if(null!=i&&he({},["tuningTask","hyperparameters","learningRateMultiplier"],i),void 0!==fe(e,["exportLastCheckpointOnly"]))throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==fe(e,["preTunedModelCheckpointId"]))throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==fe(e,["adapterSize"]))throw new Error("adapterSize parameter is not supported in Gemini API.");const s=fe(e,["batchSize"]);void 0!==t&&null!=s&&he(t,["tuningTask","hyperparameters","batchSize"],s);const r=fe(e,["learningRate"]);if(void 0!==t&&null!=r&&he(t,["tuningTask","hyperparameters","learningRate"],r),void 0!==fe(e,["labels"]))throw new Error("labels parameter is not supported in Gemini API.");if(void 0!==fe(e,["beta"]))throw new Error("beta parameter is not supported in Gemini API.")}(s,t),t}(e);return i=pe("tunedModels",r._url),s=r._query,delete r._url,delete r._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(r),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>{const n=t;return n.sdkHttpResponse={headers:e.headers},n})),o.then(e=>function(e){const t={},n=fe(e,["sdkHttpResponse"]);null!=n&&he(t,["sdkHttpResponse"],n);const o=fe(e,["name"]);null!=o&&he(t,["name"],o);const i=fe(e,["metadata"]);null!=i&&he(t,["metadata"],i);const s=fe(e,["done"]);null!=s&&he(t,["done"],s);const r=fe(e,["error"]);return null!=r&&he(t,["error"],r),t}(e))}}}class ir{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const sr="x-goog-upload-status";async function rr(e,t,n){var o,i;let s=0,r=0,l=new Sn(new Response),a="upload";for(s=e.size;r<s;){const u=Math.min(8388608,s-r),c=e.slice(r,r+u);r+u>=s&&(a+=", finalize");let d=0,p=1e3;for(;d<3&&(l=await n.request({path:"",body:c,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":a,"X-Goog-Upload-Offset":String(r),"Content-Length":String(u)}}}),!(null===(o=null==l?void 0:l.headers)||void 0===o?void 0:o[sr]));)d++,await lr(p),p*=2;if(r+=u,"active"!==(null===(i=null==l?void 0:l.headers)||void 0===i?void 0:i[sr]))break;if(s<=r)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return l}function lr(e){return new Promise(t=>setTimeout(t,e))}class ar{async upload(e,t,n){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e,t,n){var o;const i=await rr(e,t,n),s=await(null==i?void 0:i.json());if("final"!==(null===(o=null==i?void 0:i.headers)||void 0===o?void 0:o[sr]))throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}(e,t,n)}async uploadToFileSearchStore(e,t,n){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e,t,n){var o;const i=await rr(e,t,n),s=await(null==i?void 0:i.json());if("final"!==(null===(o=null==i?void 0:i.headers)||void 0===o?void 0:o[sr]))throw new Error("Failed to upload file: Upload status is not finalized.");const r=ye(s),l=new Qn;return Object.assign(l,r),l}(e,t,n)}async stat(e){if("string"==typeof e)throw new Error("File path is not supported in browser uploader.");return await async function(e){return{size:e.size,type:e.type}}(e)}}class ur{create(e,t,n){return new cr(e,t,n)}}class cr{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw new Error("WebSocket is not connected");this.ws.close()}}const dr="x-goog-api-key";class pr{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(null===e.get(dr)){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(dr,this.apiKey)}}}new class{get interactions(){if(void 0!==this._interactions)return this._interactions;const e=this.httpOptions;null==e||e.extraBody;const t=new Zs({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:null==e?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(null==e.apiKey)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!==(t=e.vertexai)&&void 0!==t&&t,this.apiKey=e.apiKey;const n=function(e,t,n,o){var i,s;if(!(null==e?void 0:e.baseUrl)){const e={geminiUrl:void 0,vertexUrl:void 0};return t?null!==(i=e.vertexUrl)&&void 0!==i?i:n:null!==(s=e.geminiUrl)&&void 0!==s?s:o}return e.baseUrl}(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const o=new pr(this.apiKey);this.apiClient=new bi({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:"gl-node/web",uploader:new ar,downloader:new ir}),this.models=new qi(this.apiClient),this.live=new xi(this.apiClient,o,new ur),this.batches=new qo(this.apiClient),this.chats=new Wo(this.models,this.apiClient),this.caches=new Go(this.apiClient),this.files=new Xo(this.apiClient),this.operations=new Li(this.apiClient),this.authTokens=new Hi(this.apiClient),this.tunings=new or(this.apiClient),this.fileSearchStores=new Vi(this.apiClient)}}({apiKey:""});{const e=[];e.push("VITE_SUPABASE_URL"),e.push("VITE_SUPABASE_ANON_KEY");const t=`⚠️ Configuration Supabase manquante: ${e.join(", ")}. Ajoutez-les dans .env.production.local puis: npm run build && npm run preview`;throw new Error(t)}export{se as A,re as L,ae as M,le as P,useProducts as a,ee as j,useTestimonials as u};
